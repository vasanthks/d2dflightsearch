try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-macro-resources', location = 'js/gliffy-macro.js' */
(function(a){var b=a(window);a.fn.gliffyMacroView=function(){return this.each(function(){var d=a(this),f=d.find("iframe.gliffy-html5-container"),c=d.find(".gliffy-chrome-container"),e;d.hover(function(){d.addClass("gliffy-active");c.css({position:"static"});c.find(".gliffy-chrome").width(d.find("iframe:visible,.gliffy-image:visible").width()+2)},function(){d.removeClass("gliffy-active");c.css({position:"relative",left:"-9999px;"})});c.find("span.gliffy-item a").mousedown(function(){a(this).addClass("gliffy-active")}).mouseup(function(){a(this).removeClass("gliffy-active")});d.find(".gliffy-zoom").find("a").fancybox({padding:0,zoomSpeedIn:200,zoomSpeedOut:200,overlayShow:true,overlayOpacity:0.5,onComplete:function(){var g,i,j,h;g=a("#fancybox-content").width();i=d.find("map.gliffy-dynamic");j=g/parseInt(d.data("fullwidth"),10);h=AJS.format("{0}/rest/gliffy/1.0/ceo/{1}/diagrams/{2}/map?name={3}&scale={4}",AJS.Confluence.getContextPath(),d.data("ceoid"),encodeURIComponent(d.data("filename")),i.attr("name"),j);i.load(h+" area");a("#fancybox-img").attr("usemap","#"+i.attr("name"))}});e=a("#gliffy-empty-fancybox").fancybox({onComplete:function(){b.trigger("gliffy-empty-fancybox-complete")},onClosed:function(){b.trigger("gliffy-empty-fancybox-closed");a(".gliffy-slider-container").remove()}});d.find(".gliffy-zoom").find("a").click(function(v){var l,w,u,h,s,t,x,n,p,r,o,m,q,k,g,y,j,i;if(f.length>0&&f.is(":visible")){v.stopImmediatePropagation();v.preventDefault()}else{return}b.unbind("gliffy-empty-fancybox-closed");l=f.data("gliffyOriginalDimensions");h=l.zoom;w=l.width*h;u=l.height*h;o=40;s=u/h;t=w/h;x=b.width();n=b.height();p=[x-(a.fn.fancybox.defaults.margin*2),n-(a.fn.fancybox.defaults.margin*2)-o,a(document).scrollLeft()+a.fn.fancybox.defaults.margin,a(document).scrollTop()+a.fn.fancybox.defaults.margin];r=a.fn.fancybox.defaults.padding*2;if(t>p[0]||s>p[1]){m=(t)/(s);if((t)>p[0]){t=p[0];s=parseInt(((t-r)/m)+r,10)}if((s)>p[1]){s=p[1];t=parseInt(((s-r)*m)+r,10)}}else{t=Math.min(t,p[0]);s=Math.min(s,p[1])}a("#gliffy-html5-zoom-container").remove();i=a("<iframe />",{id:"gliffy-html5-zoom-container",src:AJS.Confluence.getContextPath()+"/plugins/gliffy/viewer.action",frameborder:0,style:"position:relative;overflow:hidden;background:#FFFFFF;border:0;padding:0;","data-id":f.data("id"),"data-width":t,"data-height":s,"data-zoom":h,"data-oheight":u,"data-oweight":w});a("#gliffy-html5-zoom-holder").append(i);e.click();q=parseInt(Math.max(p[3]-20,p[3]+((p[1]-s-40)*0.5)-a.fn.fancybox.defaults.padding),10);k=parseInt(Math.max(p[2]-20,p[2]+((p[0]-t-40)*0.5)-a.fn.fancybox.defaults.padding),10);a("#fancybox-wrap").css({height:s,width:t+r,top:q,left:k});g=a("#fancybox-content");g.css({width:t,height:s}).html(i.css({width:t,height:s}));g.append(gliffySoy.viewer.zoomControls({path:AJS.Confluence.getContextPath()+"/download/resources/com.gliffy.integration.confluence"}));y=g.find(".gliffy-slider-container");b.unbind("gliffy-empty-fancybox-complete");b.bind("gliffy-empty-fancybox-complete",function(){y.css({width:y.parent().width()-60})})})})};AJS.toInit(function(){a("span.gliffy-container").filter(function(){return !a(this).hasClass("gliffy-min")}).gliffyMacroView()})}(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


