try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-viewer-resources', location = 'js/PromiseJS.js' */
(function(g){var d={Pending:"Pending",Resolved:"Resolved",Rejected:"Rejected"};if(!Array.prototype.forEach){Array.prototype.forEach=function(l,k){for(var j=0,h=this.length;j<h;++j){if(j in this){l.call(k,this[j],j,this)}}}}function e(){var i=this,j=[],h=[],n=[],m=d.Pending,l;function k(){var o=this;o.success=function(p){if(m===d.Resolved){p.call(o,l)}else{j.push(p)}return o};o.fail=function(p){if(m===d.Rejected){p.call(o,l)}else{h.push(p)}return o};o.progress=function(p){n.push(p);return o};o.always=function(p){return o.success(p).fail(p)};o.then=function(q,p){return o.success(q).fail(p)};o.isPending=function(){return m===d.Pending};o.isResolved=function(){return m===d.Resolved};o.isRejected=function(){return m===d.Rejected};o.value=function(){return l}}i.promise=new k();i.resolve=function(o){if(m===d.Pending){m=d.Resolved;l=o;j.forEach(function(p){p.call(i.promise,l)})}};i.reject=function(o){if(m===d.Pending){m=d.Rejected;l=o;h.forEach(function(p){p.call(i.promise,l)})}};i.notify=function(){if(m===d.Pending){n.forEach(function(o){o.call(i.promise)})}}}function b(h){return Object.prototype.toString.call(h)==="[object Array]"}function a(l){var h=b(l)?l:Array.prototype.slice.call(arguments,0),j=h.length,i=0,k=new e();h.forEach(function(m){m.always(function(){i+=1;if(i===j){k.resolve(h)}})});return k.promise}function c(i,h,j){if(i.length===0){h.resolve(j)}else{var k=i[0].call();k.always(function(){c(Array.prototype.slice.call(i,1),h,j.concat([k]))})}}function f(j){var h=b(j)?j:Array.prototype.slice.call(arguments,0),i=new e();if(h.length===0){i.resolve()}else{c(h,i,[])}return i.promise}g.PromiseJS={Deferred:e,when:a,chain:f};if(typeof exports!=="undefined"){exports.PromiseJS=g.PromiseJS}}((function(){return this}.call())));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-viewer-resources', location = 'js/gliffy-html5-viewer.min.js' */
(function(){
/*! jQuery v1.7.2 jquery.com | jquery.org/license */
(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cu(a){if(!cj[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){ck||(ck=c.createElement("iframe"),ck.frameBorder=ck.width=ck.height=0),b.appendChild(ck);if(!cl||!ck.createElement){cl=(ck.contentWindow||ck.contentDocument).document,cl.write((f.support.boxModel?"<!doctype html>":"")+"<html><body>"),cl.close()}d=cl.createElement(a),cl.body.appendChild(d),e=f.css(d,"display"),b.removeChild(ck)}cj[a]=e}return cj[a]}function ct(a,b){var c={};f.each(cp.concat.apply([],cp.slice(0,b)),function(){c[this]=a});return c}function cs(){cq=b}function cr(){setTimeout(cs,0);return cq=f.now()}function ci(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ch(){try{return new a.XMLHttpRequest}catch(b){}}function cb(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1){for(h in a.converters){typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h])}}l=k,k=d[g];if(k==="*"){k=l}else{if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}}return c}function ca(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g){i in d&&(c[g[i]]=d[i])}while(f[0]==="*"){f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"))}if(h){for(i in e){if(e[i]&&e[i].test(h)){f.unshift(i);break}}}if(f[0] in d){j=f[0]}else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function b_(a,b,c,d){if(f.isArray(b)){f.each(b,function(b,e){c||bD.test(a)?d(a,e):b_(a+"["+(typeof e=="object"?b:"")+"]",e,c,d)})}else{if(!c&&f.type(b)==="object"){for(var e in b){b_(a+"["+e+"]",b[e],c,d)}}else{d(a,b)}}}function b$(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c){c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d])}e&&f.extend(!0,a,e)}function bZ(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bS,l;for(;i<j&&(k||!l);i++){l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=bZ(a,c,d,e,l,g)))}(k||!l)&&!g["*"]&&(l=bZ(a,c,d,e,"*",g));return l}function bY(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bO),e=0,g=d.length,h,i,j;for(;e<g;e++){h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}}function bB(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?1:0,g=4;if(d>0){if(c!=="border"){for(;e<g;e+=2){c||(d-=parseFloat(f.css(a,"padding"+bx[e]))||0),c==="margin"?d+=parseFloat(f.css(a,c+bx[e]))||0:d-=parseFloat(f.css(a,"border"+bx[e]+"Width"))||0}}return d+"px"}d=by(a,b);if(d<0||d==null){d=a.style[b]}if(bt.test(d)){return d}d=parseFloat(d)||0;if(c){for(;e<g;e+=2){d+=parseFloat(f.css(a,"padding"+bx[e]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+bx[e]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+bx[e]))||0)}}return d+"px"}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio"){a.defaultChecked=a.checked}}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;b.nodeType===1&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c==="object"?b.outerHTML=a.outerHTML:c!=="input"||a.type!=="checkbox"&&a.type!=="radio"?c==="option"?b.selected=a.defaultSelected:c==="input"||c==="textarea"?b.defaultValue=a.defaultValue:c==="script"&&b.text!==a.text&&(b.text=a.text):(a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value)),b.removeAttribute(f.expando),b.removeAttribute("_submit_attached"),b.removeAttribute("_change_attached"))}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i){for(d=0,e=i[c].length;d<e;d++){f.event.add(b,c,i[c][d])}}}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement){while(b.length){c.createElement(b.pop())}}return c}function T(a,b,c){b=b||0;if(f.isFunction(b)){return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c})}if(b.nodeType){return f.grep(a,function(a,d){return a===b===c})}if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b)){return f.filter(b,d,!c)}b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return !a||!a.parentNode||a.parentNode.nodeType===11}function K(){return !0}function J(){return !1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b])){continue}if(b!=="toJSON"){return !1}}return !0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?+d:j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else{d=b}}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++){b[a[c]]=!0}return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a){return this}if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2]){return f.find(a)}this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return !d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a)){return f.ready(a)}a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++){if((a=arguments[j])!=null){for(c in a){d=i[c],f=a[c];if(i===f){continue}l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}}}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body){return setTimeout(e.ready,1)}e.isReady=!0;if(a!==!0&&--e.readyWait>0){return}A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete"){return setTimeout(e.ready,1)}if(c.addEventListener){c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1)}else{if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return !isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a)){return !1}try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf")){return !1}}catch(c){return !1}var d;for(d in a){}return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a){return !1}return !0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b){return null}b=e.trim(b);if(a.JSON&&a.JSON.parse){return a.JSON.parse(b)}if(n.test(b.replace(o,"@").replace(p,"]").replace(q,""))){return(new Function("return "+b))()}e.error("Invalid JSON: "+b)},parseXML:function(c){if(typeof c!="string"||!c){return null}var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a){if(c.apply(a[f],d)===!1){break}}}else{for(;g<h;){if(c.apply(a[g++],d)===!1){break}}}}else{if(i){for(f in a){if(c.call(a[f],f,a[f])===!1){break}}}else{for(;g<h;){if(c.call(a[g],g,a[g++])===!1){break}}}}return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H){return H.call(b,a,c)}d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++){if(c in b&&b[c]===a){return c}}}return -1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number"){for(var f=c.length;e<f;e++){a[d++]=c[e]}}else{while(c[e]!==b){a[d++]=c[e++]}}a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++){e=!!b(a[f],f),c!==e&&d.push(a[f])}return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k){for(;i<j;i++){f=c(a[i],i,d),f!=null&&(h[h.length]=f)}}else{for(g in a){f=c(a[g],g,d),f!=null&&(h[h.length]=f)}}return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a)){return b}var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h,i){var j,k=d==null,l=0,m=a.length;if(d&&typeof d=="object"){for(l in d){e.access(a,c,l,d[l],1,h,f)}g=1}else{if(f!==b){j=i===b&&e.isFunction(f),k&&(j?(j=c,c=function(a,b,c){return j.call(e(a),c)}):(c.call(a,f),c=null));if(c){for(;l<m;l++){c(a[l],d,j?f.call(a[l],l,c(a[l],d)):f,i)}}g=1}}return g?a:k?c.call(a):m?c(a[0],d):h},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m,n=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++){g=b[d],h=f.type(g),h==="array"?n(g):h==="function"&&(!a.unique||!p.has(g))&&c.push(g)}},o=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,j=!0,m=k||0,k=0,l=c.length;for(;c&&m<l;m++){if(c[m].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}}j=!1,c&&(a.once?e===!0?p.disable():c=[]:d&&d.length&&(e=d.shift(),p.fireWith(e[0],e[1])))},p={add:function(){if(c){var a=c.length;n(arguments),j?l=c.length:e&&e!==!0&&(k=a,o(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++){for(var f=0;f<c.length;f++){if(b[d]===c[f]){j&&f<=l&&(l--,f<=m&&m--),c.splice(f--,1);if(a.unique){break}}}}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++){if(a===c[b]){return !0}}}return !1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return !c},lock:function(){d=b,(!e||e===!0)&&p.disable();return this},locked:function(){return !d},fireWith:function(b,c){d&&(j?a.once||d.push([b,c]):(!a.once||!e)&&o(b,c));return this},fire:function(){p.fireWith(this,arguments);return this},fired:function(){return !!i}};return p};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null){a=h}else{for(var b in h){a[b]=h[b]}}return a}},i=h.promise({}),j;for(j in g){i[j]=g[j].fire,i[j+"With"]=g[j].fireWith}i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++){b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g}g||j.resolveWith(j,b)}else{j!==a&&j.resolveWith(j,d?[a]:[])}return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p=c.createElement("div"),q=c.documentElement;p.setAttribute("className","t"),p.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=p.getElementsByTagName("*"),e=p.getElementsByTagName("a")[0];if(!d||!d.length||!e){return{}}g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=p.getElementsByTagName("input")[0],b={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:p.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},f.boxModel=b.boxModel=c.compatMode==="CSS1Compat",i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete p.test}catch(r){b.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",function(){b.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),i.setAttribute("name","t"),p.appendChild(i),j=c.createDocumentFragment(),j.appendChild(p.lastChild),b.checkClone=j.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,j.removeChild(i),j.appendChild(p);if(p.attachEvent){for(n in {submit:1,change:1,focusin:1}){m="on"+n,o=m in p,o||(p.setAttribute(m,"return;"),o=typeof p[m]=="function"),b[n+"Bubbles"]=o}}j.removeChild(p),j=g=h=p=i=null,f(function(){var d,e,g,h,i,j,l,m,n,q,r,s,t,u=c.getElementsByTagName("body")[0];!u||(m=1,t="padding:0;margin:0;border:",r="position:absolute;top:0;left:0;width:1px;height:1px;",s=t+"0;visibility:hidden;",n="style='"+r+t+"5px solid #000;",q="<div "+n+"display:block;'><div style='"+t+"0;display:block;overflow:hidden;'></div></div><table "+n+"' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",d=c.createElement("div"),d.style.cssText=s+"width:0;height:0;position:static;top:0;margin-top:"+m+"px",u.insertBefore(d,u.firstChild),p=c.createElement("div"),d.appendChild(p),p.innerHTML="<table><tr><td style='"+t+"0;display:none'></td><td>t</td></tr></table>",k=p.getElementsByTagName("td"),o=k[0].offsetHeight===0,k[0].style.display="",k[1].style.display="none",b.reliableHiddenOffsets=o&&k[0].offsetHeight===0,a.getComputedStyle&&(p.innerHTML="",l=c.createElement("div"),l.style.width="0",l.style.marginRight="0",p.style.width="2px",p.appendChild(l),b.reliableMarginRight=(parseInt((a.getComputedStyle(l,null)||{marginRight:0}).marginRight,10)||0)===0),typeof p.style.zoom!="undefined"&&(p.innerHTML="",p.style.width=p.style.padding="1px",p.style.border=0,p.style.overflow="hidden",p.style.display="inline",p.style.zoom=1,b.inlineBlockNeedsLayout=p.offsetWidth===3,p.style.display="block",p.style.overflow="visible",p.innerHTML="<div style='width:5px;'></div>",b.shrinkWrapBlocks=p.offsetWidth!==3),p.style.cssText=r+s,p.innerHTML=q,e=p.firstChild,g=e.firstChild,i=e.nextSibling.firstChild.firstChild,j={doesNotAddBorder:g.offsetTop!==5,doesAddBorderForTableAndCells:i.offsetTop===5},g.style.position="fixed",g.style.top="20px",j.fixedPosition=g.offsetTop===20||g.offsetTop===15,g.style.position=g.style.top="",e.style.overflow="hidden",e.style.position="relative",j.subtractsBorderForOverflowNotVisible=g.offsetTop===-5,j.doesNotIncludeMarginInBodyOffset=u.offsetTop!==m,a.getComputedStyle&&(p.style.marginTop="1%",b.pixelMargin=(a.getComputedStyle(p,null)||{marginTop:0}).marginTop!=="1%"),typeof d.style.zoom!="undefined"&&(d.style.zoom=1),u.removeChild(d),l=p=d=null,f.extend(b,j))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return !!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b){return}n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function"){e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c)}g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c]){return g.events}k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k]){return}if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++){delete d[b[e]]}if(!(c?m:f.isEmptyObject)(d)){return}}}if(!c){delete j[k].data;if(!m(j[k])){return}}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b){return b!==!0&&a.getAttribute("classid")===b}}return !0}}),f.fn.extend({data:function(a,c){var d,e,g,h,i,j=this[0],k=0,m=null;if(a===b){if(this.length){m=f.data(j);if(j.nodeType===1&&!f._data(j,"parsedAttrs")){g=j.attributes;for(i=g.length;k<i;k++){h=g[k].name,h.indexOf("data-")===0&&(h=f.camelCase(h.substring(5)),l(j,h,m[h]))}f._data(j,"parsedAttrs",!0)}}return m}if(typeof a=="object"){return this.each(function(){f.data(this,a)})}d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!";return f.access(this,function(c){if(c===b){m=this.triggerHandler("getData"+e,[d[0]]),m===b&&j&&(m=f.data(j,a),m=l(j,a,m));return m===b&&d[1]?this.data(d[0]):m}d[1]=c,this.each(function(){var b=f(this);b.triggerHandler("setData"+e,d),f.data(this,a,c),b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1)},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){var d=2;typeof a!="string"&&(c=a,a="fx",d--);if(arguments.length<d){return f.queue(this[0],a)}return c===b?this:this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--){if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0)){h++,l.add(m)}}m();return d.promise(c)}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,f.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,f.prop,a,b,arguments.length>1)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a)){return this.each(function(b){f(this).addClass(a.call(this,b,this.className))})}if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1){if(!e.className&&b.length===1){e.className=a}else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++){~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ")}e.className=f.trim(g)}}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a)){return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))})}if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className){if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++){h=h.replace(" "+c[i]+" "," ")}g.className=f.trim(h)}else{g.className=""}}}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a)){return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)})}return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++]){i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}}else{if(c==="undefined"||c==="boolean"){this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""}}})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++){if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1){return !0}}return !1},val:function(a){var c,d,e,g=this[0];if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.type]||f.valHooks[this.nodeName.toLowerCase()];if(!c||!("set" in c)||c.set(this,h,"value")===b){this.value=h}}})}if(g){c=f.valHooks[g.type]||f.valHooks[g.nodeName.toLowerCase()];if(c&&"get" in c&&(d=c.get(g,"value"))!==b){return d}d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return !b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0){return null}c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j){return b}h.push(b)}}if(j&&!h.length&&i.length){return f(i[g]).val()}return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn){return f(a)[c](d)}if(typeof a.getAttribute=="undefined"){return f.prop(a,c,d)}i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set" in h&&i&&(g=h.set(a,d,c))!==b){return g}a.setAttribute(c,""+d);return d}if(h&&"get" in h&&i&&(g=h.get(a,c))!==null){return g}g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h,i=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;i<g;i++){e=d[i],e&&(c=f.propFix[e]||e,h=u.test(e),h||f.attr(a,e,""),a.removeAttribute(v?e:c),h&&c in a&&(a[c]=!1))}}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode){f.error("type property can't be changed")}else{if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button")){return w.get(a,b)}return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button")){return w.set(a,b,c)}a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set" in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get" in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0,coords:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b)){return a.checked=f.inArray(f(a).val(),b)>=0}}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/(?:^|\s)hover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler,g=p.selector),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:g&&G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1){a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o){f.event.remove(a,j+b[h],c,d,!0)}continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++){s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s))}r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered)){return}h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h]){return}c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j){j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0)}return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1){return}r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode){r.push([m,s]),n=m}n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++){m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault()}c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=f.event.special[c.type]||{},j=[],k,l,m,n,o,p,q,r,s,t,u;g[0]=c,c.delegateTarget=this;if(!i.preDispatch||i.preDispatch.call(this,c)!==!1){if(e&&(!c.button||c.type!=="click")){n=f(this),n.context=this.ownerDocument||this;for(m=c.target;m!=this;m=m.parentNode||this){if(m.disabled!==!0){p={},r=[],n[0]=m;for(k=0;k<e;k++){s=d[k],t=s.selector,p[t]===b&&(p[t]=s.quick?H(m,s.quick):n.is(t)),p[t]&&r.push(s)}r.length&&j.push({elem:m,matches:r})}}}d.length>e&&j.push({elem:this,matches:d.slice(e)});for(k=0;k<j.length&&!c.isPropagationStopped();k++){q=j[k],c.currentTarget=q.elem;for(l=0;l<q.matches.length&&!c.isImmediatePropagationStopped();l++){s=q.matches[l];if(h||!c.namespace&&!s.namespace||c.namespace_re&&c.namespace_re.test(s.namespace)){c.data=s.data,c.handleObj=s,o=((f.event.special[s.origType]||{}).handle||s.handler).apply(q.elem,g),o!==b&&(c.result=o,o===!1&&(c.preventDefault(),c.stopPropagation()))}}}i.postDispatch&&i.postDispatch.call(this,c);return c.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando]){return a}var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;){e=i[--d],a[e]=g[e]}a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event)){return new f.Event(a,b)}a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d)){a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b}return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form")){return !1}f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),d._submit_attached=!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(f.nodeName(this,"form")){return !1}f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))})}return !1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox"){return a.handleObj.handler.apply(this,arguments)}},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=d||c,c=b);for(i in a){this.on(i,c,d,a[i],g)}return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1){e=J}else{if(!e){return this}}g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a){this.off(g,c,a[g])}return this}if(c===!1||typeof c=="function"){d=c,c=b}d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){return f.event.trigger(a,b,this[0],!0)}},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length){b[d++].guid=c}return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else{if(m.filter(b,[j]).length>0){k=j;break}}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9){return[]}if(!b||typeof b!="string"){return e}var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b)){if(w.length===2&&o.relative[w[0]]){j=y(w[0]+w[1],d,f)}else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length){b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}}}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length){q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}}else{k=w=[]}}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]"){if(!u){e.push.apply(e,k)}else{if(d&&d.nodeType===1){for(t=0;k[t]!=null;t++){k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t])}}else{for(t=0;k[t]!=null;t++){k[t]&&k[t].nodeType===1&&e.push(j[t])}}}}else{s(k,e)}l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h){for(var b=1;b<a.length;b++){a[b]===a[b-1]&&a.splice(b--,1)}}}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a){return[]}for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter){if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\"){continue}s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f){g=i=!0}else{if(f===!0){continue}}}if(f){for(n=0;(j=s[n])!=null;n++){j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0))}}if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g){return[]}break}}}if(a===q){if(g==null){m.error(a)}else{break}}q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9||d===11){if(typeof a.textContent=="string"){return a.textContent}if(typeof a.innerText=="string"){return a.innerText.replace(k,"")}for(a=a.firstChild;a;a=a.nextSibling){e+=n(a)}}else{if(d===3||d===4){return a.nodeValue}}}else{for(b=0;c=a[b];b++){c.nodeType!==8&&(e+=n(c))}}return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++){if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1){}a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++){c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b)}d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++){d[e].getAttribute("name")===a[1]&&c.push(d[e])}return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined"){return b.getElementsByTagName(a[1])}}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f){return a}for(var g=0,h;(h=b[g])!=null;g++){h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1))}return !1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else{a[2]&&m.error(a[0])}a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not"){if((a.exec(b[3])||"").length>1||/^\w/.test(b[3])){b[3]=m(b[3],null,null,c)}else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return !1}}else{if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0])){return !0}}return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return !!a.firstChild},empty:function(a){return !a.firstChild},has:function(a,b,c){return !!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f){return f(a,c,b,d)}if(e==="contains"){return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0}if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++){if(g[h]===a){return !1}}return !0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling){if(l.nodeType===1){return !1}}if(k==="first"){return !0}l=a;case"last":while(l=l.nextSibling){if(l.nodeType===1){return !1}}return !0;case"nth":c=b[2],e=b[3];if(c===1&&e===0){return !0}f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling){l.nodeType===1&&(l.nodeIndex=++i)}g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f){return f(a,c,b,d)}}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match){o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q))}o.match.globalPOS=p;var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]"){Array.prototype.push.apply(d,a)}else{if(typeof a.length=="number"){for(var e=a.length;c<e;c++){d.push(a[c])}}else{for(;a[c];c++){d.push(a[c])}}}return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition){return a.compareDocumentPosition?-1:1}return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i){return v(a,b)}if(!g){return -1}if(!i){return 1}while(j){e.unshift(j),j=j.parentNode}j=i;while(j){f.unshift(j),j=j.parentNode}c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++){if(e[k]!==f[k]){return v(e[k],f[k])}}return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b){return c}var d=a.nextSibling;while(d){if(d===b){return -1}d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++){c[e].nodeType===1&&d.push(c[e])}c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1]){return s(e.getElementsByTagName(b),f)}if(h[2]&&o.find.CLASS&&e.getElementsByClassName){return s(e.getElementsByClassName(h[2]),f)}}if(e.nodeType===9){if(b==="body"&&e.body){return s([e.body],f)}if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode){return s([],f)}if(i.id===h[3]){return s([i],f)}}try{return s(e.querySelectorAll(b),f)}catch(j){}}else{if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p){return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}}catch(r){}finally{l||k.removeAttribute("id")}}}}return a(b,e,f,g)};for(var e in a){m[e]=a[e]}b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a)){try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11){return f}}}catch(g){}}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1){return}o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c){return b.getElementsByClassName(a[1])}},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return !!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return !1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a)){f+=d[0],a=a.replace(o.match.PSEUDO,"")}a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++){m(a,g[h],e,c)}return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.globalPOS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string"){return f(a).filter(function(){for(c=0,d=b.length;c<d;c++){if(f.contains(b[c],this)){return !0}}})}var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0){for(h=g;h<e.length;h++){for(i=0;i<g;i++){if(e[i]===e[h]){e.splice(h--,1);break}}}}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++){if(f.contains(this,b[a])){return !0}}})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return !!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++){f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h})}g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11){break}}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a){return this[0]&&this[0].parentNode?this.prevAll().length:-1}if(typeof a=="string"){return f.inArray(this[0],f(a))}return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d))){g.nodeType===1&&e.push(g),g=g[c]}return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c]){if(a.nodeType===1&&++e===b){break}}return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling){a.nodeType===1&&a!==b&&c.push(a)}return c}});var V="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")[\\s/>]","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){return f.access(this,function(a){return a===b?f.text(this):this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(f.isFunction(a)){return this.each(function(b){f(this).wrapAll(a.call(this,b))})}if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1){a=a.firstChild}return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a)){return this.each(function(b){f(this).wrapInner(a.call(this,b))})}return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)})}if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)})}if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++){if(!a||f.filter(a,[d]).length){!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d)}}return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild){b.removeChild(b.firstChild)}}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){return f.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b){return c.nodeType===1?c.innerHTML.replace(W,""):null}if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(;d<e;d++){c=this[d]||{},c.nodeType===1&&(f.cleanData(c.getElementsByTagName("*")),c.innerHTML=a)}c=0}catch(g){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a)){return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))})}typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j)){return this.each(function(){f(this).domManip(a,c,d,!0)})}if(f.isFunction(j)){return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)})}if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++){d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}}k.length&&f.each(k,function(a,b){b.src?f.ajax({type:"GET",global:!1,url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||f.isXMLDoc(a)||!bc.test("<"+a.nodeName+">")?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g){e[g]&&bk(d[g],e[g])}}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g){bj(d[g],e[g])}}}d=e=null;return h},clean:function(a,b,d,e){var g,h,i,j=[];b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);for(var k=0,l;(l=a[k])!=null;k++){typeof l=="number"&&(l+="");if(!l){continue}if(typeof l=="string"){if(!_.test(l)){l=b.createTextNode(l)}else{l=l.replace(Y,"<$1></$2>");var m=(Z.exec(l)||["",""])[1].toLowerCase(),n=bg[m]||bg._default,o=n[0],p=b.createElement("div"),q=bh.childNodes,r;b===c?bh.appendChild(p):U(b).appendChild(p),p.innerHTML=n[1]+l+n[2];while(o--){p=p.lastChild}if(!f.support.tbody){var s=$.test(l),t=m==="table"&&!s?p.firstChild&&p.firstChild.childNodes:n[1]==="<table>"&&!s?p.childNodes:[];for(i=t.length-1;i>=0;--i){f.nodeName(t[i],"tbody")&&!t[i].childNodes.length&&t[i].parentNode.removeChild(t[i])}}!f.support.leadingWhitespace&&X.test(l)&&p.insertBefore(b.createTextNode(X.exec(l)[0]),p.firstChild),l=p.childNodes,p&&(p.parentNode.removeChild(p),q.length>0&&(r=q[q.length-1],r&&r.parentNode&&r.parentNode.removeChild(r)))}}var u;if(!f.support.appendChecked){if(l[0]&&typeof(u=l.length)=="number"){for(i=0;i<u;i++){bn(l[i])}}else{bn(l)}}l.nodeType?j.push(l):j=f.merge(j,l)}if(d){g=function(a){return !a.type||be.test(a.type)};for(k=0;j[k];k++){h=j[k];if(e&&f.nodeName(h,"script")&&(!h.type||be.test(h.type))){e.push(h.parentNode?h.parentNode.removeChild(h):h)}else{if(h.nodeType===1){var v=f.grep(h.getElementsByTagName("script"),g);j.splice.apply(j,[k+1,0].concat(v))}d.appendChild(h)}}}return j},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()]){continue}c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events){e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle)}b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bp=/alpha\([^)]*\)/i,bq=/opacity=([^)]*)/,br=/([A-Z]|^ms)/g,bs=/^[\-+]?(?:\d*\.)?\d+$/i,bt=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,bu=/^([\-+])=([\-+.\de]+)/,bv=/^margin/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Top","Right","Bottom","Left"],by,bz,bA;f.fn.css=function(a,c){return f.access(this,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)},a,c,arguments.length>1)},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=by(a,"opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get" in k&&(g=k.get(a,!1,e))!==b){return g}return j[c]}h=typeof d,h==="string"&&(g=bu.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d)){return}h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set" in k)||(d=k.set(a,d))!==b){try{j[c]=d}catch(l){}}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get" in g&&(e=g.get(a,!0,d))!==b){return e}if(by){return by(a,c)}},swap:function(a,b,c){var d={},e,f;for(f in b){d[f]=a.style[f],a.style[f]=b[f]}e=c.call(a);for(f in b){a.style[f]=d[f]}return e}}),f.curCSS=f.css,c.defaultView&&c.defaultView.getComputedStyle&&(bz=function(a,b){var c,d,e,g,h=a.style;b=b.replace(br,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b))),!f.support.pixelMargin&&e&&bv.test(b)&&bt.test(c)&&(g=h.width,h.width=c,c=e.width,h.width=g);return c}),c.documentElement.currentStyle&&(bA=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f==null&&g&&(e=g[b])&&(f=e),bt.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),by=bz||bA,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){if(c){return a.offsetWidth!==0?bB(a,b,d):f.swap(a,bw,function(){return bB(a,b,d)})}},set:function(a,b){return bs.test(b)?b+"px":b}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bq.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bp,""))===""){c.removeAttribute("filter");if(d&&!d.filter){return}}c.filter=bp.test(g)?g.replace(bp,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){return f.swap(a,{display:"inline-block"},function(){return b?by(a,"margin-right"):a.style.marginRight})}})}),f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return !f.expr.filters.hidden(a)}),f.each({margin:"",padding:"",border:"Width"},function(a,b){f.cssHooks[a+b]={expand:function(c){var d,e=typeof c=="string"?c.split(" "):[c],f={};for(d=0;d<4;d++){f[a+bx[d]+b]=e[d]||e[d-2]||e[0]}return f}}});var bC=/%20/g,bD=/\[\]$/,bE=/\r?\n/g,bF=/#.*$/,bG=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bH=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bI=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bJ=/^(?:GET|HEAD)$/,bK=/^\/\//,bL=/\?/,bM=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bN=/^(?:select|textarea)/i,bO=/\s+/,bP=/([?&])_=[^&]*/,bQ=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bR=f.fn.load,bS={},bT={},bU,bV,bW=["*/"]+["*"];try{bU=e.href}catch(bX){bU=c.createElement("a"),bU.href="",bU=bU.href}bV=bQ.exec(bU.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bR){return bR.apply(this,arguments)}if(!this.length){return this}var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bM,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bN.test(this.nodeName)||bH.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bE,"\r\n")}}):{name:b.name,value:c.replace(bE,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b$(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b$(a,b);return a},ajaxSettings:{url:bU,isLocal:bI.test(bV[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bW},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bY(bS),ajaxTransport:bY(bT),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?ca(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified")){f.lastModified[k]=y}if(z=v.getResponseHeader("Etag")){f.etag[k]=z}}if(a===304){w="notmodified",o=!0}else{try{r=cb(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}}else{u=w;if(!w||a){w="error",a<0&&(a=0)}}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bG.exec(n)){o[c[1].toLowerCase()]=c[2]}}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2){for(b in a){j[b]=[j[b],a[b]]}}else{b=a[v.status],v.then(b,b)}}return this},d.url=((a||d.url)+"").replace(bF,"").replace(bK,bV[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bO),d.crossDomain==null&&(r=bQ.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bV[1]&&r[2]==bV[2]&&(r[3]||(r[1]==="http:"?80:443))==(bV[3]||(bV[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),bZ(bS,d,c,v);if(s===2){return !1}t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bJ.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bL.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bP,"$1_="+x);d.url=y+(y===d.url?(bL.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bW+"; q=0.01":""):d.accepts["*"]);for(u in d.headers){v.setRequestHeader(u,d.headers[u])}if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return !1}for(u in {success:1,error:1,complete:1}){v[u](d[u])}p=bZ(bT,d,c,v);if(!p){w(-1,"No Transport")}else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2){w(-1,z)}else{throw z}}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a)){f.each(a,function(){e(this.name,this.value)})}else{for(var g in a){b_(g,a[g],c,e)}}return d.join("&").replace(bC,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cc=f.now(),cd=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cc++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=typeof b.data=="string"&&/^application\/x\-www\-form\-urlencoded/.test(b.contentType);if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(cd.test(b.url)||e&&cd.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(cd,l),b.url===j&&(e&&(k=k.replace(cd,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState)){d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")}},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var ce=a.ActiveXObject?function(){for(var a in cg){cg[a](0,1)}}:!1,cf=0,cg;f.ajaxSettings.xhr=a.ActiveXObject?function(){return !this.isLocal&&ch()||ci()}:ch,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials" in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields){for(j in c.xhrFields){h[j]=c.xhrFields[j]}}c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e){h.setRequestHeader(j,e[j])}}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,ce&&delete cg[i]);if(e){h.readyState!==4&&h.abort()}else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n);try{m.text=h.responseText}catch(a){}try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cf,ce&&(cg||(cg={},f(a).unload(ce)),cg[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cj={},ck,cl,cm=/^(?:toggle|show|hide)$/,cn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,co,cp=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cq;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0){return this.animate(ct("show",3),a,b,c)}for(var g=0,h=this.length;g<h;g++){d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),(e===""&&f.css(d,"display")==="none"||!f.contains(d.ownerDocument.documentElement,d))&&f._data(d,"olddisplay",cu(d.nodeName)))}for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none"){d.style.display=f._data(d,"olddisplay")||""}}}return this},hide:function(a,b,c){if(a||a===0){return this.animate(ct("hide",3),a,b,c)}var d,e,g=0,h=this.length;for(;g<h;g++){d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e))}for(g=0;g<h;g++){this[g].style&&(this[g].style.display="none")}return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(ct("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o,p,q;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]);if((k=f.cssHooks[g])&&"expand" in k){l=k.expand(a[g]),delete a[g];for(i in l){i in a||(a[i]=l[i])}}}for(g in a){h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d){return b.complete.call(this)}c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cu(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a){j=new f.fx(this,b,i),h=a[i],cm.test(h)?(q=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),q?(f._data(this,"toggle"+i,q==="show"?"hide":"show"),j[q]()):j[h]()):(m=cn.exec(h),n=j.cur(),m?(o=parseFloat(m[2]),p=m[3]||(f.cssNumber[i]?"":"px"),p!=="px"&&(f.style(this,i,(o||1)+p),n=(o||1)/j.cur()*n,f.style(this,i,n+p)),m[1]&&(o=(m[1]==="-="?-1:1)*o+n),j.custom(n,o,p)):j.custom(n,h,""))}return !0}var e=f.speed(b,c,d);if(f.isEmptyObject(a)){return this.each(e.complete,[!1])}a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null){for(b in g){g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b)}}else{g[b=a+".run"]&&g[b].stop&&h(this,g,b)}for(b=e.length;b--;){e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1))}(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:ct("show",1),slideUp:ct("hide",1),slideToggle:ct("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0){d.queue="fx"}d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a){return a},swing:function(a){return -Math.cos(a*Math.PI)/2+0.5}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cq||cr(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){f._data(e.elem,"fxshow"+e.prop)===b&&(e.options.hide?f._data(e.elem,"fxshow"+e.prop,e.start):e.options.show&&f._data(e.elem,"fxshow"+e.prop,e.end))},h()&&f.timers.push(h)&&!co&&(co=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cq||cr(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties){i.animatedProperties[b]!==!0&&(g=!1)}if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show){for(b in i.animatedProperties){f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0)}}d=i.complete,d&&(i.complete=!1,d.call(h))}return !1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return !0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++){a=b[c],!a()&&b[c]===a&&b.splice(c--,1)}b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(co),co=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(cp.concat.apply([],cp),function(a,b){b.indexOf("margin")&&(f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)})}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cv,cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect" in c.documentElement?cv=function(a,b,c,d){try{d=a.getBoundingClientRect()}catch(e){}if(!d||!f.contains(c,a)){return d?{top:d.top,left:d.left}:{top:0,left:0}}var g=b.body,h=cy(b),i=c.clientTop||g.clientTop||0,j=c.clientLeft||g.clientLeft||0,k=h.pageYOffset||f.support.boxModel&&c.scrollTop||g.scrollTop,l=h.pageXOffset||f.support.boxModel&&c.scrollLeft||g.scrollLeft,m=d.top+k-i,n=d.left+l-j;return{top:m,left:n}}:cv=function(a,b,c){var d,e=a.offsetParent,g=a,h=b.body,i=b.defaultView,j=i?i.getComputedStyle(a,null):a.currentStyle,k=a.offsetTop,l=a.offsetLeft;while((a=a.parentNode)&&a!==h&&a!==c){if(f.support.fixedPosition&&j.position==="fixed"){break}d=i?i.getComputedStyle(a,null):a.currentStyle,k-=a.scrollTop,l-=a.scrollLeft,a===e&&(k+=a.offsetTop,l+=a.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(a.nodeName))&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),g=e,e=a.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&d.overflow!=="visible"&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),j=d}if(j.position==="relative"||j.position==="static"){k+=h.offsetTop,l+=h.offsetLeft}f.support.fixedPosition&&j.position==="fixed"&&(k+=Math.max(c.scrollTop,h.scrollTop),l+=Math.max(c.scrollLeft,h.scrollLeft));return{top:k,left:l}},f.fn.offset=function(a){if(arguments.length){return a===b?this:this.each(function(b){f.offset.setOffset(this,a,b)})}var c=this[0],d=c&&c.ownerDocument;if(!d){return null}if(c===d.body){return f.offset.bodyOffset(c)}return cv(c,d,d.documentElement)},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using" in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0]){return null}var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static"){a=a.offsetParent}return a})}}),f.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);f.fn[a]=function(e){return f.access(this,function(a,e,g){var h=cy(a);if(g===b){return h?c in h?h[c]:f.support.boxModel&&h.document.documentElement[e]||h.document.body[e]:a[e]}h?h.scrollTo(d?f(h).scrollLeft():g,d?g:f(h).scrollTop()):a[e]=g},a,e,arguments.length,null)}}),f.each({Height:"height",Width:"width"},function(a,c){var d="client"+a,e="scroll"+a,g="offset"+a;f.fn["inner"+a]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,c,"padding")):this[c]():null},f.fn["outer"+a]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,c,a?"margin":"border")):this[c]():null},f.fn[c]=function(a){return f.access(this,function(a,c,h){var i,j,k,l;if(f.isWindow(a)){i=a.document,j=i.documentElement[d];return f.support.boxModel&&j||i.body&&i.body[d]||j}if(a.nodeType===9){i=a.documentElement;if(i[d]>=i[e]){return i[d]}return Math.max(a.body[e],i[e],a.body[g],i[g])}if(h===b){k=f.css(a,c),l=parseFloat(k);return f.isNumeric(l)?l:k}f(a).css(c,h)},c,a,arguments.length,null)}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);
/*!!
 *  Canvas 2 Svg v1.0.2
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 */
(function(){var STYLES,ctx,CanvasGradient,CanvasPattern,namedEntities;function format(str,args){var keys=Object.keys(args),i;for(i=0;i<keys.length;i++){str=str.replace(new RegExp("\\{"+keys[i]+"\\}","gi"),args[keys[i]])}return str}function randomString(holder){var chars,randomstring,i;if(!holder){throw new Error("cannot create a random attribute name for an undefined object")}chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";randomstring="";do{randomstring="";for(i=0;i<12;i++){randomstring+=chars[Math.floor(Math.random()*chars.length)]}}while(holder[randomstring]);return randomstring}function createNamedToNumberedLookup(items,radix){var i,entity,lookup={},base10,base16;items=items.split(",");radix=radix||10;for(i=0;i<items.length;i+=2){entity="&"+items[i+1]+";";base10=parseInt(items[i],radix);lookup[entity]="&#"+base10+";"}lookup["\\xa0"]="&#160;";return lookup}namedEntities=createNamedToNumberedLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);STYLES={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"}};CanvasGradient=function(gradientNode){this.__root=gradientNode};CanvasGradient.prototype.addColorStop=function(offset,color){var stop=document.createElementNS("http://www.w3.org/2000/svg","stop"),regex,matches;stop.setAttribute("offset",offset);if(color.indexOf("rgba")!==-1){regex=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi;matches=regex.exec(color);stop.setAttribute("stop-color",format("rgb({r},{g},{b})",{r:matches[1],g:matches[2],b:matches[3]}));stop.setAttribute("stop-opacity",matches[4])}else{stop.setAttribute("stop-color",color)}this.__root.appendChild(stop)};CanvasPattern=function(pattern,ctx){this.__root=pattern;this.__ctx=ctx};ctx=function(o){var defaultOptions={width:500,height:500,enableMirroring:false},options;if(arguments.length>1){options=defaultOptions;options.width=arguments[0];options.height=arguments[1]}else{if(!o){options=defaultOptions}else{options=o}}if(!(this instanceof ctx)){return new ctx(options)}this.width=options.width||defaultOptions.width;this.height=options.height||defaultOptions.height;this.enableMirroring=options.enableMirroring!==undefined?options.enableMirroring:defaultOptions.enableMirroring;this.canvas=this;this.__canvas=document.createElement("canvas");this.__ctx=this.__canvas.getContext("2d");this.__setDefaultStyles();this.__stack=[this.__getStyleState()];this.__groupStack=[];this.__root=document.createElementNS("http://www.w3.org/2000/svg","svg");this.__root.setAttribute("version",1.1);this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg");this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");this.__root.setAttribute("width",this.width);this.__root.setAttribute("height",this.height);this.__ids={};this.__defs=document.createElementNS("http://www.w3.org/2000/svg","defs");this.__root.appendChild(this.__defs);this.__currentElement=document.createElementNS("http://www.w3.org/2000/svg","g");this.__root.appendChild(this.__currentElement)};ctx.prototype.__createElement=function(elementName,properties,resetFill){var element=document.createElementNS("http://www.w3.org/2000/svg",elementName),keys=Object.keys(properties),i,key;if(resetFill){element.setAttribute("fill","none");element.setAttribute("stroke","none")}for(i=0;i<keys.length;i++){key=keys[i];element.setAttribute(key,properties[key])}return element};ctx.prototype.__setDefaultStyles=function(){var keys=Object.keys(STYLES),i,key;for(i=0;i<keys.length;i++){key=keys[i];this[key]=STYLES[key].canvas}};ctx.prototype.__applyStyleState=function(styleState){var keys=Object.keys(styleState),i,key;for(i=0;i<keys.length;i++){key=keys[i];this[key]=styleState[key]}};ctx.prototype.__getStyleState=function(){var i,styleState={},keys=Object.keys(STYLES),key;for(i=0;i<keys.length;i++){key=keys[i];styleState[key]=this[key]}return styleState};ctx.prototype.__applyStyleToCurrentElement=function(type){var keys=Object.keys(STYLES),i,style,value,id,regex,matches;for(i=0;i<keys.length;i++){style=STYLES[keys[i]];value=this[keys[i]];if(style.apply){if(style.apply.indexOf("fill")!==-1&&value instanceof CanvasPattern){if(value.__ctx){while(value.__ctx.__defs.childNodes.length){id=value.__ctx.__defs.childNodes[0].getAttribute("id");this.__ids[id]=id;this.__defs.appendChild(value.__ctx.__defs.childNodes[0])}}this.__currentElement.setAttribute("fill",format("url(#{id})",{id:value.__root.getAttribute("id")}))}else{if(style.apply.indexOf("fill")!==-1&&value instanceof CanvasGradient){this.__currentElement.setAttribute("fill",format("url(#{id})",{id:value.__root.getAttribute("id")}))}else{if(style.apply.indexOf(type)!==-1&&style.svg!==value){if((style.svgAttr==="stroke"||style.svgAttr==="fill")&&value.indexOf("rgba")!==-1){regex=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi;matches=regex.exec(value);this.__currentElement.setAttribute(style.svgAttr,format("rgb({r},{g},{b})",{r:matches[1],g:matches[2],b:matches[3]}));this.__currentElement.setAttribute(style.svgAttr+"-opacity",matches[4])}else{this.__currentElement.setAttribute(style.svgAttr,value)}}}}}}};ctx.prototype.__closestGroupOrSvg=function(node){node=node||this.__currentElement;if(node.nodeName==="g"||node.nodeName==="svg"){return node}else{return this.__closestGroupOrSvg(node.parentNode)}};ctx.prototype.getSerializedSvg=function(fixNamedEntities){var serialized=new XMLSerializer().serializeToString(this.__root),keys,i,key,value,regexp,xmlns;xmlns=/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi;if(xmlns.test(serialized)){serialized=serialized.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')}if(fixNamedEntities){keys=Object.keys(namedEntities);for(i=0;i<keys.length;i++){key=keys[i];value=namedEntities[key];regexp=new RegExp(key,"gi");if(regexp.test(serialized)){serialized=serialized.replace(regexp,value)}}}return serialized};ctx.prototype.getSvg=function(){return this.__root};ctx.prototype.save=function(){var group=document.createElementNS("http://www.w3.org/2000/svg","g"),parent=this.__closestGroupOrSvg();this.__groupStack.push(parent);parent.appendChild(group);this.__currentElement=group;this.__stack.push(this.__getStyleState())};ctx.prototype.restore=function(){this.__currentElement=this.__groupStack.pop();var state=this.__stack.pop();this.__applyStyleState(state)};ctx.prototype.__addTransform=function(t){var transform=this.__currentElement.getAttribute("transform");if(transform){transform+=" "}else{transform=""}transform+=t;this.__currentElement.setAttribute("transform",transform)};ctx.prototype.scale=function(x,y){if(y===undefined){y=x}this.__addTransform(format("scale({x},{y})",{x:x,y:y}))};ctx.prototype.rotate=function(angle){var degrees=(angle*180/Math.PI);this.__addTransform(format("rotate({angle},{cx},{cy})",{angle:degrees,cx:0,cy:0}))};ctx.prototype.translate=function(x,y){this.__addTransform(format("translate({x},{y})",{x:x,y:y}))};ctx.prototype.transform=function(a,b,c,d,e,f){this.__addTransform(format("matrix({a},{b},{c},{d},{e},{f})",{a:a,b:b,c:c,d:d,e:e,f:f}))};ctx.prototype.beginPath=function(){var path,parent;path=this.__createElement("path",{},true);parent=this.__closestGroupOrSvg();parent.appendChild(path);this.__currentElement=path};ctx.prototype.__addPathCommand=function(command){if(this.__currentElement.nodeName==="path"){var d=this.__currentElement.getAttribute("d");if(d){d+=" "}else{d=""}d+=command;this.__currentElement.setAttribute("d",d)}else{throw new Error("Attempted to add path command to node "+this.__currentElement.nodeName)}};ctx.prototype.moveTo=function(x,y){this.__addPathCommand(format("M {x} {y}",{x:x,y:y}))};ctx.prototype.closePath=function(){this.__addPathCommand("Z")};ctx.prototype.lineTo=function(x,y){this.__addPathCommand(format("L {x} {y}",{x:x,y:y}))};ctx.prototype.bezierCurveTo=function(cp1x,cp1y,cp2x,cp2y,x,y){this.__addPathCommand(format("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:cp1x,cp1y:cp1y,cp2x:cp2x,cp2y:cp2y,x:x,y:y}))};ctx.prototype.quadraticCurveTo=function(cpx,cpy,x,y){this.__addPathCommand(format("Q {cpx} {cpy} {x} {y}",{cpx:cpx,cpy:cpy,x:x,y:y}))};ctx.prototype.stroke=function(){this.__applyStyleToCurrentElement("stroke")};ctx.prototype.fill=function(){this.__applyStyleToCurrentElement("fill")};ctx.prototype.rect=function(x,y,width,height){if(this.__currentElement.nodeName!=="path"){this.beginPath()}this.moveTo(x,y);this.lineTo(x+width,y);this.lineTo(x+width,y+height);this.lineTo(x,y+height);this.lineTo(x,y);this.closePath()};ctx.prototype.fillRect=function(x,y,width,height){var rect,parent;rect=this.__createElement("rect",{x:x,y:y,width:width,height:height},true);parent=this.__closestGroupOrSvg();parent.appendChild(rect);this.__currentElement=rect;this.__applyStyleToCurrentElement("fill")};ctx.prototype.strokeRect=function(x,y,width,height){var rect,parent;rect=this.__createElement("rect",{x:x,y:y,width:width,height:height},true);parent=this.__closestGroupOrSvg();parent.appendChild(rect);this.__currentElement=rect;this.__applyStyleToCurrentElement("stroke")};ctx.prototype.clearRect=function(x,y,width,height){var rect,parent=this.__closestGroupOrSvg();rect=this.__createElement("rect",{x:x,y:y,width:width,height:height,fill:"#FFFFFF"},true);parent.appendChild(rect)};ctx.prototype.createLinearGradient=function(x1,y1,x2,y2){var grad=this.__createElement("linearGradient",{id:randomString(this.__ids),x1:x1+"px",x2:x2+"px",y1:y1+"px",y2:y2+"px",gradientUnits:"userSpaceOnUse"},false);this.__defs.appendChild(grad);return new CanvasGradient(grad)};ctx.prototype.createRadialGradient=function(x0,y0,r0,x1,y1,r1){var grad=this.__createElement("radialGradient",{id:randomString(this.__ids),cx:x1+"px",cy:y1+"px",r:r1+"px",fx:x0+"px",fy:y0+"px",gradientUnits:"userSpaceOnUse"},false);this.__defs.appendChild(grad);return new CanvasGradient(grad)};ctx.prototype.__parseFont=function(){var font=this.font,parts,token,index=0,data={style:"normal",size:"10px",family:"sans-serif",weight:"normal",decoration:"none",href:null};if(this.__fontUnderline==="underline"){data.decoration="underline"}if(this.__fontHref){data.href=this.__fontHref}parts=font.split(" ");token=parts[index];while(/italic|bold|normal/.test(token)){if(token==="bold"){data.weight=token}else{data.style=token}index++;token=parts[index]}if(/em|px|pt|%/.test(token)){data.size=token;index++}parts.splice(0,index);data.family=parts.join(" ");return data};ctx.prototype.__wrapTextLink=function(font,element){if(font.href){var a=document.createElementNS("http://www.w3.org/2000/svg","a");a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",font.href);a.appendChild(element);return a}return element};ctx.prototype.__applyText=function(text,x,y,action){var font=this.__parseFont(),parent=this.__closestGroupOrSvg(),textElement=this.__createElement("text",{"font-family":font.family,"font-size":font.size,"font-style":font.style,"font-weight":font.weight,"text-decoration":font.decoration,x:x,y:y},true);textElement.appendChild(document.createTextNode(text));this.__currentElement=textElement;this.__applyStyleToCurrentElement(action);parent.appendChild(this.__wrapTextLink(font,textElement))};ctx.prototype.fillText=function(text,x,y){this.__applyText(text,x,y,"fill")};ctx.prototype.strokeText=function(text,x,y){this.__applyText(text,x,y,"stroke")};ctx.prototype.measureText=function(text){return this.__ctx.measureText(text)};ctx.prototype.arc=function(x,y,radius,startAngle,endAngle,counterClockwise){startAngle=startAngle%(2*Math.PI);endAngle=endAngle%(2*Math.PI);if(startAngle===endAngle){endAngle=((endAngle+(2*Math.PI))-0.001*(counterClockwise?-1:1))%(2*Math.PI)}var endX=x+radius*Math.cos(endAngle),endY=y+radius*Math.sin(endAngle),startX=x+radius*Math.cos(startAngle),startY=y+radius*Math.sin(startAngle),sweepFlag=counterClockwise?0:1,largeArcFlag;if(counterClockwise){largeArcFlag=Math.abs(endAngle-startAngle)>Math.PI?0:1}else{largeArcFlag=Math.abs(endAngle-startAngle)>Math.PI?1:0}this.moveTo(startX,startY);this.__addPathCommand(format("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:radius,ry:radius,xAxisRotation:0,largeArcFlag:largeArcFlag,sweepFlag:sweepFlag,endX:endX,endY:endY}))};ctx.prototype.clip=function(){var group=this.__closestGroupOrSvg(),clipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),id=randomString(this.__ids),newGroup=document.createElementNS("http://www.w3.org/2000/svg","g");group.removeChild(this.__currentElement);clipPath.setAttribute("id",id);clipPath.appendChild(this.__currentElement);this.__defs.appendChild(clipPath);group.setAttribute("clip-path",format("url(#{id})",{id:id}));group.appendChild(newGroup);this.__currentElement=newGroup};ctx.prototype.drawImage=function(){var args=Array.prototype.slice.call(arguments),image=args[0],dx,dy,dw,dh,sx=0,sy=0,sw,sh,parent,svg,defs,group,currentElement,svgImage,canvas,context,id;if(args.length===3){dx=args[1];dy=args[2];sw=image.width;sh=image.height;dw=sw;dh=sh}else{if(args.length===5){dx=args[1];dy=args[2];dw=args[3];dh=args[4];sw=image.width;sh=image.height}else{if(args.length===9){sx=args[1];sy=args[2];sw=args[3];sh=args[4];dx=args[5];dy=args[6];dw=args[7];dh=args[8]}else{throw new Error("Inavlid number of arguments passed to drawImage: "+arguments.length)}}}parent=this.__closestGroupOrSvg();currentElement=this.__currentElement;if(image instanceof ctx){svg=image.getSvg();defs=svg.childNodes[0];while(defs.childNodes.length){id=defs.childNodes[0].getAttribute("id");this.__ids[id]=id;this.__defs.appendChild(defs.childNodes[0])}group=svg.childNodes[1];parent.appendChild(group);this.__currentElement=group;this.translate(dx,dy);this.__currentElement=currentElement}else{if(image.nodeName==="CANVAS"||image.nodeName==="IMG"){svgImage=document.createElementNS("http://www.w3.org/2000/svg","image");svgImage.setAttribute("width",dw);svgImage.setAttribute("height",dh);svgImage.setAttribute("preserveAspectRatio","none");if(sx||sy||sw!==image.width||sh!==image.height){canvas=document.createElement("canvas");canvas.width=dw;canvas.height=dh;context=canvas.getContext("2d");context.drawImage(image,sx,sy,sw,sh,0,0,dw,dh);image=canvas}svgImage.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",image.nodeName==="CANVAS"?image.toDataURL():image.getAttribute("src"));parent.appendChild(svgImage);this.__currentElement=svgImage;this.translate(dx,dy);this.__currentElement=currentElement}}};ctx.prototype.createPattern=function(image,repetition){var pattern=document.createElementNS("http://www.w3.org/2000/svg","pattern"),id=randomString(this.__ids),img;pattern.setAttribute("id",id);pattern.setAttribute("width",image.width);pattern.setAttribute("height",image.height);if(image.nodeName==="CANVAS"||image.nodeName==="IMG"){img=document.createElementNS("http://www.w3.org/2000/svg","image");img.setAttribute("width",image.width);img.setAttribute("height",image.height);img.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",image.nodeName==="CANVAS"?image.toDataURL():image.getAttribute("src"));pattern.appendChild(img);this.__defs.appendChild(pattern)}else{if(image instanceof ctx){pattern.appendChild(image.__root.childNodes[1]);this.__defs.appendChild(pattern)}}return new CanvasPattern(pattern,this)};ctx.prototype.drawFocusRing=function(){};ctx.prototype.createImageData=function(){};ctx.prototype.getImageData=function(){};ctx.prototype.putImageData=function(){};ctx.prototype.globalCompositeOperation=function(){};ctx.prototype.arcTo=function(){};ctx.prototype.setTransform=function(){};window.C2S=ctx}());var _gliffy={};_gliffy.renderers={};_gliffy.stages={};_gliffy.Debug={SKIP_CATCH_ERRORS:false,SKIP_RENDER_LOOP:false,DISPLAY_GUIDES:false,NO_CONTEXT_MENU:false,NO_ERROR_DIALOG:false,FINITE_NUMBER_CHECKS:false,NO_TIPS:false,NO_NAVIGATE_WARNING:false,STARTUP_FILE:null,LOG_TO_CONSOLE:false,LOG_ANALYTICS:false,USE_ANALYTICS_DEBUG_JS:false,SHOW_MOUSE_COORDS:false,I18N_UNDERSCORES:false,SHOW_RTREE:false};_gliffy.FEATURES={charts:false,tables:false,umlV1:false,umlV2:true,uiV2:true,uiV3:true,allowDisableAutosave:false};_gliffy.versionString="unavailable";_gliffy.confluenceVersion="unavailable";_gliffy.workQueue=$({});_gliffy.textDimensionMap={width:{},height:{}};_gliffy.textDimensionMapSize={width:0,height:0};_gliffy.MIN_OPACITY=0.008;_gliffy.MIN_VISIBLE_VALUE=2;_gliffy.clipboard=null;_gliffy.camelMap={};_gliffy.camelSize=0;$.camelCase=function(string){var getCamel=function(string){return string.replace(/^-ms-/,"ms-").replace(/-([a-z]|[0-9])/ig,function(all,letter){return(letter+"").toUpperCase()})};if(_gliffy.camelMap[string]===undefined){_gliffy.camelMap[string]=getCamel(string);if(++_gliffy.camelSize>1000){_gliffy.camelSize=0;_gliffy.camelMap={}}}return _gliffy.camelMap[string]};(function(){if(typeof Function.empty!="function"){Function.empty=function(){}}if(typeof console=="undefined"){console={}}if(typeof console.log=="undefined"){console.log=Function.empty}if(typeof console.debug=="undefined"){console.debug=log}if(typeof console.info=="undefined"){console.info=log}if(typeof console.warn=="undefined"){console.warn=log}if(typeof console.error=="undefined"){console.error=log}if(typeof console.assert=="undefined"){console.assert=function(){var args=Array.prototype.slice.call(arguments);var parm=args.shift();if(!parm){console.error(arguments);throw new Error("Assert failed.")}}}if(typeof console.dir=="undefined"){console.dir=function(input){if(typeof JSON!="undefined"&&typeof JSON.stringify=="function"){console.log(JSON.stringify(input))}else{console.log(input.toString())}}}if(typeof console.dirxml=="undefined"){console.dirxml=console.dir}if(typeof console.trace=="undefined"){console.trace=Function.empty}if(typeof console.group=="undefined"){console.group=Function.empty}if(typeof console.groupCollapsed=="undefined"){console.groupCollapsed=Function.empty}if(typeof console.groupEnd=="undefined"){console.groupEnd=Function.empty}if(typeof console.time=="undefined"){console.time=Function.empty}if(typeof console.timeEnd=="undefined"){console.timeEnd=Function.empty}if(typeof console.profile=="undefined"){console.profile=Function.empty}if(typeof console.profileEnd=="undefined"){console.profileEnd=Function.empty}if(typeof console.count=="undefined"){console.count=Function.empty}function log(){if(typeof JSON!="undefined"&&typeof JSON.stringify=="function"){return console.log(JSON.stringify(arguments))}return console.log(arguments.toString())}})();(function(){_gliffy.BrowserDetect={init:function(){var isIE11=!!navigator.userAgent.match(/Trident\/7.0/);if(isIE11){this.browser="Explorer";this.version=11}else{this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version"}this.OS=this.searchString(this.dataOS)||"an unknown OS"},dump:function(){return"OS: "+this.OS+", Browser: "+this.browser+", Version: "+this.version},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1){return data[i].identity}}else{if(dataProp){return data[i].identity}}}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1){return}return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};_gliffy.BrowserDetect.init()}());
/*!! Simple JavaScript Inheritance
 * By John Resig http://ejohn.org/
 * MIT Licensed.
 * http://ejohn.org/blog/simple-javascript-inheritance
 *
 */
(function(){var initializing=false,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;var Class=function(){};Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret}})(name,prop[name]):prop[name]}function Class(){if(!(this instanceof Class)){return new Class(arguments)}if(!initializing&&this.init){this.init.apply(this,arguments)}}Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=arguments.callee;return Class};_gliffy.Class=Class})();
/*!!
 * jqModal - Minimalist Modaling with jQuery
 *   (http://dev.iceburg.net/jquery/jqModal/)
 *
 * Copyright (c) 2007,2008 Brice Burgess <bhb@iceburg.net>
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 * 
 * $Version: 03/01/2009 +r14
 */
(function($){$.fn.jqm=function(o){var p={overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:F,ajaxText:"",target:F,modal:F,toTop:F,onShow:F,onHide:F,onLoad:F};return this.each(function(){if(this._jqm){return H[this._jqm].c=$.extend({},H[this._jqm].c,o)}s++;this._jqm=s;H[s]={c:$.extend(p,$.jqm.params,o),a:F,w:$(this).addClass("jqmID"+s),s:s};if(p.trigger){$(this).jqmAddTrigger(p.trigger)}})};$.fn.jqmAddClose=function(e){return hs(this,e,"jqmHide")};$.fn.jqmAddTrigger=function(e){return hs(this,e,"jqmShow")};$.fn.jqmShow=function(t){return this.each(function(){t=t||window.event;$.jqm.open(this._jqm,t)})};$.fn.jqmHide=function(t){return this.each(function(){t=t||window.event;$.jqm.close(this._jqm,t)})};$.jqm={hash:{},open:function(s,t){var h=H[s],c=h.c,cc="."+c.closeClass,z=(parseInt(h.w.css("z-index"))),z=(z>0)?z:3000,o=$("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":z-1,opacity:c.overlay/100});if(h.a){return F}h.t=t;h.a=true;h.w.css("z-index",z);if(c.modal){if(!A[0]){L("bind")}A.push(s)}else{if(c.overlay>0){h.w.jqmAddClose(o)}else{o=F}}h.o=(o)?o.addClass(c.overlayClass).prependTo("body"):F;if(ie6){$("html,body").css({height:"100%",width:"100%"});if(o){o=o.css({position:"absolute"})[0];for(var y in {Top:1,Left:1}){o.style.setExpression(y.toLowerCase(),"(_=(document.documentElement.scroll"+y+" || document.body.scroll"+y+"))+'px'")}}}if(c.ajax){var r=c.target||h.w,u=c.ajax,r=(typeof r=="string")?$(r,h.w):$(r),u=(u.substr(0,1)=="@")?$(t).attr(u.substring(1)):u;r.html(c.ajaxText).load(u,function(){if(c.onLoad){c.onLoad.call(this,h)}if(cc){h.w.jqmAddClose($(cc,h.w))}e(h)})}else{if(cc){h.w.jqmAddClose($(cc,h.w))}}if(c.toTop&&h.o){h.w.before('<span id="jqmP'+h.w[0]._jqm+'"></span>').insertAfter(h.o)}(c.onShow)?c.onShow(h):h.w.show();return F},close:function(s){var h=H[s];if(!h.a){return F}h.a=F;if(A[0]){A.pop();if(!A[0]){L("unbind")}}if(h.c.toTop&&h.o){$("#jqmP"+h.w[0]._jqm).after(h.w).remove()}if(h.c.onHide){h.c.onHide(h)}else{h.w.hide();if(h.o){h.o.remove()}}return F},params:{}};var s=0,H=$.jqm.hash,A=[],ie6=$.browser.msie&&($.browser.version=="6.0"),F=false,i=$('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),e=function(h){if(ie6){if(h.o){h.o.html('<p style="width:100%;height:100%"/>').prepend(i)}else{if(!$("iframe.jqm",h.w)[0]){h.w.prepend(i)}}}f(h)},f=function(h){try{if($(":input:visible",h.w).length>0){$(":input:visible",h.w)[0].focus()}}catch(_){}},L=function(t){$()[t]("keypress",m)[t]("keydown",m)[t]("mousedown",m)},m=function(e){var h=H[A[A.length-1]],r=(!$(e.target).parents(".jqmID"+h.s)[0]);if(r){f(h)}return !r},hs=function(w,t,c){return w.each(function(){var s=this._jqm;$(t).each(function(){if(!this[c]){this[c]=[];$(this).click(function(){for(var i in {jqmShow:1,jqmHide:1}){for(var s in this[i]){if(H[this[i][s]]){H[this[i][s]].w[i](this)}}}return F})}this[c].push(s)})})}})(jQuery);
/*!!
 * jquery.event.drag - v 2.0.0 
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */
(function($){$.fn.drag=function(str,arg,opts){var type=typeof str=="string"?str:"",fn=$.isFunction(str)?str:$.isFunction(arg)?arg:null;if(type.indexOf("drag")!==0){type="drag"+type}opts=(str==fn?arg:opts)||{};return fn?this.bind(type,opts,fn):this.trigger(type)};var $event=$.event,$special=$event.special,drag=$special.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:false,drop:true,click:false},datakey:"dragdata",livekey:"livedrag",add:function(obj){var data=$.data(this,drag.datakey),opts=obj.data||{};data.related+=1;if(!data.live&&obj.selector){data.live=true;$event.add(this,"draginit."+drag.livekey,drag.delegate)}$.each(drag.defaults,function(key,def){if(opts[key]!==undefined){data[key]=opts[key]}})},remove:function(){$.data(this,drag.datakey).related-=1},setup:function(){if($.data(this,drag.datakey)){return}var data=$.extend({related:0},drag.defaults);$.data(this,drag.datakey,data);$event.add(this,"mousedown",drag.init,data);if(this.attachEvent){this.attachEvent("ondragstart",drag.dontstart)}},teardown:function(){if($.data(this,drag.datakey).related){return}$.removeData(this,drag.datakey);$event.remove(this,"mousedown",drag.init);$event.remove(this,"draginit",drag.delegate);drag.textselect(true,$(this).closest("html").parent().get(0));if(this.detachEvent){this.detachEvent("ondragstart",drag.dontstart)}},init:function(event){var dd=event.data,results;if(dd.which>0&&event.which!=dd.which){return}if($(event.target).is(dd.not)){return}if(dd.handle&&!$(event.target).closest(dd.handle,event.currentTarget).length){return}dd.propagates=1;dd.document=this.ownerDocument;dd.interactions=[drag.interaction(this,dd)];dd.target=event.target;dd.pageX=event.pageX;dd.pageY=event.pageY;dd.dragging=null;results=drag.hijack(event,"draginit",dd);if(!dd.propagates){return}results=drag.flatten(results);if(results&&results.length){dd.interactions=[];$.each(results,function(){dd.interactions.push(drag.interaction(this,dd))})}dd.propagates=dd.interactions.length;if(dd.drop!==false&&$special.drop){$special.drop.handler(event,dd)}drag.textselect(false,dd.document);$event.add($(this).closest("html").parent().get(0),"mousemove mouseup",drag.handler,dd);return false},interaction:function(elem,dd){return{drag:elem,callback:new drag.callback(),droppable:[],offset:$(elem)[dd.relative?"position":"offset"]()||{top:0,left:0}}},handler:function(event){var dd=event.data;switch(event.type){case !dd.dragging&&"mousemove":if(Math.pow(event.pageX-dd.pageX,2)+Math.pow(event.pageY-dd.pageY,2)<Math.pow(dd.distance,2)){break}event.target=dd.target;drag.hijack(event,"dragstart",dd);if(dd.propagates){dd.dragging=true}case"mousemove":if(dd.dragging){drag.hijack(event,"drag",dd);if(dd.propagates){if(dd.drop!==false&&$special.drop){$special.drop.handler(event,dd)}break}event.type="mouseup"}case"mouseup":$event.remove(dd.document,"mousemove mouseup",drag.handler);if(dd.dragging){if(dd.drop!==false&&$special.drop){$special.drop.handler(event,dd)}drag.hijack(event,"dragend",dd)}drag.textselect(true,dd.document);if(dd.click===false&&dd.dragging){jQuery.event.triggered=true;setTimeout(function(){jQuery.event.triggered=false},20);dd.dragging=false}break}},delegate:function(event){var elems=[],target,events=$.data(this,"events")||{};$.each(events.live||[],function(i,obj){if(obj.preType.indexOf("drag")!==0){return}target=$(event.target).closest(obj.selector,event.currentTarget)[0];if(!target){return}$event.add(target,obj.origType+"."+drag.livekey,obj.origHandler,obj.data);if($.inArray(target,elems)<0){elems.push(target)}});if(!elems.length){return false}return $(elems).bind("dragend."+drag.livekey,function(){$event.remove(this,"."+drag.livekey)})},hijack:function(event,type,dd,x,elem){if(!dd){return}var orig={event:event.originalEvent,type:event.type},mode=type.indexOf("drop")?"drag":"drop",result,i=x||0,ia,$elems,callback,len=!isNaN(x)?x:dd.interactions.length;event.type=type;event.originalEvent=null;dd.results=[];do{if(ia=dd.interactions[i]){if(type!=="dragend"&&ia.cancelled){continue}callback=drag.properties(event,dd,ia);ia.results=[];$(elem||ia[mode]||dd.droppable).each(function(p,subject){callback.target=subject;result=subject?$event.handle.call(subject,event,callback):null;if(result===false){if(mode=="drag"){ia.cancelled=true;dd.propagates-=1}if(type=="drop"){ia[mode][p]=null}}else{if(type=="dropinit"){ia.droppable.push(drag.element(result)||subject)}}if(type=="dragstart"){ia.proxy=$(drag.element(result)||ia.drag)[0]}ia.results.push(result);delete event.result;if(type!=="dropinit"){return result}});dd.results[i]=drag.flatten(ia.results);if(type=="dropinit"){ia.droppable=drag.flatten(ia.droppable)}if(type=="dragstart"&&!ia.cancelled){callback.update()}}}while(++i<len);event.type=orig.type;event.originalEvent=orig.event;return drag.flatten(dd.results)},properties:function(event,dd,ia){var obj=ia.callback;obj.drag=ia.drag;obj.proxy=ia.proxy||ia.drag;obj.startX=dd.pageX;obj.startY=dd.pageY;obj.deltaX=event.pageX-dd.pageX;obj.deltaY=event.pageY-dd.pageY;obj.originalX=ia.offset.left;obj.originalY=ia.offset.top;obj.offsetX=event.pageX-(dd.pageX-obj.originalX);obj.offsetY=event.pageY-(dd.pageY-obj.originalY);obj.drop=drag.flatten((ia.drop||[]).slice());obj.available=drag.flatten((ia.droppable||[]).slice());return obj},element:function(arg){if(arg&&(arg.jquery||arg.nodeType==1)){return arg}},flatten:function(arr){return $.map(arr,function(member){return member&&member.jquery?$.makeArray(member):member&&member.length?drag.flatten(member):member})},textselect:function(bool,doc){$(doc)[bool?"unbind":"bind"]("selectstart",drag.dontstart).attr("unselectable",bool?"off":"on").css("MozUserSelect",bool?"":"none")},dontstart:function(){return false},callback:function(){}};drag.callback.prototype={update:function(){if($special.drop&&this.available.length){$.each(this.available,function(i){$special.drop.locate(this,i)})}}};$special.draginit=$special.dragstart=$special.dragend=drag})(jQuery);(function(jQuery){jQuery.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"numpadplus",109:"numpadminus",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",187:"plus",189:"minus",61:"ffplus",173:"ffminus"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};function keyHandler(handleObj){if(typeof handleObj.data!=="string"){return}var origHandler=handleObj.handler,keys=handleObj.data.toLowerCase().split(" ");handleObj.handler=function(event){if(this!==event.target&&(/textarea|select/i.test(event.target.nodeName)||event.target.type==="text")){return}var special=event.type!=="keypress"&&jQuery.hotkeys.specialKeys[event.which],character=String.fromCharCode(event.which).toLowerCase(),key,modif="",possible={};if(event.altKey&&special!=="alt"){modif+="alt+"}if(event.ctrlKey&&special!=="ctrl"){modif+="ctrl+"}if(event.metaKey&&!event.ctrlKey&&special!=="meta"){modif+="meta+"}if(event.shiftKey&&special!=="shift"){modif+="shift+"}if(special){possible[modif+special]=true}else{possible[modif+character]=true;possible[modif+jQuery.hotkeys.shiftNums[character]]=true;if(modif==="shift+"){possible[jQuery.hotkeys.shiftNums[character]]=true}}for(var i=0,l=keys.length;i<l;i++){if(possible[keys[i]]){return origHandler.apply(this,arguments)}}}}jQuery.each(["keydown","keyup","keypress"],function(){jQuery.event.special[this]={add:keyHandler}})})(jQuery);
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 *
 * Requires: 1.2.2+
 */
(function($){var types=["DOMMouseScroll","mousewheel"];if($.event.fixHooks){for(var i=types.length;i;){$.event.fixHooks[types[--i]]=$.event.mouseHooks}}$.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var i=types.length;i;){this.addEventListener(types[--i],handler,false)}}else{this.onmousewheel=handler}},teardown:function(){if(this.removeEventListener){for(var i=types.length;i;){this.removeEventListener(types[--i],handler,false)}}else{this.onmousewheel=null}}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}});function handler(event){var orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,returnValue=true,deltaX=0,deltaY=0;event=$.event.fix(orgEvent);event.type="mousewheel";if(orgEvent.wheelDelta){delta=orgEvent.wheelDelta/120}if(orgEvent.detail){delta=-orgEvent.detail/3}deltaY=delta;if(orgEvent.axis!==undefined&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS){deltaY=0;deltaX=-1*delta}if(orgEvent.wheelDeltaY!==undefined){deltaY=orgEvent.wheelDeltaY/120}if(orgEvent.wheelDeltaX!==undefined){deltaX=-1*orgEvent.wheelDeltaX/120}args.unshift(event,delta,deltaX,deltaY);return($.event.dispatch||$.event.handle).apply(this,args)}})(jQuery);(function($){$.i18n={dict:null,setDictionary:function(i18n_dict){this.dict=i18n_dict},_:function(str,params){var result=str;if(this.dict&&this.dict[str]){result=this.dict[str]}return this.printf(result,params)},printf:function(str,args){if(!args){return str}var result="";var search=/%(\d+)\$s/g;var matches=search.exec(str);while(matches){var index=parseInt(matches[1],10)-1;str=str.replace("%"+matches[1]+"$s",(args[index]));matches=search.exec(str)}var parts=str.split("%s");if(parts.length>1){for(var i=0;i<args.length;i++){if(parts[i].length>0&&parts[i].lastIndexOf("%")==(parts[i].length-1)){parts[i]+="s"+parts.splice(i+1,1)[0]}result+=parts[i]+args[i]}}return result+parts[parts.length-1]}};$.fn._t=function(str,params){return $(this).text($.i18n._(str,params))}})(jQuery);(function($,undefined){var hidden="hidden",copy='<textarea style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden">',copyStyle=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing"],oninput="oninput",onpropertychange="onpropertychange",test=$(copy)[0];test.setAttribute(oninput,"return");if($.isFunction(test[oninput])||onpropertychange in test){$.fn.autosize=function(o){var options=$.extend({className:null,heightCallback:function(){}},o);var className=options.className;var heightCallback=options.heightCallback;return this.each(function(){var ta=this,$ta=$(ta).css({overflow:hidden,overflowY:hidden,wordWrap:"break-word"}),mirror=$(copy).addClass(className||"autosizejs")[0],minHeight=$ta.height(),maxHeight=parseInt($ta.css("maxHeight"),10),active,i=copyStyle.length;maxHeight=maxHeight&&maxHeight>0?maxHeight:90000;function adjust(){var height,overflow;if(!active){active=true;mirror.value=ta.value;mirror.style.overflowY=ta.style.overflowY;mirror.style.width=$ta.css("width");mirror.scrollTop=0;mirror.scrollTop=90000;height=mirror.scrollTop;if(heightCallback){heightCallback(height)}overflow=hidden;if(height>maxHeight){height=maxHeight;overflow="scroll"}else{if(height<minHeight){height=minHeight}}ta.style.overflowY=overflow;ta.style.height=ta.style.minHeight=ta.style.maxHeight=height+"px";setTimeout(function(){active=false},1)}}while(i--){mirror.style[copyStyle[i]]=$ta.css(copyStyle[i])}$("body").append(mirror);if(onpropertychange in ta){if(oninput in ta){ta[oninput]=ta.onkeyup=adjust}else{ta[onpropertychange]=adjust}}else{ta[oninput]=adjust}$(window).resize(adjust);$ta.bind("autosize",adjust);adjust()})}}else{$.fn.autosize=function(){return this}}}(jQuery));
/*!!
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * @link   http://www.phpied.com/rgb-color-parser-in-javascript/
 * @license Use it if you like it
 */
(function(){var RGBColor=function(color_string){this.ok=false;if(color_string.charAt(0)=="#"){color_string=color_string.substr(1,6)}color_string=color_string.replace(/ /g,"");color_string=color_string.toLowerCase();var simple_colors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var key in simple_colors){if(color_string==key){color_string=simple_colors[key]}}var color_defs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(bits){return[parseInt(bits[1]),parseInt(bits[2]),parseInt(bits[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(bits){return[parseInt(bits[1],16),parseInt(bits[2],16),parseInt(bits[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(bits){return[parseInt(bits[1]+bits[1],16),parseInt(bits[2]+bits[2],16),parseInt(bits[3]+bits[3],16)]}}];for(var i=0;i<color_defs.length;i++){var re=color_defs[i].re;var processor=color_defs[i].process;var bits=re.exec(color_string);if(bits){channels=processor(bits);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toRGBA=function(a){return"rgba("+this.r+", "+this.g+", "+this.b+", "+a+")"};this.toHex=function(){var r=this.r.toString(16);var g=this.g.toString(16);var b=this.b.toString(16);if(r.length==1){r="0"+r}if(g.length==1){g="0"+g}if(b.length==1){b="0"+b}return"#"+r+g+b};this.getHelpXML=function(){var examples=new Array();for(var i=0;i<color_defs.length;i++){var example=color_defs[i].example;for(var j=0;j<example.length;j++){examples[examples.length]=example[j]}}for(var sc in simple_colors){examples[examples.length]=sc}var xml=document.createElement("ul");xml.setAttribute("id","rgbcolor-examples");for(var i=0;i<examples.length;i++){try{var list_item=document.createElement("li");var list_color=new RGBColor(examples[i]);var example_div=document.createElement("div");example_div.style.cssText="margin: 3px; border: 1px solid black; background:"+list_color.toHex()+"; color:"+list_color.toHex();example_div.appendChild(document.createTextNode("test"));var list_item_value=document.createTextNode(" "+examples[i]+" -> "+list_color.toRGB()+" -> "+list_color.toHex());list_item.appendChild(example_div);list_item.appendChild(list_item_value);xml.appendChild(list_item)}catch(e){}}return xml}};_gliffy.RGBColor=RGBColor})();(function(){var isFiniteNumber=function(num){return isFinite(num)&&!isNaN(num)};var isNumber=function(val){return typeof val=="number"};var checkFiniteNumbers=function(args){if(_gliffy.Debug.FINITE_NUMBER_CHECKS){var len=args.length;for(var i=0;i<len;i++){if(!isFiniteNumber(args[i])){throw Error("Invalid transform parameters")}}}};var AffineTransform=function(opt_m00,opt_m10,opt_m01,opt_m11,opt_m02,opt_m12){checkFiniteNumbers(arguments);if(arguments.length==6){this.setTransform((opt_m00),(opt_m10),(opt_m01),(opt_m11),(opt_m02),(opt_m12))}else{if(arguments.length!=0){throw Error("Insufficient matrix parameters")}else{this.m00_=this.m11_=1;this.m10_=this.m01_=this.m02_=this.m12_=0}}};AffineTransform.prototype.isIdentity=function(){return this.m00_==1&&this.m10_==0&&this.m01_==0&&this.m11_==1&&this.m02_==0&&this.m12_==0};AffineTransform.prototype.clone=function(){return new AffineTransform(this.m00_,this.m10_,this.m01_,this.m11_,this.m02_,this.m12_)};AffineTransform.prototype.setTransform=function(m00,m10,m01,m11,m02,m12){checkFiniteNumbers(arguments);this.m00_=m00;this.m10_=m10;this.m01_=m01;this.m11_=m11;this.m02_=m02;this.m12_=m12;return this};AffineTransform.prototype.copyFrom=function(tx){checkFiniteNumbers([tx.m00_,tx.m01_,tx.m02_,tx.m10_,tx.m11_,tx.m12_]);this.m00_=tx.m00_;this.m10_=tx.m10_;this.m01_=tx.m01_;this.m11_=tx.m11_;this.m02_=tx.m02_;this.m12_=tx.m12_;return this};AffineTransform.prototype.scale=function(sx,sy){checkFiniteNumbers(arguments);this.m00_*=sx;this.m10_*=sx;this.m01_*=sy;this.m11_*=sy;return this};AffineTransform.prototype.preScale=function(sx,sy){checkFiniteNumbers(arguments);this.m00_*=sx;this.m01_*=sx;this.m02_*=sx;this.m10_*=sy;this.m11_*=sy;this.m12_*=sy;return this};AffineTransform.prototype.translate=function(dx,dy){checkFiniteNumbers(arguments);this.m02_+=dx*this.m00_+dy*this.m01_;this.m12_+=dx*this.m10_+dy*this.m11_;return this};AffineTransform.prototype.preTranslate=function(dx,dy){checkFiniteNumbers(arguments);this.m02_+=dx;this.m12_+=dy;return this};AffineTransform.prototype.rotate=function(theta,x,y){checkFiniteNumbers(arguments);return this.concatenate(AffineTransform.getRotateInstance(theta,x,y))};AffineTransform.prototype.preRotate=function(theta,x,y){checkFiniteNumbers(arguments);return this.preConcatenate(AffineTransform.getRotateInstance(theta,x,y))};AffineTransform.prototype.shear=function(shx,shy){checkFiniteNumbers(arguments);var m00=this.m00_;var m10=this.m10_;this.m00_+=shy*this.m01_;this.m10_+=shy*this.m11_;this.m01_+=shx*m00;this.m11_+=shx*m10;return this};AffineTransform.prototype.preShear=function(shx,shy){checkFiniteNumbers(arguments);var m00=this.m00_;var m01=this.m01_;var m02=this.m02_;this.m00_+=shx*this.m10_;this.m01_+=shx*this.m11_;this.m02_+=shx*this.m12_;this.m10_+=shy*m00;this.m11_+=shy*m01;this.m12_+=shy*m02;return this};AffineTransform.prototype.toString=function(){return"matrix("+[this.m00_,this.m10_,this.m01_,this.m11_,this.m02_,this.m12_].join(",")+")"};AffineTransform.prototype.getValue=function(i){var arr=[this.m00_,this.m10_,this.m01_,this.m11_,this.m02_,this.m12_];return arr[i]};AffineTransform.prototype.getValues=function(){return[this.m00_,this.m10_,this.m01_,this.m11_,this.m02_,this.m12_]};AffineTransform.prototype.getScaleX=function(){return this.m00_};AffineTransform.prototype.getScaleY=function(){return this.m11_};AffineTransform.prototype.getTranslateX=function(){return this.m02_};AffineTransform.prototype.getTranslateY=function(){return this.m12_};AffineTransform.prototype.getShearX=function(){return this.m01_};AffineTransform.prototype.getShearY=function(){return this.m10_};AffineTransform.prototype.concatenate=function(tx){checkFiniteNumbers([tx.m00_,tx.m01_,tx.m02_,tx.m10_,tx.m11_,tx.m12_]);var m0=this.m00_;var m1=this.m01_;this.m00_=tx.m00_*m0+tx.m10_*m1;this.m01_=tx.m01_*m0+tx.m11_*m1;this.m02_+=tx.m02_*m0+tx.m12_*m1;m0=this.m10_;m1=this.m11_;this.m10_=tx.m00_*m0+tx.m10_*m1;this.m11_=tx.m01_*m0+tx.m11_*m1;this.m12_+=tx.m02_*m0+tx.m12_*m1;return this};AffineTransform.prototype.preConcatenate=function(tx){checkFiniteNumbers([tx.m00_,tx.m01_,tx.m02_,tx.m10_,tx.m11_,tx.m12_]);var m0=this.m00_;var m1=this.m10_;this.m00_=tx.m00_*m0+tx.m01_*m1;this.m10_=tx.m10_*m0+tx.m11_*m1;m0=this.m01_;m1=this.m11_;this.m01_=tx.m00_*m0+tx.m01_*m1;this.m11_=tx.m10_*m0+tx.m11_*m1;m0=this.m02_;m1=this.m12_;this.m02_=tx.m00_*m0+tx.m01_*m1+tx.m02_;this.m12_=tx.m10_*m0+tx.m11_*m1+tx.m12_;return this};AffineTransform.prototype.transform=function(src,srcOff,dst,dstOff,numPts){var i=srcOff;var j=dstOff;var srcEnd=srcOff+2*numPts;while(i<srcEnd){var x=src[i++];var y=src[i++];dst[j++]=x*this.m00_+y*this.m01_+this.m02_;dst[j++]=x*this.m10_+y*this.m11_+this.m12_}};AffineTransform.prototype.transformPoint=function(x,y){checkFiniteNumbers(arguments);return{x:x*this.m00_+y*this.m01_+this.m02_,y:x*this.m10_+y*this.m11_+this.m12_}};AffineTransform.prototype.getDeterminant=function(){return this.m00_*this.m11_-this.m01_*this.m10_};AffineTransform.prototype.isInvertible=function(){var det=this.getDeterminant();return isFiniteNumber(det)&&isFiniteNumber(this.m02_)&&isFiniteNumber(this.m12_)&&det!=0};AffineTransform.prototype.createInverse=function(){var det=this.getDeterminant();return new AffineTransform(this.m11_/det,-this.m10_/det,-this.m01_/det,this.m00_/det,(this.m01_*this.m12_-this.m11_*this.m02_)/det,(this.m10_*this.m02_-this.m00_*this.m12_)/det)};AffineTransform.getScaleInstance=function(sx,sy){checkFiniteNumbers(arguments);return new AffineTransform().setToScale(sx,sy)};AffineTransform.getTranslateInstance=function(dx,dy){checkFiniteNumbers(arguments);return new AffineTransform().setToTranslation(dx,dy)};AffineTransform.getShearInstance=function(shx,shy){checkFiniteNumbers(arguments);return new AffineTransform().setToShear(shx,shy)};AffineTransform.getRotateInstance=function(theta,x,y){checkFiniteNumbers(arguments);return new AffineTransform().setToRotation(theta,x,y)};AffineTransform.prototype.setToScale=function(sx,sy){checkFiniteNumbers(arguments);return this.setTransform(sx,0,0,sy,0,0)};AffineTransform.prototype.setToTranslation=function(dx,dy){checkFiniteNumbers(arguments);return this.setTransform(1,0,0,1,dx,dy)};AffineTransform.prototype.setToShear=function(shx,shy){checkFiniteNumbers(arguments);return this.setTransform(1,shy,shx,1,0,0)};AffineTransform.prototype.setToRotation=function(theta,x,y){checkFiniteNumbers(arguments);var cos=Math.cos(theta);var sin=Math.sin(theta);return this.setTransform(cos,sin,-sin,cos,x-x*cos+y*sin,y-x*sin-y*cos)};AffineTransform.prototype.equals=function(tx){checkFiniteNumbers(arguments);if(this==tx){return true}if(!tx){return false}return this.m00_==tx.m00_&&this.m01_==tx.m01_&&this.m02_==tx.m02_&&this.m10_==tx.m10_&&this.m11_==tx.m11_&&this.m12_==tx.m12_};AffineTransform.prototype.toCssNoTranslate=function(o){var options=$.extend({isMoz:false,roundTranslate:false},o);if(options.isMoz){return"matrix("+this.m00_.toFixed(8)+","+this.m10_.toFixed(8)+","+this.m01_.toFixed(8)+","+this.m11_.toFixed(8)+",0,0)"}else{return"matrix("+this.m00_.toFixed(8)+","+this.m10_.toFixed(8)+","+this.m01_.toFixed(8)+","+this.m11_.toFixed(8)+",0,0)"}};AffineTransform.prototype.toCss=function(o){var options=$.extend({isMoz:false,roundTranslate:false},o);var translateX=options.roundTranslate?Math.round(this.m02_):this.m02_;var translateY=options.roundTranslate?Math.round(this.m12_):this.m12_;if(options.isMoz){return"matrix("+this.m00_.toFixed(8)+","+this.m10_.toFixed(8)+","+this.m01_.toFixed(8)+","+this.m11_.toFixed(8)+","+translateX+"px,"+translateY+"px)"}else{return"matrix("+this.m00_.toFixed(8)+","+this.m10_.toFixed(8)+","+this.m01_.toFixed(8)+","+this.m11_.toFixed(8)+","+translateX+","+translateY+")"}};_gliffy.AffineTransform=AffineTransform})();(function(){var candash=function(){var MAX_POINTS=24;var __abscissa=[[],[],[-0.5773502691896257,0.5773502691896257],[0,-0.7745966692414834,0.7745966692414834],[-0.33998104358485626,0.33998104358485626,-0.8611363115940526,0.8611363115940526],[0,-0.5384693101056831,0.5384693101056831,-0.906179845938664,0.906179845938664],[0.6612093864662645,-0.6612093864662645,-0.2386191860831969,0.2386191860831969,-0.932469514203152,0.932469514203152],[0,0.4058451513773972,-0.4058451513773972,-0.7415311855993945,0.7415311855993945,-0.9491079123427585,0.9491079123427585],[-0.1834346424956498,0.1834346424956498,-0.525532409916329,0.525532409916329,-0.7966664774136267,0.7966664774136267,-0.9602898564975363,0.9602898564975363],[0,-0.8360311073266358,0.8360311073266358,-0.9681602395076261,0.9681602395076261,-0.3242534234038089,0.3242534234038089,-0.6133714327005904,0.6133714327005904],[-0.14887433898163122,0.14887433898163122,-0.4333953941292472,0.4333953941292472,-0.6794095682990244,0.6794095682990244,-0.8650633666889845,0.8650633666889845,-0.9739065285171717,0.9739065285171717],[0,-0.26954315595234496,0.26954315595234496,-0.5190961292068118,0.5190961292068118,-0.7301520055740494,0.7301520055740494,-0.8870625997680953,0.8870625997680953,-0.978228658146057,0.978228658146057],[-0.1252334085114689,0.1252334085114689,-0.3678314989981802,0.3678314989981802,-0.5873179542866175,0.5873179542866175,-0.7699026741943047,0.7699026741943047,-0.9041172563704749,0.9041172563704749,-0.9815606342467192,0.9815606342467192],[0,-0.2304583159551348,0.2304583159551348,-0.44849275103644687,0.44849275103644687,-0.6423493394403402,0.6423493394403402,-0.8015780907333099,0.8015780907333099,-0.9175983992229779,0.9175983992229779,-0.9841830547185881,0.9841830547185881],[-0.10805494870734367,0.10805494870734367,-0.31911236892788974,0.31911236892788974,-0.5152486363581541,0.5152486363581541,-0.6872929048116855,0.6872929048116855,-0.827201315069765,0.827201315069765,-0.9284348836635735,0.9284348836635735,-0.9862838086968123,0.9862838086968123],[0,-0.20119409399743451,0.20119409399743451,-0.3941513470775634,0.3941513470775634,-0.5709721726085388,0.5709721726085388,-0.7244177313601701,0.7244177313601701,-0.8482065834104272,0.8482065834104272,-0.937273392400706,0.937273392400706,-0.9879925180204854,0.9879925180204854],[-0.09501250983763744,0.09501250983763744,-0.2816035507792589,0.2816035507792589,-0.45801677765722737,0.45801677765722737,-0.6178762444026438,0.6178762444026438,-0.755404408355003,0.755404408355003,-0.8656312023878318,0.8656312023878318,-0.9445750230732326,0.9445750230732326,-0.9894009349916499,0.9894009349916499],[0,-0.17848418149584785,0.17848418149584785,-0.3512317634538763,0.3512317634538763,-0.5126905370864769,0.5126905370864769,-0.6576711592166907,0.6576711592166907,-0.7815140038968014,0.7815140038968014,-0.8802391537269859,0.8802391537269859,-0.9506755217687678,0.9506755217687678,-0.9905754753144174,0.9905754753144174],[-0.0847750130417353,0.0847750130417353,-0.2518862256915055,0.2518862256915055,-0.41175116146284263,0.41175116146284263,-0.5597708310739475,0.5597708310739475,-0.6916870430603532,0.6916870430603532,-0.8037049589725231,0.8037049589725231,-0.8926024664975557,0.8926024664975557,-0.9558239495713977,0.9558239495713977,-0.9915651684209309,0.9915651684209309],[0,-0.16035864564022537,0.16035864564022537,-0.31656409996362983,0.31656409996362983,-0.46457074137596094,0.46457074137596094,-0.600545304661681,0.600545304661681,-0.7209661773352294,0.7209661773352294,-0.8227146565371428,0.8227146565371428,-0.9031559036148179,0.9031559036148179,-0.96020815213483,0.96020815213483,-0.9924068438435844,0.9924068438435844],[-0.07652652113349734,0.07652652113349734,-0.22778585114164507,0.22778585114164507,-0.37370608871541955,0.37370608871541955,-0.5108670019508271,0.5108670019508271,-0.636053680726515,0.636053680726515,-0.7463319064601508,0.7463319064601508,-0.8391169718222188,0.8391169718222188,-0.912234428251326,0.912234428251326,-0.9639719272779138,0.9639719272779138,-0.9931285991850949,0.9931285991850949],[0,-0.1455618541608951,0.1455618541608951,-0.2880213168024011,0.2880213168024011,-0.4243421202074388,0.4243421202074388,-0.5516188358872198,0.5516188358872198,-0.6671388041974123,0.6671388041974123,-0.7684399634756779,0.7684399634756779,-0.8533633645833173,0.8533633645833173,-0.9200993341504008,0.9200993341504008,-0.9672268385663063,0.9672268385663063,-0.9937521706203895,0.9937521706203895],[-0.06973927331972223,0.06973927331972223,-0.20786042668822127,0.20786042668822127,-0.34193582089208424,0.34193582089208424,-0.469355837986757,0.469355837986757,-0.5876404035069116,0.5876404035069116,-0.6944872631866827,0.6944872631866827,-0.7878168059792081,0.7878168059792081,-0.8658125777203002,0.8658125777203002,-0.926956772187174,0.926956772187174,-0.9700604978354287,0.9700604978354287,-0.9942945854823992,0.9942945854823992],[0,-0.1332568242984661,0.1332568242984661,-0.26413568097034495,0.26413568097034495,-0.3903010380302908,0.3903010380302908,-0.5095014778460075,0.5095014778460075,-0.6196098757636461,0.6196098757636461,-0.7186613631319502,0.7186613631319502,-0.8048884016188399,0.8048884016188399,-0.8767523582704416,0.8767523582704416,-0.9329710868260161,0.9329710868260161,-0.9725424712181152,0.9725424712181152,-0.9947693349975522,0.9947693349975522],[-0.06405689286260563,0.06405689286260563,-0.1911188674736163,0.1911188674736163,-0.3150426796961634,0.3150426796961634,-0.4337935076260451,0.4337935076260451,-0.5454214713888396,0.5454214713888396,-0.6480936519369755,0.6480936519369755,-0.7401241915785544,0.7401241915785544,-0.820001985973903,0.820001985973903,-0.8864155270044011,0.8864155270044011,-0.9382745520027328,0.9382745520027328,-0.9747285559713095,0.9747285559713095,-0.9951872199970213,0.9951872199970213]];var __weight=[[],[],[1,1],[0.8888888888888888,0.5555555555555556,0.5555555555555556],[0.6521451548625461,0.6521451548625461,0.34785484513745385,0.34785484513745385],[0.5688888888888889,0.47862867049936647,0.47862867049936647,0.23692688505618908,0.23692688505618908],[0.3607615730481386,0.3607615730481386,0.46791393457269104,0.46791393457269104,0.17132449237917036,0.17132449237917036],[0.4179591836734694,0.3818300505051189,0.3818300505051189,0.27970539148927664,0.27970539148927664,0.1294849661688697,0.1294849661688697],[0.362683783378362,0.362683783378362,0.31370664587788727,0.31370664587788727,0.22238103445337448,0.22238103445337448,0.10122853629037626,0.10122853629037626],[0.3302393550012598,0.1806481606948574,0.1806481606948574,0.08127438836157441,0.08127438836157441,0.31234707704000286,0.31234707704000286,0.26061069640293544,0.26061069640293544],[0.29552422471475287,0.29552422471475287,0.26926671930999635,0.26926671930999635,0.21908636251598204,0.21908636251598204,0.1494513491505806,0.1494513491505806,0.06667134430868814,0.06667134430868814],[0.2729250867779006,0.26280454451024665,0.26280454451024665,0.23319376459199048,0.23319376459199048,0.18629021092773426,0.18629021092773426,0.1255803694649046,0.1255803694649046,0.05566856711617366,0.05566856711617366],[0.24914704581340277,0.24914704581340277,0.2334925365383548,0.2334925365383548,0.20316742672306592,0.20316742672306592,0.16007832854334622,0.16007832854334622,0.10693932599531843,0.10693932599531843,0.04717533638651183,0.04717533638651183],[0.2325515532308739,0.22628318026289723,0.22628318026289723,0.2078160475368885,0.2078160475368885,0.17814598076194574,0.17814598076194574,0.13887351021978725,0.13887351021978725,0.09212149983772845,0.09212149983772845,0.04048400476531588,0.04048400476531588],[0.2152638534631578,0.2152638534631578,0.2051984637212956,0.2051984637212956,0.18553839747793782,0.18553839747793782,0.15720316715819355,0.15720316715819355,0.12151857068790319,0.12151857068790319,0.08015808715976021,0.08015808715976021,0.03511946033175186,0.03511946033175186],[0.2025782419255613,0.19843148532711158,0.19843148532711158,0.1861610000155622,0.1861610000155622,0.16626920581699392,0.16626920581699392,0.13957067792615432,0.13957067792615432,0.10715922046717194,0.10715922046717194,0.07036604748810812,0.07036604748810812,0.03075324199611727,0.03075324199611727],[0.1894506104550685,0.1894506104550685,0.18260341504492358,0.18260341504492358,0.16915651939500254,0.16915651939500254,0.14959598881657674,0.14959598881657674,0.12462897125553388,0.12462897125553388,0.09515851168249279,0.09515851168249279,0.062253523938647894,0.062253523938647894,0.027152459411754096,0.027152459411754096],[0.17944647035620653,0.17656270536699264,0.17656270536699264,0.16800410215645004,0.16800410215645004,0.15404576107681028,0.15404576107681028,0.13513636846852548,0.13513636846852548,0.11188384719340397,0.11188384719340397,0.08503614831717918,0.08503614831717918,0.0554595293739872,0.0554595293739872,0.02414830286854793,0.02414830286854793],[0.1691423829631436,0.1691423829631436,0.16427648374583273,0.16427648374583273,0.15468467512626524,0.15468467512626524,0.14064291467065065,0.14064291467065065,0.12255520671147846,0.12255520671147846,0.10094204410628717,0.10094204410628717,0.07642573025488905,0.07642573025488905,0.0497145488949698,0.0497145488949698,0.02161601352648331,0.02161601352648331],[0.1610544498487837,0.15896884339395434,0.15896884339395434,0.15276604206585967,0.15276604206585967,0.1426067021736066,0.1426067021736066,0.12875396253933621,0.12875396253933621,0.11156664554733399,0.11156664554733399,0.09149002162245,0.09149002162245,0.06904454273764123,0.06904454273764123,0.0448142267656996,0.0448142267656996,0.019461788229726478,0.019461788229726478],[0.15275338713072584,0.15275338713072584,0.14917298647260374,0.14917298647260374,0.14209610931838204,0.14209610931838204,0.13168863844917664,0.13168863844917664,0.11819453196151841,0.11819453196151841,0.10193011981724044,0.10193011981724044,0.08327674157670475,0.08327674157670475,0.06267204833410907,0.06267204833410907,0.04060142980038694,0.04060142980038694,0.017614007139152118,0.017614007139152118],[0.14608113364969041,0.14452440398997005,0.14452440398997005,0.13988739479107315,0.13988739479107315,0.13226893863333747,0.13226893863333747,0.12183141605372853,0.12183141605372853,0.10879729916714838,0.10879729916714838,0.09344442345603386,0.09344442345603386,0.0761001136283793,0.0761001136283793,0.057134425426857205,0.057134425426857205,0.036953789770852494,0.036953789770852494,0.016017228257774335,0.016017228257774335],[0.13925187285563198,0.13925187285563198,0.13654149834601517,0.13654149834601517,0.13117350478706238,0.13117350478706238,0.12325237681051242,0.12325237681051242,0.11293229608053922,0.11293229608053922,0.10041414444288096,0.10041414444288096,0.08594160621706773,0.08594160621706773,0.06979646842452049,0.06979646842452049,0.052293335152683286,0.052293335152683286,0.03377490158481415,0.03377490158481415,0.0146279952982722,0.0146279952982722],[0.13365457218610619,0.1324620394046966,0.1324620394046966,0.12890572218808216,0.12890572218808216,0.12304908430672953,0.12304908430672953,0.11499664022241136,0.11499664022241136,0.10489209146454141,0.10489209146454141,0.09291576606003515,0.09291576606003515,0.07928141177671895,0.07928141177671895,0.06423242140852585,0.06423242140852585,0.04803767173108467,0.04803767173108467,0.030988005856979445,0.030988005856979445,0.013411859487141771,0.013411859487141771],[0.12793819534675216,0.12793819534675216,0.1258374563468283,0.1258374563468283,0.12167047292780339,0.12167047292780339,0.1155056680537256,0.1155056680537256,0.10744427011596563,0.10744427011596563,0.09761865210411388,0.09761865210411388,0.08619016153195327,0.08619016153195327,0.0733464814110803,0.0733464814110803,0.05929858491543678,0.05929858491543678,0.04427743881741981,0.04427743881741981,0.028531388628933663,0.028531388628933663,0.0123412297999872,0.0123412297999872]];var __approximateIntegralValue=function(_f,_a,_b,_n){if(!_n){_n=5}if(isNaN(_a)||isNaN(_b)){throw"invalid parameters: _a or _b is not a number"}if(_a>=_b){throw"invalid parameters: _a is greater or equal to _b"}if(!(typeof _f==="function")){throw"invalid parameters: _f is not a function"}if(isNaN(_n)||_n<2){throw"invalid parameters: _n is not a number or _n is less than 2"}var n=Math.max(_n,2);n=Math.min(n,MAX_POINTS);var sum=0;if(_a==-1&&_b==1){for(var i=0;i<n;++i){sum+=_f(__abscissa[n][i]*__weight[n][i])}return sum}else{var mult=0.5*(_b-_a);var ab2=0.5*(_a+_b);for(i=0;i<n;++i){sum+=_f(ab2+mult*__abscissa[n][i])*__weight[n][i]}return mult*sum}};var __quadraticCurve=function(t,p1,p2,p3){var mt=1-t;return mt*mt*p1+2*mt*t*p2+t*t*p3};var __cubicCurve=function(t,p1,p2,p3,p4){var mt=1-t;return mt*mt*mt*p1+3*mt*mt*t*p2+3*mt*t*t*p3+t*t*t*p4};var __base2=function(t,p1,p2,p3){return t*(2*p1-4*p2+2*p3)-2*p1+2*p2};var __base2Root=function(s,c,e){var numerator=s-c;var denominator=s-2*c+e;if(denominator===0){return -1}return numerator/denominator};var __base3=function(t,p1,p2,p3,p4){var t1=-3*p1+9*p2-9*p3+3*p4;var t2=t*t1+6*p1-12*p2+6*p3;return t*t2-3*p1+3*p2};var __base3Roots=function(s,c1,c2,e){var tl=-s+2*c1-c2;var tr=Math.sqrt(-s*(c2-e)+c1*c1-c1*(c2+e)+c2*c2);var denominator=-s+3*c1-3*c2+e;if(denominator===0){return[-1,-1]}return[(tl-tr)/denominator,(tl+tr)/denominator]};var __lineDistance=function(start,end){return Math.sqrt(Math.pow(end.x-start.x,2)+Math.pow(end.y-start.y,2))};var __quadraticBezierDistance=function(start,control,end,start_t,end_t,steps){if(start_t<0||start_t>1||start_t>end_t||end_t<0||end_t>1){throw new Error("values of t must be between 0 and 1.0")}return __approximateIntegralValue(function(_t){var xPrime=__base2(_t,start.x,control.x,end.x);var yPrime=__base2(_t,start.y,control.y,end.y);return Math.sqrt(xPrime*xPrime+yPrime*yPrime)},start_t,end_t,steps)};var __cubicBezierDistance=function(start,control1,control2,end,start_t,end_t,steps){if(start_t<0||start_t>1||start_t>end_t||end_t<0||end_t>1){throw new Error("values of t must be between 0 and 1.0")}return __approximateIntegralValue(function(_t){var xPrime=__base3(_t,start.x,control1.x,control2.x,end.x);var yPrime=__base3(_t,start.y,control1.y,control2.y,end.y);return Math.sqrt(xPrime*xPrime+yPrime*yPrime)},start_t,end_t,steps)};var __linearBoundingBox=function(start,end){return[{x:Math.min(start.x,end.x),y:Math.min(start.y,end.y)},{x:Math.max(start.x,end.x),y:Math.max(start.y,end.y)}]};var __quadraticBoundingBox=function(start,control1,end){var linearBounds=__linearBoundingBox(start,end);if(control1.x<linearBounds[0].x||control1.y<linearBounds[0].y||control1.x>linearBounds[1].x||control1.y>linearBounds[1].y){var tx=__base2Root(start.x,control1.x,end.x);if(tx>=0&&tx<=1){var x=__quadraticCurve(tx,start.x,control1.x,end.x);linearBounds[0].x=Math.min(linearBounds[0].x,x);linearBounds[1].x=Math.max(linearBounds[1].x,x)}var ty=__base2Root(start.y,control1.y,end.y);if(ty>=0&&ty<=1){var y=__quadraticCurve(ty,start.y,control1.y,end.y);linearBounds[0].y=Math.min(linearBounds[0].y,y);linearBounds[1].y=Math.max(linearBounds[1].y,y)}}return linearBounds};var __cubicBoundingBox=function(start,control1,control2,end){var linearBounds=__linearBoundingBox(start,end);if(control1.x<linearBounds[0].x||control1.y<linearBounds[0].y||control1.x>linearBounds[1].x||control1.y>linearBounds[1].y||control2.x<linearBounds[0].x||control2.y<linearBounds[0].y||control2.x>linearBounds[1].x||control2.y>linearBounds[1].y){var i;var tx=__base3Roots(start.x,control1.x,control2.x,end.x);for(i=0;i<tx.length;i++){var t=tx[i];if(t>=0&&t<=1){var x=__cubicCurve(t,start.x,control1.x,control2.x,end.x);linearBounds[0].x=Math.min(linearBounds[0].x,x);linearBounds[1].x=Math.max(linearBounds[1].x,x)}}var ty=__base3Roots(start.y,control1.y,control2.y,end.y);for(i=0;i<ty.length;i++){var t=ty[i];if(t>=0&&t<=1){var y=__cubicCurve(t,start.y,control1.y,control2.y,end.y);linearBounds[0].y=Math.min(linearBounds[0].y,y);linearBounds[1].y=Math.max(linearBounds[1].y,y)}}}return linearBounds};var __newtonsMethodQuadratic=function(start,control,end,distance,n,iterations){var xPrime=__base2(n,start.x,control.x,end.x);var yPrime=__base2(n,start.y,control.y,end.y);var nPlusOne=n-(__quadraticBezierDistance(start,control,end,0,n,12)-distance)/Math.sqrt(xPrime*xPrime+yPrime*yPrime);if(nPlusOne<=0){nPlusOne=0.00001}if(nPlusOne>=1){nPlusOne=0.99999}if(iterations===0){return nPlusOne}else{return __newtonsMethodQuadratic(start,control,end,distance,nPlusOne,--iterations)}};var __newtonsMethodCubic=function(start,control1,control2,end,distance,n,iterations){var xPrime=__base3(n,start.x,control1.x,control2.x,end.x);var yPrime=__base3(n,start.y,control1.y,control2.y,end.y);var nPlusOne=n-(__cubicBezierDistance(start,control1,control2,end,0,n,12)-distance)/Math.sqrt(xPrime*xPrime+yPrime*yPrime);if(nPlusOne<=0){nPlusOne=0.00001}if(nPlusOne>=1){nPlusOne=0.99999}if(iterations===0){return nPlusOne}else{return __newtonsMethodCubic(start,control1,control2,end,distance,nPlusOne,--iterations)}};var __splitQuadraticCurve=function(start,control,end,t){var a={x:(1-t)*start.x+t*control.x,y:(1-t)*start.y+t*control.y};var b={x:(1-t)*control.x+t*end.x,y:(1-t)*control.y+t*end.y};var c={x:(1-t)*a.x+t*b.x,y:(1-t)*a.y+t*b.y};return[[start,a,c],[c,b,end]]};var __splitCubicCurve=function(start,control1,control2,end,t){var a={x:(1-t)*start.x+t*control1.x,y:(1-t)*start.y+t*control1.y};var b={x:(1-t)*control1.x+t*control2.x,y:(1-t)*control1.y+t*control2.y};var c={x:(1-t)*control2.x+t*end.x,y:(1-t)*control2.y+t*end.y};var m={x:(1-t)*a.x+t*b.x,y:(1-t)*a.y+t*b.y};var n={x:(1-t)*b.x+t*c.x,y:(1-t)*b.y+t*c.y};var p={x:(1-t)*m.x+t*n.x,y:(1-t)*m.y+t*n.y};return[[start,a,m,p],[p,n,c,end]]};var __splitLine=function(start,end,distance){var N=[0,0];if(start.x===end.x){N=[0,1]}else{var slope=(end.y-start.y)/(end.x-start.x);var magnitude=Math.sqrt(1+slope*slope);N=[1/magnitude,slope/magnitude]}var dashPoint={x:start.x+distance*N[0],y:start.y+distance*N[1]};if(__lineDistance(dashPoint,end)>__lineDistance(start,end)){dashPoint={x:start.x-distance*N[0],y:start.y-distance*N[1]}}return[[start,dashPoint],[dashPoint,end]]};return{lineTo:function(start,end,ctx){if(!ctx.dasharray){throw new Error("No dasharray property set on canvas context. Ex: ctx.dasharray = [10,5]")}if(!ctx.dashinfo){ctx.dashinfo={index:0,remainder:0}}var index=ctx.dashinfo.index%ctx.dasharray.length;var dash=ctx.dasharray[index];if(ctx.dashinfo.remainder&&ctx.dashinfo.remainder>0){dash=ctx.dashinfo.remainder}else{ctx.moveTo(start.x,start.y)}var distance=__lineDistance(start,end);if(distance<dash){if(index%2===0){ctx.lineTo(end.x,end.y)}ctx.dashinfo={remainder:(dash-distance),index:index}}else{var lines=__splitLine(start,end,dash);if(index%2===0){ctx.lineTo(lines[0][1].x,lines[0][1].y)}ctx.dashinfo={remainder:0,index:++index};this.lineTo(lines[1][0],lines[1][1],ctx)}},quadraticCurveTo:function(start,control,end,ctx){if(!ctx.dasharray){throw new Error("No dasharray property set on canvas context. Ex: ctx.dasharray = [10,5]")}if(!ctx.dashinfo){ctx.dashinfo={index:0,remainder:0}}var index=ctx.dashinfo.index%ctx.dasharray.length;var dash=ctx.dasharray[index];if(ctx.dashinfo.remainder&&ctx.dashinfo.remainder>0){dash=ctx.dashinfo.remainder}else{ctx.moveTo(start.x,start.y)}var distance=__quadraticBezierDistance(start,control,end,0,1,12);if(distance<dash){if(index%2===0){ctx.quadraticCurveTo(control.x,control.y,end.x,end.y)}ctx.dashinfo={remainder:dash-distance,index:index}}else{var t=__newtonsMethodQuadratic(start,control,end,dash,0.5,3);var curves=__splitQuadraticCurve(start,control,end,t);if(index%2===0){ctx.quadraticCurveTo(curves[0][1].x,curves[0][1].y,curves[0][2].x,curves[0][2].y)}ctx.dashinfo={remainder:0,index:++index};this.quadraticCurveTo(curves[1][0],curves[1][1],curves[1][2],ctx)}},bezierCurveTo:function(start,control1,control2,end,ctx){if(!ctx.dasharray){throw new Error("No dasharray property set on canvas context. Ex: ctx.dasharray = [10,5]")}if(!ctx.dashinfo){ctx.dashinfo={index:0,remainder:0}}var index=ctx.dashinfo.index%ctx.dasharray.length;var dash=ctx.dasharray[index];if(ctx.dashinfo.remainder&&ctx.dashinfo.remainder>0){dash=ctx.dashinfo.remainder}else{ctx.moveTo(start.x,start.y)}var distance=__cubicBezierDistance(start,control1,control2,end,0,1,12);if(distance<dash){if(index%2===0){ctx.bezierCurveTo(control1.x,control1.y,control2.x,control2.y,end.x,end.y)}ctx.dashinfo={remainder:dash-distance,index:index}}else{var t=__newtonsMethodCubic(start,control1,control2,end,dash,0.5,3);var curves=__splitCubicCurve(start,control1,control2,end,t);if(index%2===0){ctx.bezierCurveTo(curves[0][1].x,curves[0][1].y,curves[0][2].x,curves[0][2].y,curves[0][3].x,curves[0][3].y)}ctx.dashinfo={remainder:0,index:++index};this.bezierCurveTo(curves[1][0],curves[1][1],curves[1][2],curves[1][3],ctx)}},cleanCtx:function(ctx){delete ctx.dashinfo;delete ctx.dasharray},getPathDistance:function(path){var totalDistance=0;var distanceArray=[];for(var i=0;i<path.length;i++){var line=path[i];switch(line.length){case 2:var d=__lineDistance(line[0],line[1]);distanceArray.push(d);totalDistance+=d;break;case 3:var d=__quadraticBezierDistance(line[0],line[1],line[2],0,1,12);distanceArray.push(d);totalDistance+=d;break;case 4:var d=__cubicBezierDistance(line[0],line[1],line[2],line[3],0,1,12);distanceArray.push(d);totalDistance+=d;break;default:throw new Error("a line with "+line.length+" points is unsupported")}}return{totalDistance:totalDistance,distanceArray:distanceArray}},getPointInPathAtT:function(path,t){if(t===0){return path[0][0]}else{if(t===1){var last=path[path.length-1];return last[last.length-1]}else{var d=this.getPathDistance(path);return this.getPointInPathAtDistance(path,d.totalDistance*t,d)}}},getBoundingBox:function(path){var bounds;for(var i=0;i<path.length;i++){var line=path[i];switch(line.length){case 2:var b=__linearBoundingBox(line[0],line[1]);if(!bounds){bounds=b}else{bounds[0].x=Math.min(bounds[0].x,b[0].x);bounds[0].y=Math.min(bounds[0].y,b[0].y);bounds[1].x=Math.max(bounds[1].x,b[1].x);bounds[1].y=Math.max(bounds[1].y,b[1].y)}break;case 3:var b=__quadraticBoundingBox(line[0],line[1],line[2]);if(!bounds){bounds=b}else{bounds[0].x=Math.min(bounds[0].x,b[0].x);bounds[0].y=Math.min(bounds[0].y,b[0].y);bounds[1].x=Math.max(bounds[1].x,b[1].x);bounds[1].y=Math.max(bounds[1].y,b[1].y)}break;case 4:var b=__cubicBoundingBox(line[0],line[1],line[2],line[3]);if(!bounds){bounds=b}else{bounds[0].x=Math.min(bounds[0].x,b[0].x);bounds[0].y=Math.min(bounds[0].y,b[0].y);bounds[1].x=Math.max(bounds[1].x,b[1].x);bounds[1].y=Math.max(bounds[1].y,b[1].y)}break;default:throw new Error("a line with "+line.length+" points is unsupported")}}return bounds},getPointInPathAtDistance:function(path,distance,distanceInfo){if(distance===0){return path[0][0]}else{var d=(distanceInfo)?distanceInfo:this.getPathDistance(path);var i=0,distanceLeft=distance;while(distanceLeft>d.distanceArray[i]){distanceLeft-=d.distanceArray[i];i++}if(i>=path.length){var points=path[i-1];return points[points.length-1]}switch(path[i].length){case 2:return __splitLine(path[i][0],path[i][1],distanceLeft)[0][1];case 3:var t=__newtonsMethodQuadratic(path[i][0],path[i][1],path[i][2],distanceLeft,0.5,3);return __splitQuadraticCurve(path[i][0],path[i][1],path[i][2],t)[0][2];case 4:var t=__newtonsMethodCubic(path[i][0],path[i][1],path[i][2],path[i][3],distanceLeft,0.5,3);return __splitCubicCurve(path[i][0],path[i][1],path[i][2],path[i][3],t)[0][3];default:throw new Error("a line with "+path[i].length+" points is unsupported")}}}}};_gliffy.candash=candash()})();(function(){var Point,PathParser,Linevg,compressSpaces,trim,drawPath;compressSpaces=function(s){return s.replace(/[\s\r\t\n]+/gm," ")};trim=function(s){return s.replace(/^\s+|\s+$/g,"")};Point=function(x,y){this.x=x;this.y=y};Point.prototype.angleTo=function(p){return Math.atan2(p.y-this.y,p.x-this.x)};Point.prototype.applyTransform=function(v){var xp=this.x*v[0]+this.y*v[2]+v[4];var yp=this.x*v[1]+this.y*v[3]+v[5];this.x=xp;this.y=yp};PathParser=function(d){var i,tokens=[];for(i=0;i<d.length;i++){tokens.push(d[i].name);tokens=tokens.concat(d[i].args.split(/[,\s+)]/))}this.tokens=tokens};PathParser.prototype.reset=function(){this.i=-1;this.command="";this.previousCommand="";this.start=new Point(0,0);this.control=new Point(0,0);this.current=new Point(0,0);this.points=[];this.angles=[]};PathParser.prototype.isEnd=function(){return this.i>=this.tokens.length-1};PathParser.prototype.isCommandOrEnd=function(){if(this.isEnd()){return true}return this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null};PathParser.prototype.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return true;break}return false};PathParser.prototype.getToken=function(){this.i++;return this.tokens[this.i]};PathParser.prototype.getScalar=function(){return parseFloat(this.getToken())};PathParser.prototype.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};PathParser.prototype.getPoint=function(){var p=new Point(this.getScalar(),this.getScalar());return this.makeAbsolute(p)};PathParser.prototype.getAsControlPoint=function(){var p=this.getPoint();this.control=p;return p};PathParser.prototype.getAsCurrentPoint=function(){var p=this.getPoint();this.current=p;return p};PathParser.prototype.getReflectedControlPoint=function(){if(this.previousCommand.toLowerCase()!="c"&&this.previousCommand.toLowerCase()!="s"){return this.current}return new Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)};PathParser.prototype.makeAbsolute=function(p){if(this.isRelativeCommand()){p.x+=this.current.x;p.y+=this.current.y}return p};PathParser.prototype.addMarker=function(p,from,priorTo){if(priorTo!=null&&this.angles.length>0&&this.angles[this.angles.length-1]==null){this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(priorTo)}this.addMarkerAngle(p,from==null?null:from.angleTo(p))};PathParser.prototype.addMarkerAngle=function(p,a){this.points.push(p);this.angles.push(a)};PathParser.prototype.getMarkerPoints=function(){return this.points};PathParser.prototype.getMarkerAngles=function(){for(var i=0;i<this.angles.length;i++){if(this.angles[i]==null){for(var j=i+1;j<this.angles.length;j++){if(this.angles[j]!=null){this.angles[i]=this.angles[j];break}}}}return this.angles};drawPath=function(ctx,pp){var p,c,curr,p1,cntrl,cp,currp,cpp,centp,newP,r,rx,ry,sx,sy,u,v,ad,a,m,l,a1,xAxisRotation,largeArcFlag,sweepFlag,halfWay;pp.reset();if(ctx!=null){ctx.beginPath()}while(!pp.isEnd()){pp.nextCommand();switch(pp.command){case"M":case"m":p=pp.getAsCurrentPoint();pp.addMarker(p);if(ctx!=null){ctx.moveTo(p.x,p.y)}pp.start=pp.current;while(!pp.isCommandOrEnd()){p=pp.getAsCurrentPoint();pp.addMarker(p,pp.start);if(ctx!=null){ctx.lineTo(p.x,p.y)}}break;case"L":case"l":while(!pp.isCommandOrEnd()){c=pp.current;p=pp.getAsCurrentPoint();pp.addMarker(p,c);if(ctx!=null){if(ctx.dasharray&&ctx.dasharray.length>0){_gliffy.candash.lineTo({x:c.x,y:c.y},{x:p.x,y:p.y},ctx)}else{ctx.lineTo(p.x,p.y)}}}break;case"H":case"h":while(!pp.isCommandOrEnd()){newP=new Point((pp.isRelativeCommand()?pp.current.x:0)+pp.getScalar(),pp.current.y);pp.addMarker(newP,pp.current);pp.current=newP;if(ctx!=null){ctx.lineTo(pp.current.x,pp.current.y)}}break;case"V":case"v":while(!pp.isCommandOrEnd()){newP=new Point(pp.current.x,(pp.isRelativeCommand()?pp.current.y:0)+pp.getScalar());pp.addMarker(newP,pp.current);pp.current=newP;if(ctx!=null){ctx.lineTo(pp.current.x,pp.current.y)}}break;case"C":case"c":while(!pp.isCommandOrEnd()){curr=pp.current;p1=pp.getPoint();cntrl=pp.getAsControlPoint();cp=pp.getAsCurrentPoint();pp.addMarker(cp,cntrl,p1);if(ctx!=null){if(ctx.dasharray&&ctx.dasharray.length>0){_gliffy.candash.bezierCurveTo({x:curr.x,y:curr.y},{x:p1.x,y:p1.y},{x:cntrl.x,y:cntrl.y},{x:cp.x,y:cp.y},ctx)}else{ctx.bezierCurveTo(p1.x,p1.y,cntrl.x,cntrl.y,cp.x,cp.y)}}}break;case"S":case"s":while(!pp.isCommandOrEnd()){curr=pp.current;p1=pp.getReflectedControlPoint();cntrl=pp.getAsControlPoint();cp=pp.getAsCurrentPoint();pp.addMarker(cp,cntrl,p1);if(ctx!=null){ctx.bezierCurveTo(p1.x,p1.y,cntrl.x,cntrl.y,cp.x,cp.y)}}break;case"Q":case"q":while(!pp.isCommandOrEnd()){curr=pp.current;cntrl=pp.getAsControlPoint();cp=pp.getAsCurrentPoint();pp.addMarker(cp,cntrl,cntrl);if(ctx!=null){if(ctx.dasharray&&ctx.dasharray.length>0){_gliffy.candash.quadraticCurveTo({x:curr.x,y:curr.y},{x:cntrl.x,y:cntrl.y},{x:cp.x,y:cp.y},ctx)}else{ctx.quadraticCurveTo(cntrl.x,cntrl.y,cp.x,cp.y)}}}break;case"T":case"t":while(!pp.isCommandOrEnd()){curr=pp.current;cntrl=pp.getReflectedControlPoint();pp.control=cntrl;cp=pp.getAsCurrentPoint();pp.addMarker(cp,cntrl,cntrl);if(ctx!=null){ctx.quadraticCurveTo(cntrl.x,cntrl.y,cp.x,cp.y)}}break;case"A":case"a":while(!pp.isCommandOrEnd()){curr=pp.current;rx=pp.getScalar();ry=pp.getScalar();xAxisRotation=pp.getScalar()*(Math.PI/180);largeArcFlag=pp.getScalar();sweepFlag=pp.getScalar();cp=pp.getAsCurrentPoint();currp=new Point(Math.cos(xAxisRotation)*(curr.x-cp.x)/2+Math.sin(xAxisRotation)*(curr.y-cp.y)/2,-Math.sin(xAxisRotation)*(curr.x-cp.x)/2+Math.cos(xAxisRotation)*(curr.y-cp.y)/2);l=Math.pow(currp.x,2)/Math.pow(rx,2)+Math.pow(currp.y,2)/Math.pow(ry,2);if(l>1){rx*=Math.sqrt(l);ry*=Math.sqrt(l)}var s=(largeArcFlag==sweepFlag?-1:1)*Math.sqrt(((Math.pow(rx,2)*Math.pow(ry,2))-(Math.pow(rx,2)*Math.pow(currp.y,2))-(Math.pow(ry,2)*Math.pow(currp.x,2)))/(Math.pow(rx,2)*Math.pow(currp.y,2)+Math.pow(ry,2)*Math.pow(currp.x,2)));if(isNaN(s)){s=0}cpp=new Point(s*rx*currp.y/ry,s*-ry*currp.x/rx);centp=new Point((curr.x+cp.x)/2+Math.cos(xAxisRotation)*cpp.x-Math.sin(xAxisRotation)*cpp.y,(curr.y+cp.y)/2+Math.sin(xAxisRotation)*cpp.x+Math.cos(xAxisRotation)*cpp.y);m=function(v){return Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2))};r=function(u,v){return(u[0]*v[0]+u[1]*v[1])/(m(u)*m(v))};a=function(u,v){return(u[0]*v[1]<u[1]*v[0]?-1:1)*Math.acos(r(u,v))};a1=a([1,0],[(currp.x-cpp.x)/rx,(currp.y-cpp.y)/ry]);u=[(currp.x-cpp.x)/rx,(currp.y-cpp.y)/ry];v=[(-currp.x-cpp.x)/rx,(-currp.y-cpp.y)/ry];ad=a(u,v);if(r(u,v)<=-1){ad=Math.PI}if(r(u,v)>=1){ad=0}if(sweepFlag==0&&ad>0){ad=ad-2*Math.PI}if(sweepFlag==1&&ad<0){ad=ad+2*Math.PI}halfWay=new Point(centp.x-rx*Math.cos((a1+ad)/2),centp.y-ry*Math.sin((a1+ad)/2));pp.addMarkerAngle(halfWay,(a1+ad)/2+(sweepFlag==0?1:-1)*Math.PI/2);pp.addMarkerAngle(cp,ad+(sweepFlag==0?1:-1)*Math.PI/2);if(ctx!=null){r=rx>ry?rx:ry;sx=rx>ry?1:rx/ry;sy=rx>ry?ry/rx:1;ctx.translate(centp.x,centp.y);ctx.rotate(xAxisRotation);ctx.scale(sx,sy);ctx.arc(0,0,r,a1,a1+ad,1-sweepFlag);ctx.scale(1/sx,1/sy);ctx.rotate(-xAxisRotation);ctx.translate(-centp.x,-centp.y)}}break;case"Z":case"z":if(ctx!=null){ctx.closePath()}pp.current=pp.start}}ctx.stroke()};Linevg=function(d){this.PathParser=new PathParser(d)};Linevg.prototype.getMarkers=function(){var points=this.PathParser.getMarkerPoints();var angles=this.PathParser.getMarkerAngles();var markers=[];for(var i=0;i<points.length;i++){markers.push([points[i],angles[i]])}return markers};Linevg.prototype.drawPath=function(ctx,data){var angle,point,markers;ctx.save();if(data.stroke_width!==undefined&&data.stroke_width!==null){ctx.lineWidth=data.stroke_width}if(data.stroke_dasharray!==undefined&&data.stroke_dasharray!==null){ctx.dasharray=data.stroke_dasharray.split(",")}if(data.opacity!==undefined&&data.opacity!==null){ctx.globalAlpha=data.opacity}if(data.stroke_linejoin!==undefined&&data.stroke_linejoin!==null){ctx.lineJoin=data.stroke_linejoin}if(data.stroke!==undefined&&data.stroke!==null){ctx.strokeStyle=(data.strokeStyle==="none")?"rgba(0,0,0,0)":data.stroke}drawPath(ctx,this.PathParser);if(ctx.dasharray){_gliffy.candash.cleanCtx(ctx)}markers=this.getMarkers();if(data.start_arrow!==0&&data.start_arrow!==null&&data.start_arrow!==undefined&&data.start_arrow!=="none"){ctx.save();point=markers[0][0];angle=markers[0][1];ctx.translate(point.x,point.y);if(data.marker_start_orient==="auto"){ctx.rotate(angle)}else{ctx.rotate(data.marker_start_orient*Math.PI/180)}_gliffy.shapeLibrary.drawStencil(data.start_arrow_tid,ctx,data);ctx.restore()}if(data.end_arrow!==0&&data.end_arrow!==null&&data.end_arrow!==undefined&&data.end_arrow!=="none"){ctx.save();point=markers[markers.length-1][0];angle=markers[markers.length-1][1];ctx.translate(point.x,point.y);if(data.marker_end_orient==="auto"){ctx.rotate(angle)}else{ctx.rotate(data.marker_end_orient*Math.PI/180)}_gliffy.shapeLibrary.drawStencil(data.end_arrow_tid,ctx,data);ctx.restore()}ctx.restore()};_gliffy.Linevg=Linevg}());(function(){var styleProp=($.browser.msie)?"display":"pointerEvents";var KoreSampl=function(){};KoreSampl.prototype.fromEvent=function(e,lastElement){e=e||window.event;return this.atPoint(e.clientX,e.clientY,lastElement)};KoreSampl.prototype.atPoint=function(clientX,clientY,lastElement,previousElement){var d=(lastElement)?lastElement.ownerDocument:document;lastElement=lastElement||d.getElementsByTagName("html")[0];var element=d.elementFromPoint(clientX,clientY);if(element===null||element===undefined||element===previousElement){return[]}else{if(element===lastElement||element.nodeName==="HTML"){return[element]}else{var style=element.style[styleProp];element.style[styleProp]="none";var result=[element].concat(this.atPoint(clientX,clientY,lastElement,element));element.style[styleProp]=style;return result}}};_gliffy.KoreSampl=new KoreSampl()})();(function($){var check={};var keys=[];$.fn.lazyload=function(options){var settings={threshold:0,failurelimit:0,delay:100,container:window,callback:function(element){}},elements=this,timeout=null;if(options){$.extend(settings,options)}$.fn.lazyload.delay=settings.delay;var key=new Date().getTime();var unseen=this.length;function checkElements(){var counter=0;var containerOffsets=getOffsets(settings.container);elements.each(function(){var $this=$(this);if($this.is(":visible")){var elementOffsets=getOffsets($this);if(aboveTheTop(containerOffsets,elementOffsets,settings)||leftOfBegin(containerOffsets,elementOffsets,settings)){}else{if(!belowTheFold(containerOffsets,elementOffsets,settings)&&!rightOfFold(containerOffsets,elementOffsets,settings)){$this.trigger("appear")}else{if(counter++>settings.failurelimit){return false}}}}})}function getOffsets(element){var elementTop,elementLeft,elementWidth,elementHeight;if(element==undefined||element==window){var $window=$(window);elementTop=$window.scrollTop();elementHeight=$window.height();elementLeft=$window.scrollLeft();elementWidth=$window.width()}else{var $element=$(element);elementTop=$element.offset().top;elementHeight=$element.height();elementLeft=$element.offset().left;elementWidth=$element.width()}return{top:elementTop,height:elementHeight,left:elementLeft,width:elementWidth}}function belowTheFold(containerOffsets,elementOffsets,settings){var fold=containerOffsets.top+containerOffsets.height;return fold<=elementOffsets.top-settings.threshold}function rightOfFold(containerOffsets,elementOffsets,settings){var fold=containerOffsets.left+containerOffsets.width;return fold<=elementOffsets.left-settings.threshold}function aboveTheTop(containerOffsets,elementOffsets,settings){var fold=containerOffsets.top;return fold>=elementOffsets.top+settings.threshold+elementOffsets.height}function leftOfBegin(containerOffsets,elementOffsets,settings){var fold=containerOffsets.left;return fold>=elementOffsets.left+settings.threshold+elementOffsets.width}this.each(function(){var $this=$(this);$this.one("appear",function(e){unseen--;if(unseen===0){var index=keys.indexOf(key);if(index>-1){keys.splice(index,1);delete check[key]}else{$(settings.container).unbind("scroll."+key)}}settings.callback($this)})});if(settings.container!==window){$(settings.container).bind("scroll."+key+" lazyload",function(e){if(timeout){clearTimeout(timeout)}timeout=setTimeout(function(){checkElements()},settings.delay)})}else{keys.push(key);check[key]=checkElements}checkElements();return this};var windowTimeout;$(window).bind("scroll.lazyload resize.lazyload lazyload",function(){if(windowTimeout){clearTimeout(windowTimeout)}if(keys.length>0){windowTimeout=setTimeout(function(){for(var i=0;i<keys.length;i++){check[keys[i]]()}},$.fn.lazyload.delay)}else{if(document.readyState==="complete"){$(window).unbind("scroll.lazyload resize.lazyload lazyload")}}})})(jQuery);(function(){var isDef=function(val){return val!==undefined};var Coordinate=function(opt_x,opt_y){this.x=isDef(opt_x)?opt_x:0;this.y=isDef(opt_y)?opt_y:0};Coordinate.prototype.clone=function(){return new Coordinate(this.x,this.y)};Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"};Coordinate.equals=function(a,b){if(a==b){return true}if(!a||!b){return false}return a.x==b.x&&a.y==b.y};Coordinate.distance=function(a,b){var dx=a.x-b.x;var dy=a.y-b.y;return Math.sqrt(dx*dx+dy*dy)};Coordinate.squaredDistance=function(a,b){var dx=a.x-b.x;var dy=a.y-b.y;return dx*dx+dy*dy};Coordinate.difference=function(a,b){return new Coordinate(a.x-b.x,a.y-b.y)};Coordinate.sum=function(a,b){return new Coordinate(a.x+b.x,a.y+b.y)};_gliffy.Coordinate=Coordinate})();(function(){var inherits=function(childCtor,parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;childCtor.superClass_=parentCtor.prototype;childCtor.prototype=new tempCtor();childCtor.prototype.constructor=childCtor};var Vec2=function(x,y){this.x=x;this.y=y};inherits(Vec2,_gliffy.Coordinate);Vec2.randomUnit=function(){var angle=Math.random()*Math.PI*2;return new Vec2(Math.cos(angle),Math.sin(angle))};Vec2.random=function(){var mag=Math.sqrt(Math.random());var angle=Math.random()*Math.PI*2;return new Vec2(Math.cos(angle)*mag,Math.sin(angle)*mag)};Vec2.fromCoordinate=function(a){return new Vec2(a.x,a.y)};Vec2.prototype.clone=function(){return new Vec2(this.x,this.y)};Vec2.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};Vec2.prototype.squaredMagnitude=function(){return this.x*this.x+this.y*this.y};Vec2.prototype.scale=function(s){this.x*=s;this.y*=s;return this};Vec2.prototype.invert=function(){this.x=-this.x;this.y=-this.y;return this};Vec2.prototype.normalize=function(){return this.scale(1/this.magnitude())};Vec2.prototype.safeNormalize=function(){var mag=this.magnitude();if(mag>0.00001){return this.scale(1/mag)}return this};Vec2.prototype.add=function(b){this.x+=b.x;this.y+=b.y;return this};Vec2.prototype.subtract=function(b){this.x-=b.x;this.y-=b.y;return this};Vec2.prototype.rotate=function(angle){var cos=Math.cos(angle);var sin=Math.sin(angle);var newX=this.x*cos-this.y*sin;var newY=this.y*cos+this.x*sin;this.x=newX;this.y=newY;return this};Vec2.rotateAroundPoint=function(v,axisPoint,angle){var res=v.clone();return res.subtract(axisPoint).rotate(angle).add(axisPoint)};Vec2.prototype.equals=function(b){return this==b||!!b&&this.x==b.x&&this.y==b.y};Vec2.distance=_gliffy.Coordinate.distance;Vec2.squaredDistance=_gliffy.Coordinate.squaredDistance;Vec2.equals=_gliffy.Coordinate.equals;Vec2.sum=function(a,b){return new Vec2(a.x+b.x,a.y+b.y)};Vec2.difference=function(a,b){return new Vec2(a.x-b.x,a.y-b.y)};Vec2.dot=function(a,b){return a.x*b.x+a.y*b.y};var lerp=function(a,b,x){return a+x*(b-a)};Vec2.lerp=function(a,b,x){return new Vec2(lerp(a.x,b.x,x),lerp(a.y,b.y,x))};_gliffy.Vec2=Vec2})();(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(jQuery)}})(function($,undefined){var tag2attr={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},key=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],aliases={anchor:"fragment"},parser={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},querystring_parser=/(?:^|&|;)([^&=;]*)=?([^&;]*)/g,fragment_parser=/(?:^|&|;)([^&=;]*)=?([^&;]*)/g;function parseUri(url,strictMode){var str=decodeURI(unescape(url)),res=parser[strictMode||false?"strict":"loose"].exec(str),uri={attr:{},param:{},seg:{}},i=14;while(i--){uri.attr[key[i]]=res[i]||""}uri.param.query={};uri.param.fragment={};uri.attr.query.replace(querystring_parser,function($0,$1,$2){if($1){uri.param.query[$1]=$2}});uri.attr.fragment.replace(fragment_parser,function($0,$1,$2){if($1){uri.param.fragment[$1]=$2}});uri.seg.path=uri.attr.path.replace(/^\/+|\/+$/g,"").split("/");uri.seg.fragment=uri.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");uri.attr.base=uri.attr.host?(uri.attr.protocol?uri.attr.protocol+"://"+uri.attr.host:uri.attr.host)+(uri.attr.port?":"+uri.attr.port:""):"";return uri}function getAttrName(elm){var tn=elm.tagName;if(tn!==undefined){return tag2attr[tn.toLowerCase()]}return tn}$.fn.url=function(strictMode){var url="";if(this.length){url=$(this).attr(getAttrName(this[0]))||""}return $.url(url,strictMode)};$.url=function(url,strictMode){if(arguments.length===1&&url===true){strictMode=true;url=undefined}strictMode=strictMode||false;url=url||window.location.toString();return{data:parseUri(url,strictMode),attr:function(attr){attr=aliases[attr]||attr;return attr!==undefined?this.data.attr[attr]:this.data.attr},param:function(param){return param!==undefined?this.data.param.query[param]:this.data.param.query},fparam:function(param){return param!==undefined?this.data.param.fragment[param]:this.data.param.fragment},segment:function(seg){if(seg===undefined){return this.data.seg.path}else{seg=seg<0?this.data.seg.path.length+seg:seg-1;return this.data.seg.path[seg]}},fsegment:function(seg){if(seg===undefined){return this.data.seg.fragment}else{seg=seg<0?this.data.seg.fragment.length+seg:seg-1;return this.data.seg.fragment[seg]}}}}});(function(){
/*!! Simple JavaScript Inheritance
     * By John Resig http://ejohn.org/
     * MIT Licensed.
     * http://ejohn.org/blog/simple-javascript-inheritance
     *
     */
var initializing=false,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;var Class=function(){};Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret}})(name,prop[name]):prop[name]}function Class(){if(!(this instanceof Class)){return new Class(arguments)}if(!initializing&&this.init){this.init.apply(this,arguments)}}Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=arguments.callee;return Class};var AnalyticsInterface=Class.extend({init:function(){},setAccount:function(){},trackEvent:function(){},trackPageView:function(){},logEvents:function(){},setLabel:function(){},runFuncIfAnalyticsExists:function(){}});var EventThrottler=Class.extend({__eventsRemaining:0,__maxEvents:0,__regenInterval:-1,__functionQueue:null,abort:function(){clearInterval(this.__regenInterval)},init:function(o){var options=$.extend({eventBucket:9,regen:1,per:1100},o),self=this;self.__eventsRemaining=options.eventBucket;self.__maxEvents=options.eventBucket;self.__functionQueue=[];self.__regenInterval=setInterval(function(){self.__eventsRemaining=Math.min(options.eventBucket,self.__eventsRemaining+options.regen);self.__runEvents()},options.per)},__runEvents:function(){var self=this,queueEntry;while(self.__eventsRemaining>0&&self.__functionQueue.length>0){queueEntry=self.__functionQueue.shift();queueEntry.func.apply(this,queueEntry.args);self.__eventsRemaining--}},addFunction:function(func,funcArgsArray){this.__functionQueue.push({func:func,args:funcArgsArray});this.__runEvents()}});var GoogleAnalytics=AnalyticsInterface.extend({_loaded:false,_trackerID:"",_logEvents:false,_logger:null,_activeLabel:null,_optPageName:null,_eventThrottler:null,_eventWarningCtr:450,_customVariableIndices:null,_canLog:function(){return this._logger!==null&&this._logEvents===true},init:function(trackerID,optPageName,onScriptLoadedFunc,debug){var s,ga=document.createElement("script"),self=this;this._optPageName=optPageName;if(debug===undefined){debug=false}ga.type="text/javascript";ga.async=true;ga.src=("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/"+(debug?"u/ga_debug.js":"ga.js");s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga,s);this._trackerID=trackerID;this._eventWarningCtr=450;ga.onreadystatechange=function(){if(this.readyState==="complete"){self._scriptLoaded();if(onScriptLoadedFunc){onScriptLoadedFunc()}}};ga.onload=function(){self._scriptLoaded();if(onScriptLoadedFunc){onScriptLoadedFunc()}};self._customVariableIndices={product:1,license:2,numUsers:3};self._eventThrottler=new EventThrottler()},loaded:function(){return this._loaded},setAccount:function(account){this._push(["_setAccount",account])},setLabel:function(label){this._activeLabel=label},setCustomVariables:function(product,license,numUsers){var PAGE_SCOPE=3;if(product){this._push(["_setCustomVar",this._customVariableIndices.product,"product",product,PAGE_SCOPE])}this._push(["_setCustomVar",this._customVariableIndices.license,"license",license,PAGE_SCOPE]);this._push(["_setCustomVar",this._customVariableIndices.numUsers,"numUsers",numUsers,PAGE_SCOPE])},trackEvent:function(category,action,opt_label,opt_value,opt_non_interaction){opt_label=opt_label===undefined?null:opt_label;opt_value=opt_value===undefined?null:opt_value;opt_non_interaction===undefined?null:opt_non_interaction;if(opt_label===null&&this._activeLabel!==null){opt_label=this._activeLabel}this._push(["_trackEvent",category,action,opt_label,opt_value,opt_non_interaction]);if(--this._eventWarningCtr===0){this._push(["_trackEvent","warning","eventsExceed450",opt_label,null,null])}if(category==="lzxclient"){this._push(["_trackPageview","/lzxEvent/"+action])}},trackPageView:function(){if(this._optPageName){this._push(["_trackPageview",this._optPageName])}else{this._push(["_trackPageview"])}},logEvents:function(bool,logger){this._logEvents=bool;this._logger=logger},_scriptLoaded:function(){this._loaded=true;this._push(["_setDomainName","none"]);this.setAccount(this._trackerID);this.trackPageView()},_push:function(eventArray){var self=this;this._eventThrottler.addFunction(function(){if(typeof _gaq!="undefined"){_gaq.push(eventArray);if(self._canLog()){self._logger.log("ANALYTICS: "+eventArray.join(", "))}}})},runFuncIfAnalyticsExists:function(func){if(func){func()}}});var _AnalyticsListener=Class.extend({_analytics:null,_queuedEvents:null,init:function(){var self=this;self._queuedEvents=[];jq=window.jQuery||window["$"];jq(window).bind("init.gliffyAnalytics",function(event,o){var options=jq.extend({},{accountType:"none",accountID:"UA-248648-8",debug:false,optPageName:null},o);if(!self._analytics){switch(options.accountType){case"google":self._analytics=new GoogleAnalytics(options.accountID,options.optPageName,function(){var typeAndOption;while(typeAndOption=self._queuedEvents.shift()){$(window).trigger(typeAndOption[0]+".gliffyAnalytics",typeAndOption[1])}},options.debug);break}}});jq(window).bind("trackEvent.gliffyAnalytics",function(event,o){var options=jq.extend({},{category:"",action:"",label:null,value:null,non_interaction:null},o);if(self._analytics&&self._analytics.loaded()){self._analytics.trackEvent(options.category,options.action,options.label,options.value,options.non_interaction)}else{self._queuedEvents.push(["trackEvent",o])}});jq(window).bind("setLabel.gliffyAnalytics",function(event,o){var options=jq.extend({},{label:null},o);if(self._analytics&&self._analytics.loaded()){self._analytics.setLabel(options.label)}else{self._queuedEvents.push(["setLabel",o])}});jq(window).bind("logEvents.gliffyAnalytics",function(event,o){var options=jq.extend({},{logEvents:false,logger:null},o);if(self._analytics&&self._analytics.loaded()){self._analytics.logEvents(options.logEvents,options.logger)}else{self._queuedEvents.push(["logEvents",o])}});jq(window).bind("setCustomVariables.gliffyAnalytics",function(event,o){var options=jq.extend({},{product:null,license:"none",numUsers:0},o);if(self._analytics&&self._analytics.loaded()){self._analytics.setCustomVariables(options.product,options.license,options.numUsers)}else{self._queuedEvents.push(["setCustomVariables",o])}});jq(window).bind("runFuncIfAnalyticsExists.gliffyAnalytics",function(event,o){var options=jq.extend({},{func:null},o);if(self._analytics){self._analytics.runFuncIfAnalyticsExists(options.func)}})}});var AnalyticsListener=new _AnalyticsListener()}());(function(){var MAX_STACK_LENGTH=1000;_gliffy.logger=_gliffy.Class.extend({stack:null,init:function(){this.stack=[]},log:function(message){this.stack.push({type:"log",message:"[LOG]   "+message});this.__check_length()},error:function(message){this.stack.push({type:"error",message:"[ERROR] "+message});this.__check_length()},warn:function(message){this.stack.push({type:"warn",message:"[WARN] "+message});this.__check_length()},__check_length:function(){if(_gliffy.Debug.LOG_TO_CONSOLE){console.log(this.stack[this.stack.length-1].message)}while(this.stack.length>MAX_STACK_LENGTH){this.stack.shift()}},getLog:function(o){var options=$.extend({log:true,warn:true,error:true,tail:MAX_STACK_LENGTH},o),i,stack=[];for(i=0;i<this.stack.length;i++){if(options[this.stack[i].type]>=0&&(i>this.stack.length-options.tail-1)){stack.unshift(this.stack[i].message)}}return stack}});_gliffy.Logger=new _gliffy.logger()}());(function(){var __errorHandler=null,__globalTarget=null;_gliffy.handleError=function(key,args,exception,target){args=args||[];target=target||__globalTarget||null;var message=$.i18n._(key,args);if(exception&&exception.toString().indexOf("0x80040111 (NS_ERROR_NOT_AVAILABLE)")!==-1){_gliffy.Logger.warn("FF 0x80040111 (NS_ERROR_NOT_AVAILABLE) "+exception.toString())}else{__errorHandler.report(message,exception,target)}};_gliffy.setErrorHandler=function(errorHandler){__errorHandler=errorHandler};_gliffy.setGlobalErrorTarget=function(target){__globalTarget=target||null};var DefaultErrorHandler=_gliffy.Class.extend({feedbackDialog:function(message,exception,report){var prop,output="",zIndex,confluenceSpinner,isIFrame=window.parent.document!==window.document;_gliffy.Dialog.showGenericDialog({content:message+"  "+$.i18n._("ERRORHANDLER_PLEASE_SEND_A_REPORT_TO_GLIFFY.__YOU_CAN_VIEW_THE_REPORT_BEFORE_IT_IS_SENT.")+"  "+$.i18n._("ERRORHANDLER_SADLY,_YOU_MAY_NEED_TO_REFRESH_YOUR_BROWSER_TO_CONTINUE_WORKING_NORMALLY."),title:$.i18n._("ERRORHANDLER_ERROR"),cancelCallback:null,buttons:[{text:$.i18n._("ERRORHANDLER_SEND_ERROR_REPORT"),callback:function(){$("body").trigger("send-error.gliffy-body",{message:message,report:report})},primary:true,dismiss:true},{text:$.i18n._("ERRORHANDLER_NO_THANKS"),callback:null,primary:false,dismiss:true}]});if(isIFrame){confluenceSpinner=$(window.parent.document).find(".gliffy-spinner");if(confluenceSpinner.is(":visible")){confluenceSpinner.remove();_gliffy.Spinner.show("confluence")}}},getErrorReport:function(message,exception){var prop,output=$.i18n._("ERRORHANDLER_WHAT_WERE_YOU_DOING_JUST_BEFORE_THIS_ERROR?")+"\n===============================\n\n\n\n\n"+$.i18n._("ERRORHANDLER_ERROR_REPORT")+"\n============\n\nError Type: "+message+"\n\n";try{output+="Gliffy Version: ["+_gliffy.versionString+"] \n\n"}catch(e0){output+="Missing Gliffy Version\n\n"}try{output+="Confluence Build Number ["+_gliffy.confluenceVersion+"] \n\n"}catch(e0a){output+="Missing Confluence Build Number."}try{output+=_gliffy.BrowserDetect.dump()+"\n\n"}catch(e1){output+="Missing BrowserDetect\n\n"}if(!exception||exception===undefined){output+="No exception generated.\n\n"}else{try{output+="Exception: ["+exception.toString()+"]\n\n"}catch(e2){output+="Missing exception.toString().\n\n"}try{for(prop in exception){if(exception.hasOwnProperty(prop)){output+="Exception property: "+prop+" value: ["+exception[prop]+"]\n\n"}}}catch(e3){output+="Missing Exception properties.\n\n"}try{if(exception.stack!==undefined){output+="Stack: ["+exception.stack+"]\n\n"}else{output+="No stack available\n\n"}}catch(e4){output+="Missing Stack\n\n"}}try{output+="Logger: [\n"+_gliffy.Logger.getLog({tail:20}).join("\t\n")+"]\n\n"}catch(e5){output+="Missing Logger\n"}try{_gliffy.Mouse.editor.getDocumentManager().getActiveStage().commandHistory.forceFinalizeCommandBundle();output+=_gliffy.Mouse.editor.getDocumentManager().getActiveStage().commandHistory.getReport(10)}catch(e6){output+="Missing Command Report\n"}return output},report:function(message,exception,target){var report;if(message===null||message===undefined){message="An unknown error has occurred."}report=this.getErrorReport(message,exception);if(_gliffy.Debug.NO_ERROR_DIALOG!==true){if(_gliffy.Dialog){this.feedbackDialog(message,exception,report)}else{window.alert(message)}}window.console.log(report)}});_gliffy.setErrorHandler(new DefaultErrorHandler())}());(function(){var MAC_KEYS={command:String.fromCharCode(8984),shift:String.fromCharCode(8679),del:String.fromCharCode(9003),esc:String.fromCharCode(9099),alt:String.fromCharCode(8997)},uidCounter=0;_gliffy.Utils={SNAP_DEGREES_MULTIPLIER:360,FLOAT_EQUALS_THRESHOLD:0.0001,FLOAT_FIXED:4,SNAP_PIXELS:10,__urlParams:null,getContext:function(canvas){return canvas.getContext("2d")},getMockContext:function(){return{width:0,height:0,canvas:document.createElement("canvas"),save:function(){},restore:function(){},scale:function(){},rotate:function(){},translate:function(){},transform:function(){},setTransform:function(){},globalAlpha:function(){},globalCompositeOperation:function(){},strokeStyle:"",fillStyle:"",createLinearGradient:function(){return{addColorStop:function(){}}},createRadialGradient:function(){return{addColorStop:function(){}}},createPattern:function(){},lineCap:"",lineJoin:"",miterLimit:"",shadowColor:"",shadowOffsetX:"",shadowOffsetY:"",shadowBlur:"",clearRect:function(){},fillRect:function(){},strokeRect:function(){},beginPath:function(){},moveTo:function(){},closePath:function(){},lineTo:function(){},quadraticCurveTo:function(){},bezierCurveTo:function(){},arcTo:function(){},arc:function(){},rect:function(){},fill:function(){},stroke:function(){},clip:function(){},isPointInPath:function(){},drawFocusRing:function(){},font:"",textAlign:"",textBaseline:"",fillText:function(){},strokeText:function(){},measureText:function(){return{width:0}},drawImage:function(){},createImageData:function(){},getImageData:function(){return{width:0,height:0,data:""}},putImageData:function(){}}},randomString:function(holder){var chars,randomstring,i;if(!holder){throw"cannot create a random attribute name for an undefined object"}chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";randomstring="";do{randomstring="";for(i=0;i<12;i++){randomstring+=chars[Math.floor(Math.random()*chars.length)]}}while(holder[randomstring]);return randomstring},forceMatrixOnly:false,transformCss:function(transform,o){var options=$.extend({originX:0,originY:0,roundTranslate:false,matrixOnly:false},o),transformCss,transform_origin;if(this.forceMatrixOnly){options.matrixOnly=true}if(options.matrixOnly){transformCss=transform.toCss({isMoz:false,roundTranslate:options.roundTranslate});transform_origin=options.originX+" "+options.originY;return{"-moz-transform":transform.toCss({isMoz:true,roundTranslate:options.roundTranslate}),"-webkit-transform":transformCss,"-o-transform":transformCss,msTransform:transformCss,transform:transformCss,"transform-origin":transform_origin,msTransformOrigin:transform_origin,"-webkit-transform-origin":transform_origin,"-moz-transform-origin":transform_origin,"-o-transform-origin":transform_origin}}else{transformCss=transform.toCssNoTranslate({isMoz:false,roundTranslate:options.roundTranslate});transform_origin=options.originX+" "+options.originY;return{"-moz-transform":transform.toCssNoTranslate({isMoz:true,roundTranslate:options.roundTranslate}),"-webkit-transform":transformCss,"-o-transform":transformCss,msTransform:transformCss,transform:transformCss,"transform-origin":transform_origin,msTransformOrigin:transform_origin,"-webkit-transform-origin":transform_origin,"-moz-transform-origin":transform_origin,"-o-transform-origin":transform_origin,top:transform.getTranslateY(),left:transform.getTranslateX()}}},posMod:function(x,y){if(y===0){return x}return x-y*Math.floor(x/y)},unwrapRadians:function(radians){return _gliffy.Utils.posMod(radians,Math.PI*2)},trim_right:function(text){if(String.prototype.trimRight){return text.trimRight()}else{return text.replace(/\s+$/,"")}},maxBounds:function(transform,width,height,stage){var maxX,maxY,i,inViewport=false,point,points=[{x:0,y:0},{x:width,y:0},{x:width,y:height},{x:0,y:height}];for(i=0;i<points.length;i++){point=transform.transformPoint(points[i].x,points[i].y);if(i===0){maxX=point.x;maxY=point.y}maxX=Math.max(point.x,maxX);maxY=Math.max(point.y,maxY);if(stage.autoFit){if(point.x>0&&point.y>0){inViewport=true}}else{if(point.x>0&&point.y>0&&point.x<stage.width*stage.getZoom()&&point.y<stage.height*stage.getZoom()){inViewport=true}}}return{x:maxX,y:maxY,inViewport:inViewport}},maxInArray:function(arr){return Math.max.apply(Math,arr)},minInArray:function(arr){return Math.min.apply(Math,arr)},tryCatch:function(tryFunc,catchFunc){if(_gliffy.Debug.SKIP_CATCH_ERRORS){return tryFunc()}else{try{return tryFunc()}catch(e){catchFunc(e)}}},cloneArray:function(arr){var out=[],i;for(i=0;i<arr.length;i++){if(arr[i].length){out[i]=_gliffy.Utils.cloneArray(arr[i])}else{out[i]=arr[i]}}return out},wrapDegrees:function(degree){while(degree<0){degree+=360}return degree%360},radiansToDegrees:function(radians){return(radians*180/Math.PI)},degreesToRadians:function(degrees){return(degrees*Math.PI/180)},convertRanges:function(oldValue,oldRangeStart,oldRangeEnd,newRangeStart,newRangeEnd){return(((oldValue-oldRangeStart)*(newRangeEnd-newRangeStart))/(oldRangeEnd-oldRangeStart))+newRangeStart},calculateLineSnap:function(curPoint,opposingPoint,snapDegrees){var pointToPoint=_gliffy.Vec2.difference(curPoint,opposingPoint),snapped,angle,degrees,mod,newDegrees;snapped=false;if(pointToPoint.x!==0||pointToPoint.y!==0){angle=_gliffy.Utils.unwrapRadians(Math.atan2(pointToPoint.y,pointToPoint.x));degrees=_gliffy.Utils.radiansToDegrees(angle);mod=_gliffy.Utils.posMod(degrees,90);if(mod>(90-snapDegrees)||mod<snapDegrees){snapped=true;newDegrees=Math.floor(_gliffy.Utils.posMod(degrees+snapDegrees,360)/90)*90;pointToPoint=pointToPoint.rotate(_gliffy.Utils.degreesToRadians(newDegrees-degrees));curPoint=_gliffy.Vec2.sum(pointToPoint,opposingPoint)}}return{snapped:snapped,point:curPoint}},floatEquals:function(float1,float2,threshold){threshold=threshold||this.FLOAT_EQUALS_THRESHOLD;return Math.abs(float1-float2)<=threshold},floatToString:function(floatz,fixed){var result;if(isNaN(fixed)){fixed=this.FLOAT_FIXED}result=floatz.toFixed(fixed).replace(/\.?0+$/,"");return(result==="-0")?"0":result},boundingBoxToCss:function(boundingBox,zoom){var topLeft=new _gliffy.Vec2(boundingBox.min.x,boundingBox.min.y),dimension=boundingBox.getDimension();if(zoom!==undefined){dimension.scale(zoom);topLeft.scale(zoom)}return{left:topLeft.x+"px",top:topLeft.y+"px",width:dimension.x+"px",height:dimension.y+"px"}},stealFocus:function(){if($(document.activeElement).get(0)!==document.body){$("<textarea />").prependTo($("body")).focus().blur().remove()}},hsv2rgb:function(hsv){var h=hsv.hue,s=hsv.sat,v=hsv.val,rgb,i,data=[];if(s===0){rgb=[v,v,v]}else{h=h/60;i=Math.floor(h);data=[v*(1-s),v*(1-s*(h-i)),v*(1-s*(1-(h-i)))];switch(i){case 0:rgb=[v,data[2],data[0]];break;case 1:rgb=[data[1],v,data[0]];break;case 2:rgb=[data[0],v,data[2]];break;case 3:rgb=[data[0],data[1],v];break;case 4:rgb=[data[2],data[0],v];break;default:rgb=[v,data[0],data[1]];break}}return"#"+rgb.map(function(x){return("0"+Math.round(x*255).toString(16)).slice(-2)}).join("")},selectAllTextInElement:function(element){var range,selection;element=$(element);if(element.length>0){element=element.get(0);if(document.body.createTextRange){range=document.body.createTextRange();range.moveToElementText(element);range.select()}else{if(window.getSelection){selection=window.getSelection();range=document.createRange();range.selectNodeContents(element);selection.removeAllRanges();selection.addRange(range)}}}},getTextBoundingBox:function(element,offset){var range,rect;element=$(element);if(element.length>0){element=element.get(0);offset=offset||{x:0,y:0};if(document.createRange){range=document.createRange();range.selectNodeContents(element);if(range.getBoundingClientRect){rect=range.getBoundingClientRect();if(rect){return new _gliffy.BoundingBox((rect.left+offset.x),(rect.top+offset.y),(rect.right+offset.x),(rect.bottom+offset.y))}}}}return new _gliffy.BoundingBox()},setSnapToGrid:function(auto){this.__autoGrid=auto},shouldSnapToGrid:function(){if(this.__autoGrid){return _gliffy.KeyManager.shiftKeyDown?!GliffyApp.documentModel.snapToGrid:GliffyApp.documentModel.snapToGrid}else{return false}},hasNonWhitespaceCharacter:function(str){var pattern=/\S+/;return pattern.test(str)},removeLineBreaks:function(str){return str.replace(/(\r\n|\n|\r)/gm,"")},getLocalOffset:function(startPosition,endPosition,node){var localSpace=node.worldTransform.createInverse();return _gliffy.Vec2.difference(localSpace.transformPoint(endPosition.x,endPosition.y),localSpace.transformPoint(startPosition.x,startPosition.y))},isHorizontal:function(startPoint,endPoint){return Math.abs(startPoint.y-endPoint.y)<0.001},clamp:function(value,min,max){return(value<min)?min:((value>max)?max:value)},parseBoolean:function(str){return(/true/i.test(str))},capitalize:function(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})},capitalizeFirstWord:function(word){word=word.toLowerCase();return word.charAt(0).toUpperCase().concat(word.slice(1,word.length))},hashCode:function(string){var hash=0,i,char_;if(string.length===0){return hash}for(i=0;i<string.length;i++){char_=string.charCodeAt(i);hash=((hash<<5)-hash)+char_;hash=hash&hash}return hash},equalPoints:function(p1,p2,tolerance){if(tolerance===undefined){tolerance=0}if($.isArray(p1)&&$.isArray(p2)){return((Math.abs(p1[0]-p2[0])<=tolerance)&&Math.abs(p1[1]-p2[1])<=tolerance)}return false},drawBoundingBox:function(boundingBox,style,parentElement){var css=$.extend(style||{backgroundColor:"#ff0000",opacity:0.5},_gliffy.Utils.boundingBoxToCss(boundingBox)),div=$("<div></div>");css.position="absolute";css.padding="0px";css.margin="0px";css.zIndex=10000000;$(parentElement||"#container").append(div.css(css));$(document).dblclick(function(){div.remove()})},drawPoint:function(point,style,parentElement){style=$.extend(style||{},{backgroundColor:"#ffffff",outline:"5px solid #000000",opacity:0.5});_gliffy.Utils.drawBoundingBox(new _gliffy.BoundingBox(point.x,point.y,point.x+1,point.y+1),style,parentElement)},pointToColor:function(point,min,max,invert){var xColor=Math.round((point.x-min)/(max-min)*255),yColor=Math.round((point.y-min)/(max-min)*255),prefix="#00";if(invert){xColor=255-xColor;yColor=255-yColor;prefix="#ff"}xColor=xColor.toString(16);if(xColor.length===1){xColor="0"+xColor}yColor=yColor.toString(16);if(yColor.length===1){yColor="0"+yColor}return prefix+xColor+yColor},getRenderedStyle:function($ele,requestedStyle){var style="",DOCUMENT_TYPE=9;while((style===""||style===undefined||style===null)&&($ele.length>0)&&$ele[0].nodeType!==DOCUMENT_TYPE){style=$ele.css(requestedStyle);$ele=$ele.parent()}return(style===undefined||style===null)?"":style},addDynamicStyle:function(styleString){$("#gliffy-dynamic-style").append(styleString)},notify:function(type,title,message,fadeOutTime,rightOffset,topOffset){if(Mustache){var html=Mustache.render($("#gliffy-notify-popup-template").html(),{type:type,title:title,message:message});$(html).appendTo("body");if(rightOffset){$("#gliffy-notify-popup").css("right",rightOffset)}if(topOffset){$("#gliffy-notify-popup").css("top",topOffset)}if(fadeOutTime){setTimeout(function(){$("#gliffy-notify-popup").fadeOut(1000,function(){$("#gliffy-notify-popup").alert("close")})},fadeOutTime)}}else{window.alert(title+"\n\n"+message)}},analyticsEvent:function(type,options){$(window).trigger(type+".gliffyAnalytics",options)},analyticsTimerStart:function(name,alsoProfile){_gliffy.Timer.start(name,alsoProfile)},analyticsTimerEnd:function(name){var time=_gliffy.Timer.end(name);_gliffy.Utils.analyticsEvent("trackEvent",{category:"time",action:name,value:time/1000,non_interaction:true})},sortJson:function(myObj){var keys=[],k,i,len,out;for(k in myObj){if(myObj.hasOwnProperty(k)){keys.push(k)}}keys.sort();len=keys.length;for(i=0;i<len;i++){k=keys[i];out+='"'+k+'":"'+myObj[k]+'"\n'}window.console.log(out)},createIframe:function(name,onReady){var iframe,contents;iframe=$("<iframe />",{src:"",name:name,id:name}).appendTo("body");contents=iframe.contents();if(contents&&contents.get(0).readyState==="complete"){onReady(iframe)}else{iframe.bind("load.preajax",function(){iframe.unbind("load.preajax");onReady(iframe)})}},iframeDownload:function(url,successCallback,errorCallback){var name="iframeDownload"+uidCounter;uidCounter++;this.createIframe(name,function(iframe){iframe.bind("load.ajax",function(){if(successCallback){successCallback()}iframe.unbind(".ajax");iframe.remove()});iframe.bind("error.ajax",function(){if(errorCallback){errorCallback()}iframe.unbind(".ajax");iframe.remove()});iframe.attr("src",url)})},iframeAjax:function(url,data,successCallback,errorCallback){var name="iframeAjax"+uidCounter;uidCounter++;this.createIframe(name,function(iframe){var form,key;iframe.bind("load.ajax",function(){if(successCallback){successCallback()}iframe.unbind(".ajax");iframe.remove()});iframe.bind("error.ajax",function(){if(errorCallback){errorCallback()}iframe.unbind(".ajax");iframe.remove()});form=$("<form/>",{method:"post",action:url,target:iframe.attr("id")});for(key in data){if(data.hasOwnProperty(key)){form.append($("<input/>",{type:"hidden",name:key,value:data[key]}))}}form.appendTo($("body"));form.submit();form.remove()})},isEnglish:function(editor){return(!editor.language||editor.language.indexOf("en")===0)},getImageUrlFromHtml:function(html){html=html.replace("'",'"');var match=/<img\s+(\S+\s+)*src="([^"]+)"/.exec(html);if(match){return match[2]}else{return null}},disableExportsForBeta:function(){$(".gliffy-filemenu-exportAsGXML").addClass("disabled")},enableExportsForBeta:function(){$(".gliffy-filemenu-exportAsGXML").removeClass("disabled");$(".gliffy-filemenu-exportAsSVG").removeClass("disabled")}};_gliffy.Utils.forceMatrixOnly=_gliffy.BrowserDetect.browser==="Safari"&&_gliffy.BrowserDetect.version===5.1}());(function(){var __requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1000/60)},__frameRate,__tasks=[],__stop=true;function currentTime(){return(new Date()).getTime()/1000}function FrameRate(){this.__div=$("<div class='gliffy-frame-rate'>Computing fps...</div>");$("body").append(this.__div);this.__deltaTime=0;this.__currentTime=currentTime();this.__frame=0;this.update=function(){var newTime=currentTime(),display;this.__frame++;this.__deltaTime=newTime-this.__currentTime;if(this.__deltaTime>1){display=(this.__frame/this.__deltaTime).toFixed(1)+" fps";this.__div.html(display);this.__deltaTime=0;this.__frame=0;this.__currentTime=newTime}};this.remove=function(){this.__div.remove();this.__div=null}}function __runTasks(){var i;for(i=0;i<__tasks.length;i++){__tasks[i]()}}function __catchError(e){_gliffy.RenderLoop.stop();_gliffy.Logger.error("Render loop failed: "+e.message);_gliffy.handleError("com.gliffy.error.render_loop",[],e)}function __loop(){var i;if(!__stop){__requestAnimationFrame(__loop);for(i=0;i<__tasks.length;i++){if(!__stop){_gliffy.Utils.tryCatch(__runTasks,__catchError)}}if(__frameRate){__frameRate.update()}}}_gliffy.RenderLoop={start:function(){if(__stop===true&&!_gliffy.Debug.SKIP_RENDER_LOOP){__stop=false;__requestAnimationFrame(__loop)}},stop:function(){_gliffy.Logger.warn("Render loop was stopped.");__stop=true},appendTask:function(task){__tasks.push(task)},removeTask:function(task){var index=__tasks.indexOf(task);if(index!==-1){__tasks.splice(index,1)}},showFrameRate:function(){__frameRate=new FrameRate()},hideFrameRate:function(){__frameRate.remove();__frameRate=null},toggleFrameRate:function(){if(__frameRate){this.hideFrameRate()}else{this.showFrameRate()}}}}());(function(){var __tempArray=[];_gliffy.BoundingBox=_gliffy.Class.extend({min:null,max:null,init:function(minX,minY,maxX,maxY){this.min=new _gliffy.Vec2(minX||0,minY||0);this.max=new _gliffy.Vec2(maxX||0,maxY||0)},growPoint:function(point){return this.grow(point.x,point.y)},grow:function(x,y){if(x<this.min.x){this.min.x=x}if(x>this.max.x){this.max.x=x}if(y<this.min.y){this.min.y=y}if(y>this.max.y){this.max.y=y}return this},extend:function(amount){this.min.x-=amount;this.min.y-=amount;this.max.x+=amount;this.max.y+=amount;if(amount<0){this.fit([this.min.x,this.min.y,this.max.x,this.max.y])}return this},add:function(boundingBox){this.grow(boundingBox.min.x,boundingBox.min.y);this.grow(boundingBox.max.x,boundingBox.max.y);return this},copy:function(boundingBox){this.min.x=boundingBox.min.x;this.min.y=boundingBox.min.y;this.max.x=boundingBox.max.x;this.max.y=boundingBox.max.y;return this},fitPoints:function(points){var i,x,y;x=points[0].x;y=points[0].y;this.min.x=x;this.max.x=x;this.min.y=y;this.max.y=y;for(i=1;i<points.length;i++){this.grow(points[i].x,points[i].y)}return this},fit:function(coords){var i,x,y;if(coords.length<2){throw new Error("The parameter coords must be an array of at lest 2 length.")}x=coords[0];y=coords[1];this.min.x=x;this.max.x=x;this.min.y=y;this.max.y=y;for(i=2;i<coords.length;i+=2){this.grow(coords[i],coords[i+1])}return this},clone:function(){return new _gliffy.BoundingBox(this.min.x,this.min.y,this.max.x,this.max.y)},transform:function(affineTransform){this.fit(this.__toRectangle(affineTransform));return this},intersects:function(boundingBox,affineTransform){if(affineTransform){boundingBox=boundingBox.clone().transform(affineTransform)}if(this.max.x<boundingBox.min.x||this.min.x>boundingBox.max.x||this.max.y<boundingBox.min.y||this.min.y>boundingBox.max.y){return false}else{return true}},boundingBoxInside:function(boundingBox,affineTransform){if(affineTransform){boundingBox=boundingBox.clone().transform(affineTransform)}return this.min.x<=boundingBox.min.x&&this.min.y<=boundingBox.min.y&&this.max.x>=boundingBox.max.x&&this.max.y>=boundingBox.max.y},inBoundingBox:function(containingBoundingBox){return(this.max.x>containingBoundingBox.min.x)&&(this.max.y>containingBoundingBox.min.y)&&(this.min.x<containingBoundingBox.max.x)&&(this.min.y<containingBoundingBox.max.y)},pointInside:function(x,y){return x>=this.min.x&&x<=this.max.x&&y>=this.min.y&&y<=this.max.y},pointDistance:function(x,y){var xDistance=0,yDistance=0;if(x<this.min.x){xDistance=x-this.min.x}else{if(x>this.max.x){xDistance=x-this.max.x}}if(y<this.min.y){yDistance=y-this.min.y}else{if(y>this.max.y){yDistance=y-this.max.y}}return new _gliffy.Vec2(xDistance,yDistance)},setMinMax:function(minX,minY,maxX,maxY){this.min.x=minX||0;this.min.y=minY||0;this.max.x=maxX||0;this.max.y=maxY||0;return this},setByCenter:function(center,dimension){var halfX=dimension.x/2,halfY=dimension.y/2;this.min.x=center.x-halfX;this.min.y=center.y-halfY;this.max.x=center.x+halfX;this.max.y=center.y+halfY},toString:function(){return"min("+_gliffy.Utils.floatToString(this.min.x)+","+_gliffy.Utils.floatToString(this.min.y)+") max("+_gliffy.Utils.floatToString(this.max.x)+","+_gliffy.Utils.floatToString(this.max.y)+")"},equals:function(boundingBox){if(boundingBox){return _gliffy.Utils.floatEquals(this.min.x,boundingBox.min.x)&&_gliffy.Utils.floatEquals(this.max.x,boundingBox.max.x)&&_gliffy.Utils.floatEquals(this.min.y,boundingBox.min.y)&&_gliffy.Utils.floatEquals(this.max.y,boundingBox.max.y)}else{return false}},getDimension:function(){return _gliffy.Vec2.difference(this.max,this.min)},getWidth:function(){return this.getDimension().x},getHeight:function(){return this.getDimension().y},getCenter:function(){return _gliffy.Vec2.lerp(this.max,this.min,0.5)},__toRectangle:function(affineTransform){__tempArray[0]=this.min.x;__tempArray[1]=this.min.y;__tempArray[2]=this.min.x;__tempArray[3]=this.max.y;__tempArray[4]=this.max.x;__tempArray[5]=this.max.y;__tempArray[6]=this.max.x;__tempArray[7]=this.min.y;affineTransform.transform(__tempArray,0,__tempArray,0,4);return __tempArray}});_gliffy.BoundingBox.INFINITE=new _gliffy.BoundingBox(Number.MIN_VALUE,Number.MIN_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);_gliffy.BoundingBox.SMALLEST=new _gliffy.BoundingBox(Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE)}());(function(){var _compositeColor=new _gliffy.RGBColor("#000000");var MAX_BYTE=255;_gliffy.ColorUtils={multiply:function(sourceColor,destColor){sourceColor=new _gliffy.RGBColor(sourceColor);destColor=new _gliffy.RGBColor(destColor);_compositeColor.r=Math.floor(sourceColor.r*destColor.r/MAX_BYTE);_compositeColor.g=Math.floor(sourceColor.g*destColor.g/MAX_BYTE);_compositeColor.b=Math.floor(sourceColor.b*destColor.b/MAX_BYTE);return _compositeColor.toHex()},generator:function(type,sourceColor){return function(){return function(destColor){return _gliffy.ColorUtils[type](sourceColor,destColor)}}}}}());(function(){function WindowMessage(nameSpace,domainFilter,targetWindowName){this.__nameSpace=nameSpace;this.__domainFilter=domainFilter;this.__targetWindowName=targetWindowName||null}WindowMessage.prototype.setDomainFilter=function(domainFilter){this.__domainFilter=domainFilter};WindowMessage.prototype.setNameSpace=function(nameSpace){this.__nameSpace=nameSpace};WindowMessage.prototype.setTargetWindowName=function(targetWindowName){this.__targetWindowName=targetWindowName||null};WindowMessage.prototype.getTargetWindow=function(){var frame=null;if(this.__targetWindowName!==null){if(typeof(this.__targetWindowName)==="string"){frame=window.frames[this.__targetWindowName]}else{frame={window:this.__targetWindowName}}}else{frame=window.parent}if(frame&&frame.postMessage){return frame}else{if(frame&&frame.window&&frame.window.postMessage){return frame.window}else{if(frame&&frame.contentWindow&&frame.contentWindow.postMessage){return frame.contentWindow}else{throw new Error("The frame "+this.__targetWindowName+" was not found.")}}}};WindowMessage.prototype.send=function(action,data){if(this.__domainFilter){this.getTargetWindow().postMessage(JSON.stringify({nameSpace:this.__nameSpace,action:action,data:data||null}),this.__domainFilter)}else{throw new Error("No domain filter was set.")}};WindowMessage.prototype.receive=function(action,callback){var self=this,listener;listener=function(event){if(event.source===self.getTargetWindow()&&event.data){var data=JSON.parse(event.data);if(data.nameSpace===self.__nameSpace&&data.action===action){callback(data.data);window.removeEventListener("message",listener,false);listener=null}}};window.addEventListener("message",listener,false)};window.GLIFFY=window.GLIFFY||{};window.GLIFFY.WindowMessage=WindowMessage}());(function(){var STENCIL_MARKERS=["com.gliffy.stencil.marker_start.v1","com.gliffy.stencil.marker_end.v1","com.gliffy.stencil.marker_start.v2","com.gliffy.stencil.marker_end.v2","com.gliffy.stencil.marker_start.v3","com.gliffy.stencil.marker_end.v3","com.gliffy.stencil.marker_start.v4","com.gliffy.stencil.marker_end.v4","com.gliffy.stencil.marker_start.v5","com.gliffy.stencil.marker_end.v5","com.gliffy.stencil.marker_start.v6","com.gliffy.stencil.marker_end.v6","com.gliffy.stencil.marker_start.v7","com.gliffy.stencil.marker_end.v7","com.gliffy.stencil.marker_start.v8","com.gliffy.stencil.marker_end.v8","com.gliffy.stencil.marker_start.v9","com.gliffy.stencil.marker_end.v9","com.gliffy.stencil.marker_start.v10","com.gliffy.stencil.marker_end.v10","com.gliffy.stencil.marker_start.v11","com.gliffy.stencil.marker_end.v11","com.gliffy.stencil.marker_start.v12","com.gliffy.stencil.marker_end.v12","com.gliffy.stencil.marker_start.v13","com.gliffy.stencil.marker_end.v13","com.gliffy.stencil.marker_start.v14","com.gliffy.stencil.marker_end.v14","com.gliffy.stencil.marker_start.v15","com.gliffy.stencil.marker_end.v15","com.gliffy.stencil.marker_start.v16","com.gliffy.stencil.marker_end.v16","com.gliffy.stencil.marker_start.v17","com.gliffy.stencil.marker_end.v17","com.gliffy.stencil.marker_start.v18","com.gliffy.stencil.marker_end.v18"],STENCIL_DEPENDENCIES={RGBColor:_gliffy.RGBColor,candash:_gliffy.candash},IGNORED_STENCIL_TIDS=["com.gliffy.stencil.line"],IGNORED_SHAPE_UIDS=["com.gliffy.shape.basic.basic_v1.default.group","com.gliffy.shape.basic.basic_v1.default.selection"];_gliffy.ShapeLibrary=_gliffy.Class.extend({init:function(options){var o=$.extend({},{rootServiceURL:"../api"},options);this.rootServiceURL=o.rootServiceURL;this.shapes={};this.templates={};this.custom_function={};this.svgDim={};this.svgStencil={};this.libraries={};this.libraryList={}},setup:function(options){var o=$.extend({},{rootServiceURL:this.rootServiceURL},options);this.rootServiceURL=o.rootServiceURL},shapes:null,svgDim:null,templates:null,custom_function:null,markersLoaded:false,libraries:null,svgStencil:null,defaultLibraries:[],loadSvgStencil:function(svg,resource,useDefaultFailHandler){var url=this.rootServiceURL+"/stencils/svg.json",self=this,defer;if(!this.svgStencil[svg]){defer=$.Deferred();$.ajax({url:url,type:"POST",data:svg,dataType:"json",contentType:"application/json; charset=utf-8",traditional:true}).pipe(function(data){return data},function(xhr,text,error){defer.reject(xhr.responseText)}).then(function(data){try{self.templates[svg]=new Function("ctx","data","_gliffy",data.template);self.svgDim[svg]={width:parseFloat(data.width),height:parseFloat(data.height),x:parseFloat(data.x),y:parseFloat(data.y)};if(resource){resource.setX(parseFloat(data.x));resource.setY(parseFloat(data.y));resource.setWidth(parseFloat(data.width));resource.setHeight(parseFloat(data.height))}defer.resolve(data)}catch(e){var message="200, but failed to load svg:"+e+" ";if(e.stack!==undefined){message+="Stack: ["+e.stack+"]\n\n"}_gliffy.Logger.warn(message);defer.reject(svg)}});this.svgStencil[svg]=defer.promise()}if(useDefaultFailHandler){return this.svgStencil[svg].fail(function(xhr,text,error){_gliffy.Logger.warn("failed to load svg: "+svg);_gliffy.handleError("com.gliffy.error.stencil_load",[url],new Error(xhr.responseText))})}else{return this.svgStencil[svg]}},loadLibraryList:function(uid,language){var url=this.rootServiceURL+"/libraries/list/"+uid;if(!this.libraryList[uid]){this.libraryList[uid]=$.Deferred(function(defer){$.ajax({type:"GET",url:url,data:{locale:language||"en"}}).then(defer.resolve,defer.reject)}).promise()}return this.libraryList[uid].fail(function(xhr,text,error){_gliffy.handleError("com.gliffy.error.operation_failed",[url],error)})},loadLibraries:function(libraryArray,language){var url=this.rootServiceURL+"/libraries.json"+(language?"?locale="+language:""),uid,i,libraries=[],promise,self=this;libraryArray=libraryArray||[];for(i=0;i<libraryArray.length;i++){if(!this.libraries[libraryArray[i]]){libraries.push(libraryArray[i])}}if(libraries.length>0){promise=$.Deferred(function(defer){$.ajax({url:url,type:"POST",data:JSON.stringify(libraries),dataType:"json",contentType:"application/json; charset=utf-8",traditional:true}).then(function(data){for(i=0;i<data.libraries.length;i++){self.libraries[data.libraries[i].uid]=data.libraries[i]}defer.resolve()},defer.fail)}).promise()}else{promise=$.Deferred(function(defer){defer.resolve()}).promise()}return promise.fail(function(xhr,text,error){_gliffy.handleError("com.gliffy.error.operation_failed",[url],error)})},loadStencils:function(shapeArray,errorTarget){var url=this.rootServiceURL+"/stencils.json",promise,self=this,i=0,tid,shapes=[];shapeArray=shapeArray||[];if(!this.markersLoaded){this.markersLoaded=true;shapeArray=shapeArray.concat(STENCIL_MARKERS)}for(i=0;i<shapeArray.length;i++){tid=shapeArray[i];if(tid!==null&&tid!==undefined&&!self.templates[tid]&&$.inArray(tid,shapes)===-1&&$.inArray(tid,IGNORED_STENCIL_TIDS)===-1){shapes.push(tid)}}if(shapes.length>0){promise=$.Deferred(function(defer){$.ajax({url:url,type:"POST",data:JSON.stringify(shapes),dataType:"json",contentType:"application/json; charset=utf-8",traditional:true}).then(defer.resolve,defer.reject)}).promise();promise.then(function(data,text,xhr){_gliffy.Utils.tryCatch(function(){var i,shape;for(i=0;i<data.length;i++){shape=data[i];self.__addStencil(shape)}},function(e){_gliffy.Logger.warn("failed to load stencils: "+JSON.stringify(shapes));_gliffy.handleError("com.gliffy.error.stencil_load",[url],e,errorTarget)})},function(xhr,text,error){_gliffy.Logger.warn("failed to load stencils: "+JSON.stringify(shapes));_gliffy.handleError("com.gliffy.error.stencil_load",[url],error,errorTarget)})}else{promise=$.Deferred(function(defer){defer.resolve()}).promise()}return promise},loadShapes:function(shapeArray,errorTarget,language){var i,uid,url=this.rootServiceURL+"/shapes.json"+(language?"?locale="+language:""),self=this,shapes=[],stencils=[],promise;shapeArray=shapeArray||[];for(i=0;i<shapeArray.length;i++){uid=shapeArray[i];if(!self.shapes[uid]&&$.inArray(uid,shapes)===-1&&$.inArray(uid,IGNORED_SHAPE_UIDS)===-1){shapes.push(uid)}}if(shapes.length>0){promise=$.Deferred(function(defer){$.ajax({url:url,type:"POST",data:JSON.stringify(shapes),dataType:"json",contentType:"application/json; charset=utf-8",traditional:true}).then(defer.resolve,defer.fail)}).promise();promise.then(function(data,text,xhr){_gliffy.Utils.tryCatch(function(){var i,shape;for(i=0;i<data.length;i++){shape=data[i];self.shapes[shape.uid]=shape}},function(e){_gliffy.Logger.warn("failed to load shapes: "+JSON.stringify(shapes));_gliffy.handleError("com.gliffy.error.shape_load",[url],e,errorTarget)});return stencils},function(xhr,text,error){_gliffy.Logger.warn("failed to load shapes: "+JSON.stringify(shapes));_gliffy.handleError("com.gliffy.error.shape_load",[url],error,errorTarget)})}else{promise=$.Deferred(function(defer){defer.resolve()}).promise()}return promise},canDrawStencil:function(tid){return this.templates[tid]!==undefined},drawStencil:function(tid,ctx,data){if(this.canDrawStencil(tid)){this.templates[tid](ctx,data,STENCIL_DEPENDENCIES)}else{_gliffy.Logger.warn("Attempted to draw stencil "+tid+" but was not available")}},customFunction:function(tid,data){if(this.custom_function[tid]!==undefined&&this.custom_function[tid]!==null){this.custom_function[tid](data,STENCIL_DEPENDENCIES)}},__addStencil:function(stencil){var self=this;if(!self.templates[stencil.tid]){if(stencil.cfb){self.custom_function[stencil.tid]=new Function("data","_gliffy",stencil.cfb)}self.templates[stencil.tid]=new Function("ctx","data","_gliffy",stencil.template)}},getShape:function(uid){var self=this;if(self.shapes[uid]){return self.shapes[uid]}return null},addDefaultLibrary:function(uid){if(uid&&this.defaultLibraries.indexOf(uid)===-1){this.defaultLibraries.push(uid)}},EXISTING_SHAPE_UID_TO_LIBRARY_MAP:{"com.gliffy.shape.basic.basic_v1.default":["com.gliffy.libraries.basic.basic_v1.default"],"com.gliffy.shape.basic.basic_v2.default":["com.gliffy.libraries.basic.basic_v2.default"],"com.gliffy.shape.bpmn.bpmn_v1.activities":["com.gliffy.libraries.bpmn.bpmn_v1.events","com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts","com.gliffy.libraries.bpmn.bpmn_v1.activities","com.gliffy.libraries.bpmn.bpmn_v1.connectors","com.gliffy.libraries.bpmn.bpmn_v1.gateways"],"com.gliffy.shape.bpmn.bpmn_v1.connectors":["com.gliffy.libraries.bpmn.bpmn_v1.events","com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts","com.gliffy.libraries.bpmn.bpmn_v1.activities","com.gliffy.libraries.bpmn.bpmn_v1.connectors","com.gliffy.libraries.bpmn.bpmn_v1.gateways"],"com.gliffy.shape.bpmn.bpmn_v1.data_artifacts":["com.gliffy.libraries.bpmn.bpmn_v1.events","com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts","com.gliffy.libraries.bpmn.bpmn_v1.activities","com.gliffy.libraries.bpmn.bpmn_v1.connectors","com.gliffy.libraries.bpmn.bpmn_v1.gateways"],"com.gliffy.shape.bpmn.bpmn_v1.events":["com.gliffy.libraries.bpmn.bpmn_v1.events","com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts","com.gliffy.libraries.bpmn.bpmn_v1.activities","com.gliffy.libraries.bpmn.bpmn_v1.connectors","com.gliffy.libraries.bpmn.bpmn_v1.gateways"],"com.gliffy.shape.bpmn.bpmn_v1.gateways":["com.gliffy.libraries.bpmn.bpmn_v1.events","com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts","com.gliffy.libraries.bpmn.bpmn_v1.activities","com.gliffy.libraries.bpmn.bpmn_v1.connectors","com.gliffy.libraries.bpmn.bpmn_v1.gateways"],"com.gliffy.shape.erd.erd_v1.default":["com.gliffy.libraries.erd.erd_v1.default"],"com.gliffy.shape.floorplan.floorplan_v1.default":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.floorplan.floorplan_v2.structure":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.floorplan.floorplan_v2.bathroom":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.floorplan.floorplan_v2.bedroom":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.floorplan.floorplan_v2.dining_room":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.floorplan.floorplan_v2.kitchen":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.floorplan.floorplan_v2.living_room":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.floorplan.floorplan_v2.miscellaneous":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.floorplan.floorplan_v2.office":["com.gliffy.libraries.floorplan.floorplan_v2.structure","com.gliffy.libraries.floorplan.floorplan_v2.bathroom","com.gliffy.libraries.floorplan.floorplan_v2.bedroom","com.gliffy.libraries.floorplan.floorplan_v2.dining_room","com.gliffy.libraries.floorplan.floorplan_v2.kitchen","com.gliffy.libraries.floorplan.floorplan_v2.living_room","com.gliffy.libraries.floorplan.floorplan_v2.miscellaneous","com.gliffy.libraries.floorplan.floorplan_v2.office"],"com.gliffy.shape.flowchart.flowchart_v1.default":["com.gliffy.libraries.flowchart.flowchart_v1.default"],"com.gliffy.shape.flowchart.flowchart_v2.default":["com.gliffy.libraries.flowchart.flowchart_v2.default"],"com.gliffy.shape.network.network_v1.default":["com.gliffy.libraries.network.network_v3.business","com.gliffy.libraries.network.network_v3.home","com.gliffy.libraries.network.network_v3.rack"],"com.gliffy.shape.network.network_v2.business":["com.gliffy.libraries.network.network_v3.business"],"com.gliffy.shape.network.network_v2.home":["com.gliffy.libraries.network.network_v3.home"],"com.gliffy.shape.network.network_v2.rack":["com.gliffy.libraries.network.network_v3.rack"],"com.gliffy.shape.network.network_v3.business":["com.gliffy.libraries.network.network_v3.business"],"com.gliffy.shape.network.network_v3.home":["com.gliffy.libraries.network.network_v3.home"],"com.gliffy.shape.network.network_v3.rack":["com.gliffy.libraries.network.network_v3.rack"],"com.gliffy.shape.sitemap.sitemap_v1.default":["com.gliffy.libraries.sitemap.sitemap_v1.default"],"com.gliffy.shape.sitemap.sitemap_v2":["com.gliffy.libraries.sitemap.sitemap_v2"],"com.gliffy.shape.swimlanes.swimlanes_v1.default":["com.gliffy.libraries.swimlanes.swimlanes_v1.default"],"com.gliffy.shape.ui.ui_v1.default":["com.gliffy.libraries.ui.ui_v2.content","com.gliffy.libraries.ui.ui_v2.forms_components","com.gliffy.libraries.ui.ui_v2.miscellaneous"],"com.gliffy.shape.ui.ui_v2.content":["com.gliffy.libraries.ui.ui_v2.content","com.gliffy.libraries.ui.ui_v2.forms_components","com.gliffy.libraries.ui.ui_v2.miscellaneous"],"com.gliffy.shape.ui.ui_v2.forms_components":["com.gliffy.libraries.ui.ui_v2.content","com.gliffy.libraries.ui.ui_v2.forms_components","com.gliffy.libraries.ui.ui_v2.miscellaneous"],"com.gliffy.shape.ui.ui_v2.miscellaneous":["com.gliffy.libraries.ui.ui_v2.content","com.gliffy.libraries.ui.ui_v2.forms_components","com.gliffy.libraries.ui.ui_v2.miscellaneous"],"com.gliffy.shape.uml.uml_v1.default":["com.gliffy.libraries.uml.uml_v1.default","com.gliffy.libraries.uml.uml_v2.class","com.gliffy.libraries.uml.uml_v2.sequence","com.gliffy.libraries.uml.uml_v2.activity","com.gliffy.libraries.uml.uml_v2.state_machine","com.gliffy.libraries.uml.uml_v2.component","com.gliffy.libraries.uml.uml_v2.deployment","com.gliffy.libraries.uml.uml_v2.use_case"],"com.gliffy.shape.venn.flat.default":["com.gliffy.libraries.venn.flat.default"],"com.gliffy.shape.venn.outline.default":["com.gliffy.libraries.venn.outline.default"],"com.gliffy.shape.venn.radial.default":["com.gliffy.libraries.venn.radial.default"]}});_gliffy.shapeLibrary=new _gliffy.ShapeLibrary({rootServiceURL:"../api"})}());(function(){_gliffy.Serializable=_gliffy.Class.extend({toObject:function(){var serialized=this.__toObject();if(serialized){return $.extend(true,{},serialized)}else{return null}},fromObject:function(object,opt){this.__fromObject($.extend(true,{},object),opt);return this},__toObject:function(){throw new Error("__toObject is not implemented!")},__fromObject:function(object){throw new Error("__fromObject is not implemented!")}});_gliffy.Serializable.polymorphicToObject=function(instance){var object={type:instance.getClassName()};object[instance.getClassName()]=instance.toObject();return object};_gliffy.Serializable.polymorphicFromObject=function(object,node){var instance=new _gliffy[object.type]();instance.node=node;instance.fromObject(object[object.type]);return instance}}());(function(){_gliffy._Timer=_gliffy.Class.extend({_timers:null,_profileActive:false,init:function(){this._timers={}},start:function(name,shouldProfile){if(this._timers[name]!==undefined){_gliffy.Logger.log("Warning, overriding existing timer.")}this._timers[name]={startTime:(new Date()).getTime(),profile:shouldProfile===true};if(shouldProfile&&console&&console.profile){if(this._profileActive){_gliffy.Logger.log("Only one profile can be active at a time")}else{console.profile(name)}}},end:function(name){var timer=this._timers[name],timeMs=0;if(timer===undefined){_gliffy.Logger.log("Warning: timer does not exist: "+name)}else{timeMs=(new Date()).getTime()-timer.startTime;if(timer.profile&&console&&console.profile){console.profileEnd();this._profileActive=false}delete this._timers[name]}return timeMs},hasTimer:function(name){return this._timers[name]!==undefined}});_gliffy.Timer=new _gliffy._Timer()}());(function(){_gliffy.EmbeddedResource=_gliffy.Serializable.extend({id:null,mimeType:null,data:null,width:100,height:100,x:0,y:0,init:function(id,mimeType,data,x,y,width,height){this.id=id;this.mimeType=mimeType;this.data=data;this.x=x;this.y=y;this.width=width;this.height=height},getId:function(){return this.id},setId:function(id){this.id=id},setMimeType:function(mimeType){this.mimeType=mimeType},getMimeType:function(){return this.mimeType},setData:function(data){this.data=data},getData:function(){return this.data},getWidth:function(){return this.width},setWidth:function(width){this.width=width},getX:function(){return this.x},setX:function(x){this.x=x},getY:function(){return this.y},setY:function(y){this.y=y},getHeight:function(){return this.height},setHeight:function(height){this.height=height},__toObject:function(){return{id:this.getId(),mimeType:this.getMimeType(),data:this.getData(),x:this.getX(),y:this.getY(),width:this.getWidth(),height:this.getHeight()}},__fromObject:function(object){if(object.id!==undefined&&object.id!==null){this.setId(object.id)}if(object.mimeType!==undefined&&object.mimeType!==null){this.setMimeType(object.mimeType)}if(object.data!==undefined&&object.data!==null){this.setData(object.data)}if(object.x!==undefined&&object.x!==null){this.setX(object.x)}if(object.y!==undefined&&object.y!==null){this.setY(object.y)}if(object.width!==undefined&&object.width!==null){this.setWidth(object.width)}if(object.height!==undefined&&object.height!==null){this.setHeight(object.height)}return this}});_gliffy.EmbeddedResources=_gliffy.Serializable.extend({index:0,resources:null,_resourceMap:null,init:function(){this._resourceMap={}},getIndex:function(){return this.index},setIndex:function(index){this.index=index},add:function(mimeType,data,x,y,width,height){var resource,i;if(this.resources===null){this.resources=[]}resource=new _gliffy.EmbeddedResource(this.getIndex(),mimeType,data,x,y,width,height);for(i=0;i<this.resources.length;i++){if(this.resources[i].getData()===resource.getData()&&this.resources[i].getMimeType()===resource.getMimeType()){return this.resources[i]}}this.resources.push(resource);this._resourceMap[resource.getId()]=resource;this.index++;return resource},remove:function(resource){var index;if(this.resources!==null){index=$.inArray(resource,this.resources);if(index>=0){this.resources.splice(index,1);delete this._resourceMap[resource.getId()]}}},getResource:function(id){return this._resourceMap[id]},findExisitngResource:function(data,mimetype){var i;for(i=0;i<this.resources.length;i++){if(this.resources[i].getData()===data&&this.resources[i].getMimeType()===mimetype){return this.resources[i]}}return null},__toObject:function(){var i,resources=[],resource;for(i=0;this.resources&&i<this.resources.length;i++){resource=this.resources[i].toObject();resources.push(resource)}return{index:this.index,resources:resources}},__fromObject:function(object){var i,resource;if(object.index!==undefined&&object.index!==null){this.setIndex(object.index)}if(object.resources&&object.resources.length>0){this.resources=[];this._resourceMap={};for(i=0;i<object.resources.length;i++){resource=new _gliffy.EmbeddedResource();resource.fromObject(object.resources[i]);this.resources.push(resource);this._resourceMap[resource.getId()]=resource}}return this}})}());(function(){_gliffy.Graphic=_gliffy.Serializable.extend({_dirty:true,editable:null,init:function(){if(_gliffy.Editable){this.editable=_gliffy.Editable.getInstance(this)}},getTid:function(){throw new Error("getTid not implemented.")},markDirty:function(){this._dirty=true;if(this.node){this.node.markDirty();this.node.setFlag("skin")}},shouldBeDrawn:function(){if(this.node){return this.node.shouldBeDrawn()}return true},isDirty:function(){return this._dirty},hasParentOfType:function(type){return this.node&&this.node.parent&&this.node.parent.getGraphic() instanceof type},updateProperty:function(prop,value){if(this["set"+prop]!==undefined){this["set"+prop](value)}else{var msg="Property setter: set"+prop+" not found on graphic";throw new Error(msg)}},update:function(){throw new Error("update not implemented.")},applyStyle:function(style){throw new Error("applyStyle not implemented.")},getClassName:function(){throw new Error("getClassName not implemented.")},__toObject:function(){throw new Error("toObject not implemented.")},__fromObject:function(object){throw new Error("fromObject not implemented.")}})})();(function(){_gliffy.Editable=_gliffy.Serializable.extend({isEditable:false,__graphic:null,init:function(o){if(!o){throw new Error("editable init needs options")}if(!o.graphic){throw new Error("editable init options needs graphic")}this.__graphic=o.graphic},__toObject:function(){return{}},__fromObject:function(object){}});_gliffy.Editable.getInstance=function(graphic){var className="Editable"+graphic.getClassName();if(typeof _gliffy[className]==="function"){return new _gliffy[className]({graphic:graphic})}return new _gliffy.Editable({graphic:graphic})}})();(function(){_gliffy.AbstractGeometry=_gliffy.Graphic.extend({_strokeWidth:2,_strokeColor:"#000000",_dropShadow:true,_shadowX:5,_shadowY:5,_connections:null,_showConnections:false,svg:null,setStrokeWidth:function(strokeWidth){this._strokeWidth=strokeWidth;if(this.node){this.node.setFlag("bounds")}this.markDirty()},getStrokeWidth:function(){return this._strokeWidth},setStrokeColor:function(strokeColor){this._strokeColor=strokeColor;this.markDirty()},getStrokeColor:function(){return this._strokeColor},setDropShadow:function(dropShadow){this._dropShadow=dropShadow;if(dropShadow){this.setShadowX(4);this.setShadowY(4)}else{this.setShadowX(0);this.setShadowY(0)}if(this.node){this.node.setFlag("bounds");this.node.setFlag("skin")}this.markDirty()},isDropShadow:function(){return this._dropShadow},setShadowX:function(shadowX){this._shadowX=shadowX;this.markDirty()},getShadowX:function(){return this._shadowX},setShadowY:function(shadowY){this._shadowY=shadowY;this.markDirty()},getShadowY:function(){return this._shadowY},calculateShadowOffset:function(){if(this.isDropShadow()&&this.node){var shadow_x=this.getShadowX(),shadow_y=this.getShadowY(),rotation=this.node.getWorldRotation();var nx=0;var ny=0;var r=rotation%360;if(r<0){r+=360}if(r>=0&&r<=90){var rat1=0;if(r<45){rat1=r/45}else{rat1=(90-r)/45}var rat2=(45-r)/45;nx=shadow_x+shadow_x/3*rat1;ny=shadow_y*rat2}else{if(r>90&&r<=180){r=r-90;if(r<45){rat1=r/45}else{rat1=(90-r)/45}var rat2=(45-r)/45;nx=shadow_x*rat2;ny=-(shadow_y+shadow_y/3*rat1)}else{if(r>180&&r<=270){r=r-180;if(r<45){rat1=r/45}else{rat1=(90-r)/45}var rat2=(45-r)/45;nx=-(shadow_x+shadow_x/4*rat1);ny=-(shadow_y*rat2)}else{if(r<0){r=360+r}r=r-270;if(r<45){rat1=r/45}else{rat1=(90-r)/45}var rat2=(45-r)/45;nx=-(shadow_x*rat2);ny=shadow_y+shadow_y/3*rat1}}}return{x:nx,y:ny}}else{return{x:0,y:0}}}})}());(function(){var TID=null,OVERFLOW={name:"overflow",values:["left","none","right","both"],left:"left",right:"right",both:"both",none:"none"},VALIGN={name:"valign",values:["top","middle","bottom"],top:"top",middle:"middle",bottom:"bottom"},VPOSITION={name:"vposition",values:["above","none","below"],above:"above",none:"none",below:"below"},HPOSITION={name:"hposition",values:["left","none","right"],left:"left",none:"none",right:"right"},HORIZONTIAL_OFFSET_FIX=1;_gliffy.TextUtils={FONT_FIXES:{Arial:{normal:{9:1,10:1,11:1,12:2,13:2.5,14:2.5,18:2.5,24:3,36:5,48:5,64:8,72:8,96:10,110:12,127:16},bold:{9:1,10:1,11:1,12:2,13:2.5,14:2.5,18:2.5,24:3,36:5,48:5,64:8,72:8,96:10,110:12,127:16}},Verdana:{normal:{9:2.5,10:2.5,11:2.5,12:2.5,13:3.5,14:3.5,18:4,24:5,36:8,48:10,64:12,72:15,96:21,110:24,127:28},bold:{9:2.5,10:2.5,11:2.5,12:2.5,13:3.5,14:3.5,18:4,24:5,36:8,48:10,64:12,72:15,96:21,110:24,127:28}},Helvetica:{normal:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},bold:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}},Courier:{normal:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},bold:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}},Times:{normal:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},bold:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}},"Times New Roman":{normal:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},bold:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}}}};_gliffy.Text=_gliffy.Graphic.extend({style_default:{width:200,height:100,x:0,y:0,type:"fixed",rotate:0},node:null,_lines:null,_valign:VALIGN.middle,_overflow:OVERFLOW.none,_vposition:VPOSITION.none,_hposition:HPOSITION.none,_html:null,_hashCode:null,_lineTValue:null,_linePerpValue:null,_cardinalityType:null,ruler:null,__padding_top:2,__padding_left:2,__padding_bottom:2,__padding_right:2,__ie_height_offset:0,__ie_width_offset:3,__webkit_height_offset:1,__cachedResult:null,__cachedDomResult:null,__computePositioning:false,__calculatedWidth:null,__calculatedHeight:null,__domRuler:null,init:function(){this.__domRuler=$("<div/>",{style:"visibility:hidden;padding:0;margin:0;position:fixed;","class":"gliffy-ruler-text"});this.style=$.extend({},this.style_default);this._super()},update:function(){if(this.node&&this._dirty){if(!this.editable.isEditable||!this.editable.getEditMode()){this.style=$.extend({},this.style_default,{width:this.node.getWidth(),height:this.node.getHeight()});this.__textHandler();this.__cachedDomResult=this._html}this._dirty=false;return true}return false},markDirty:function(){this._dirty=true;if(this.node){this.node.markDirty()}},calculateWidth:function(){var width=0,recalcDimensions=this.node.isPartOfMultipartShape(),mapEntry;mapEntry=""+this.node.getId()+":"+this._hashCode;if(recalcDimensions||_gliffy.textDimensionMap.width[mapEntry]===undefined){if(!recalcDimensions&&++_gliffy.textDimensionMapSize.width>5000){_gliffy.textDimensionMap.width={};_gliffy.textDimensionMapSize.width=0}if(this.hasFixedWidth()){width=this.node.getWidth()}else{this.__domRuler.html(this._html).appendTo("body").css({width:""});width=this.__domRuler.width()}width=this.getOverflow()===OVERFLOW.none?width-this.getPaddingLeft()-this.getPaddingRight():width;if(recalcDimensions){return width}_gliffy.textDimensionMap.width[mapEntry]=width}return _gliffy.textDimensionMap.width[mapEntry]},calculateHeight:function(){var height,existingWidth,mapEntry;if(this.hasFixedWidth()){existingWidth=this.node.getWidth()-this.getPaddingLeft()-this.getPaddingRight();existingWidth=(Math.round(existingWidth*4)/4).toFixed(2)}else{existingWidth=-1}mapEntry=""+this.node.getId()+":"+this._hashCode+":"+existingWidth;if(_gliffy.textDimensionMap.height[mapEntry]===undefined){if(++_gliffy.textDimensionMapSize.height>5000){_gliffy.textDimensionMap.height={};_gliffy.textDimensionMapSize.height=0}this.__domRuler.appendTo("body").css({width:""}).html(this._html);if(this.hasFixedWidth()){this.__domRuler.css("width",Number(existingWidth)+"px")}else{this.__domRuler.css("width","")}height=this.__domRuler.height();this.__domRuler.css("width","").remove();_gliffy.textDimensionMap.height[mapEntry]=height}return _gliffy.textDimensionMap.height[mapEntry]},getCalculatedHeight:function(){return this.calculateHeight()},getCalculatedWidth:function(){return this.calculateWidth()},setupDefaults:function(textDefaults){var spanStyle="",pStyle="",css={},valid,newHTML,key;valid=textDefaults&&textDefaults.length!==0;if(valid){this.fromObject(textDefaults[0]);if(textDefaults[0].html!==undefined&&textDefaults[0].html!==null){this.setHTML(textDefaults[0].html,true)}}if(valid&&textDefaults[0].bold===true){css["font-weight"]="bold"}if(valid&&textDefaults[0].italic===true){css["font-style"]="italic"}if(valid&&textDefaults[0].underline===true){css["text-decoration"]="underline"}if(valid&&textDefaults[0].face){css["font-family"]=textDefaults[0].face}else{css["font-family"]="Arial"}if(valid&&textDefaults[0].size){css["font-size"]=textDefaults[0].size+"px"}else{css["font-size"]="12px"}if(valid&&textDefaults[0].color){css.color=textDefaults[0].color}for(key in css){if(css.hasOwnProperty(key)){spanStyle+=key+":"+css[key]+";"}}if(valid&&textDefaults[0].align){pStyle+="text-align: "+textDefaults[0].align+"; "}newHTML=this.getHTML()&&this.getHTML().length!==0?this.getHTML():'<span class="gliffy-placeholder-text"><br></span>';newHTML='<p style="'+pStyle+'"><span style="'+spanStyle+'">'+newHTML+"</span></p>";this.setHTML(newHTML)},__setupCardinalityValues:function(cardinality){var line=this.node.parent.getGraphic(),totalDistance=line.getPathLength().totalDistance,arrow=line[(cardinality==="begin")?"getStartArrow":"getEndArrow"](),curDistance=(arrow===0?15:25),slopeVec,slope;this.setLinePerpValue(15);if(cardinality==="end"){curDistance=totalDistance-curDistance}this.setLineTValue(curDistance/totalDistance);slopeVec=line.getSlopeAtDistance(curDistance);slope=Math.atan2(slopeVec.y,slopeVec.x);if(slope>-1.571&&slope<1.57){this.setLinePerpValue(-15)}},__textHandler:function(){var padding=2,height,width,linePoint,parent,offset,slope,hasMultipartParent=this.node.isPartOfMultipartShape();if(this.node.hasRedrawCanvasFlag()||this.__calculatedWidth===null||this.__calculatedHeight===null){this.__calculatedWidth=this.calculateWidth();this.__calculatedHeight=this.calculateHeight();parent=this.node.getUidNode();if(hasMultipartParent){this.node.setHeight(this.__calculatedHeight+this.getPaddingTop()+this.getPaddingBottom());this.node.setWidth(this.__calculatedWidth+this.getPaddingLeft()+this.getPaddingRight())}else{if((parent&&parent.isLine())||!this.hasFixedWidth()){this.node.setHeight(this.__calculatedHeight);this.node.setWidth(this.__calculatedWidth)}else{if(this.node.parent&&!this.node.parent.isGroup()){this.node.setHeight(this.__calculatedHeight)}else{if(this.node.getHeight()<this.__calculatedHeight){this.node.setHeight(this.__calculatedHeight)}}}}}if(this.node.isStandAloneText()||!this.node.parent){height=this.node.getHeight();width=this.node.getWidth()}else{height=this.node.parent.getHeight();width=this.node.parent.getWidth()}this.style.width=this.node.getWidth();this.style.height=this.node.getHeight();if(this.getOverflow()===OVERFLOW.none){this.style.width=this.node.getWidth()-this.getPaddingLeft()-this.getPaddingRight()}else{if(hasMultipartParent){this.style.height=this.node.getHeight()-this.getPaddingTop()-this.getPaddingBottom()}}this.style.x=this.getPaddingLeft();if(this.getValign()===VALIGN.top){this.style.y=this.getPaddingTop()}else{if(this.getValign()===VALIGN.middle){this.style.y=(height-this.style.height)/2}}if(this.getOverflow()===OVERFLOW.both){this.style.x=width/2-this.style.width/2-3}if(this.getVPosition()===VPOSITION.below){this.style.y=padding+height}else{if(this.getVPosition()===VPOSITION.above){this.style.y=-padding-this.style.height-4}}if(this.getHPosition()===HPOSITION.right){this.style.x+=padding+width}if(this.node.parent&&this.node.parent.isLine()){if(this.node.stage){this.style.text_background_fill=this.node.stage.background}var cardinality=this.getCardinality();if(cardinality!==null){this.__setupCardinalityValues(cardinality)}linePoint=this.node.parent.getGraphic().getPointAt(this.getLineTValue());offset=new _gliffy.Vec2(0,0);if(this.getLinePerpValue()!==0){slope=this.node.parent.getGraphic().getSlopeAtT(this.getLineTValue());offset=slope.rotate(Math.PI/2).scale(this.getLinePerpValue())}this.style.x=offset.x+linePoint.x-this.style.width/2;this.style.y=offset.y+linePoint.y-this.style.height/2}},getLines:function(){return this._lines},setLines:function(lines){this._lines=lines;this.markDirty()},getValign:function(){return this._valign},setValign:function(valign){this._valign=valign;this.markDirty()},setLineTValue:function(ratio){this._lineTValue=ratio;this.markDirty()},getLineTValue:function(){return(this._lineTValue!==null?this._lineTValue:0.5)},setLinePerpValue:function(px){this._linePerpValue=px},getLinePerpValue:function(){return(this._linePerpValue!==null?this._linePerpValue:0)},isCardinality:function(){return this._cardinalityType!==null},setCardinality:function(cardinalityType){this._cardinalityType=cardinalityType},getCardinality:function(){return this._cardinalityType},getOverflow:function(){return this._overflow},setOverflow:function(overflow){this._overflow=overflow;this.markDirty()},hasFixedWidth:function(){return !(this.getOverflow()===OVERFLOW.left||this.getOverflow()===OVERFLOW.right||this.getOverflow()===OVERFLOW.both)},getVPosition:function(){return this._vposition},setVPosition:function(vposition){this._vposition=vposition;this.markDirty()},__adjustHeightsAndColor:function(html){var textNode=$("<div/>").append($(html)),spans=textNode.find("span"),color,isBlack,renderedColor;spans.each(function(index){var span=$(this),font=span.css("font-family"),weight=span.css("font-weight"),size=parseFloat(span.css("font-size").replace("px","")),height,needsLineHeight=false;if(span[0].childNodes.length===0){needsLineHeight=true}for(var i=0;i<span[0].childNodes.length;i++){if(span[0].childNodes[i].nodeType===3||span[0].childNodes[i].tagName.toLowerCase()==="a"){needsLineHeight=true;break}}if(needsLineHeight){font=_gliffy.Utils.getRenderedStyle(span,"font-family");weight=_gliffy.Utils.getRenderedStyle(span,"font-weight");size=parseFloat(_gliffy.Utils.getRenderedStyle(span,"font-size").replace("px",""));font=font===""?"Arial":font;switch(weight){case"bold":case"700":weight="bold";break;case"":case"normal":case"400":weight="normal";break;default:weight="normal"}if(_gliffy.TextUtils.FONT_FIXES[font]===undefined){font="Arial"}if(_gliffy.TextUtils.FONT_FIXES[font][weight]===undefined){weight="normal"}if(isNaN(size)||_gliffy.TextUtils.FONT_FIXES[font][weight][size]===undefined){size=12}if($(this).html().length===0){$(this).html("&nbsp;")}height=size+_gliffy.TextUtils.FONT_FIXES[font][weight][size];$(this).css("line-height",height+"px")}else{$(this).css("line-height","")}if(!_gliffy.Utils.hasNonWhitespaceCharacter(span[0].textContent)){$(this).css("text-decoration","none")}isBlack=function(color){return color==="rgb(0, 0, 0)"||color==="black"||color==="#000000"||color==="#000"||color==="rgb(0,0,0)"};color=$(this).css("color");if(isBlack(color)){$(this).css("color","");renderedColor=_gliffy.Utils.getRenderedStyle($(this),"color");if(!isBlack(renderedColor)){$(this).css("color",color)}}});return textNode.html()},__validateAndFix:function(html){var $html=$("<div>"+html+"</div>");$html.contents().each(function(){if(this.nodeType===3&&_gliffy.Utils.hasNonWhitespaceCharacter(this.textContent)){$(this).wrap("<p />")}});$html.contents().each(function(){var $p=$(this);if($p.is("p")){if($p.attr("style")===null||$p.attr("style")===undefined||$p.attr("style").toLowerCase().indexOf("text-align")<0){$p.css("text-align","center")}$p.contents().each(function(){if(this.nodeType===3){$(this).wrap("<span />")}})}});$html.find("a").each(function(){var $this=$(this),spans;if($this.attr("target")===undefined||$this.attr("target")===null){$this.attr("target","_blank")}});return $html.html()},setHTML:function(html,raw){if(raw!==true){html=this.__validateAndFix(html);html=this.__adjustHeightsAndColor(html)}this._html=html;this._hashCode=_gliffy.Utils.hashCode(this._html);if(this.node){this.node.setFlag("bounds")}this.markDirty()},getHTML:function(){return this._html||""},setContentHTML:function(html){var junk=$("<div>"+this._html+"</div>");$(junk[0].firstChild.firstChild).html(html);this.setHTML($(junk).html(),true)},getHPosition:function(){return this._hposition},setHPosition:function(hposition){this._hposition=hposition;this.markDirty()},getTid:function(){return TID},getClassName:function(){return"Text"},getNodeText:function(){var el,span,text;el=document.createElement("div");el.innerHTML=this.getHTML();span=$("span",el);text=span[0].textContent;return text},setNodeText:function(text){var el,span,text;el=document.createElement("div");el.innerHTML=this.getHTML();span=$("span",el);span[0].textContent=text},isComputePositioning:function(){return this.__computePositioning},positionComputed:function(){this.__computePositioning=false},isStandalone:function(){return this.node&&this.node.isStandAloneText()},hasLineParent:function(){return this.hasParentOfType(_gliffy.Line)},setPaddingLeft:function(paddingLeft){this.__padding_left=paddingLeft},setPaddingRight:function(paddingRight){this.__padding_right=paddingRight},setPaddingTop:function(paddingTop){this.__padding_top=paddingTop},setPaddingBottom:function(paddingBottom){this.__padding_bottom=paddingBottom},getPaddingLeft:function(){return this.__padding_left},getPaddingRight:function(){return this.__padding_right},getPaddingTop:function(){return this.__padding_top},getPaddingBottom:function(){return this.__padding_bottom},__toObject:function(){var obj={tid:this.getTid(),valign:this.getValign(),overflow:this.getOverflow(),vposition:this.getVPosition(),hposition:this.getHPosition(),html:this.getHTML(),paddingLeft:this.getPaddingLeft(),paddingRight:this.getPaddingRight(),paddingBottom:this.getPaddingBottom(),paddingTop:this.getPaddingTop()};if(this._lineTValue!==null){obj.lineTValue=this.getLineTValue()}if(this._linePerpValue!==null){obj.linePerpValue=this.getLinePerpValue()}if(this._cardinalityType!==null){obj.cardinalityType=this.getCardinality()}return obj},__fromObject:function(object){if(object.valign!==undefined&&object.valign!==null){this.setValign(object.valign)}if(object.overflow!==undefined&&object.overflow!==null){this.setOverflow(object.overflow)}if(object.vposition!==undefined&&object.vposition!==null){this.setVPosition(object.vposition)}if(object.hposition!==undefined&&object.hposition!==null){this.setHPosition(object.hposition)}if(object.html!==undefined&&object.html!==null){this.setHTML(object.html)}if(object.paddingLeft!==undefined&&object.paddingLeft!==null){this.setPaddingLeft(object.paddingLeft)}if(object.paddingRight!==undefined&&object.paddingRight!==null){this.setPaddingRight(object.paddingRight)}if(object.paddingBottom!==undefined&&object.paddingBottom!==null){this.setPaddingBottom(object.paddingBottom)}if(object.paddingTop!==undefined&&object.paddingTop!==null){this.setPaddingTop(object.paddingTop)}if(object.linePerpValue!==undefined&&object.linePerpValue!==null){this.setLinePerpValue(object.linePerpValue)}if(object.lineTValue!==undefined&&object.lineTValue!==null){this.setLineTValue(object.lineTValue)}if(object.cardinalityType!==undefined&&object.cardinalityType!==null){this.setCardinality(object.cardinalityType)}this.__computePositioning=true;return this}})}());(function(){var DEFAULT_STYLE={gradient_x1:"0%",gradient_x2:"0%",gradient_y1:"100%",gradient_y2:"-50%",stop_color_2:"#FFFFFF",zoom:1,stroke_linejoin:"miter",rx:10,ry:10};_gliffy.Shape=_gliffy.AbstractGeometry.extend({_tid:null,_fillColor:"#aaaaaa",_gradient:false,_opacity:1,style:null,node:null,svg:null,_dirty:true,_state:0,_dancingAnts:false,init:function(){this.style=$.extend({},DEFAULT_STYLE)},setTid:function(tid){this._tid=tid;this.style=$.extend({},DEFAULT_STYLE);this.markDirty()},getTid:function(){return this._tid},setFillColor:function(fillColor){this._fillColor=fillColor;if(this._fillColor==="none"){this._gradient=false}this.markDirty()},getFillColor:function(){return this._fillColor},setDancingAnts:function(param){this._dancingAnts=param;this.markDirty()},getDancingAnts:function(){return this._dancingAnts},setGradient:function(gradient){this._gradient=this._fillColor!=="none"&&gradient;this.markDirty()},isGradient:function(){return this._gradient},setOpacity:function(opacity){this._opacity=opacity;this.markDirty()},getOpacity:function(){return this._opacity},getState:function(){return this._state},setState:function(s){this._state=s;this.markDirty()},update:function(){var width=0,height=0,i=0,states;if(this._dirty){if(this.node){this.style.width=this.node.getWidth();this.style.height=this.node.getHeight()}this.style.opacity=this.getOpacity();if(this._dancingAnts){this.style.dancing_ant_opacity=1}else{this.style.dancing_ant_opacity=0}this.style.stroke=this._strokeColor;this.style.gradient=this._gradient;if(this._fillColor!=="none"&&this.style.gradient){this.style.stop_multiply_color_2=_gliffy.ColorUtils.multiply(this._fillColor,"#AAAAAA")}this.style.stroke_dasharray="4,4";this.style.fill=this._fillColor;this.style.stop_color_1=this._fillColor;this.style.center_x=width/2;this.style.center_y=height/2;if(this.node){states=this.node.getShapeInformation().states;if(states){for(i=0;i<states;i++){this.style["state"+i]=false}this.style["state"+this._state]=true}else{if(this._state===1){this.style.state0=false;this.style.state1=true}}}this.calculateStrokeOffset();this._dirty=false;return true}return false},getClassName:function(){return"Shape"},calculateGradientCoordinates:function(){var coords,width,height,rotation;if(this.node){width=this.node.getWidth();height=this.node.getHeight();rotation=this.node.getRotation()%360;if(rotation>135&&rotation<=225){coords={x1:"50%",y1:"150%",x2:"50%",y2:"0%"}}else{if(rotation>45&&rotation<=135){coords={x1:"-50%",y1:"50%",x2:"100%",y2:"50%"}}else{if(rotation>225&&rotation<=315){coords={x1:"150%",y1:"50%",x2:"0%",y2:"50%"}}else{coords={x1:"50%",y1:"-50%",x2:"50%",y2:"100%"}}}}}return coords},calculateStrokeOffset:function(){var width,height,maxMiter,shadow_offset;if(this.node){width=this.node?this.node.getWidth():0;height=this.node?this.node.getHeight():0;this.style.stroke_width=this.getStrokeWidth();maxMiter=this.maxMiterLength();this.style.graphic_width=width+maxMiter+2+this.style.stroke_width;this.style.graphic_height=height+maxMiter+2+this.style.stroke_width;shadow_offset=this.calculateShadowOffset();this.style.shadow_x=shadow_offset.x;this.style.shadow_y=shadow_offset.y;this.style.graphic_width=this.style.shadow?Math.abs(this.style.shadow_x)+this.style.graphic_width:this.style.graphic_width;this.style.graphic_height=this.style.shadow?Math.abs(this.style.shadow_y)+this.style.graphic_height:this.style.graphic_height;this.style.graphic_x_offset=maxMiter/2+-1*Math.min(shadow_offset.x,0);this.style.graphic_y_offset=maxMiter/2+-1*Math.min(shadow_offset.y,0);this.style.line_offset_x=0;this.style.line_offset_y=0;this.style.stroke_offset=this.style.stroke_width/2;if(_gliffy.shapeLibrary){_gliffy.shapeLibrary.customFunction(this.getTid(),this.style)}this.style.offset_x=this.style.graphic_x_offset+this.style.stroke_offset;this.style.offset_y=this.style.graphic_y_offset+this.style.stroke_offset}},maxMiterLength:function(){var defaultCanvasMiterLimit=10;return defaultCanvasMiterLimit*this.style.stroke_width},__toObject:function(){return{tid:this.getTid(),strokeWidth:this.getStrokeWidth(),strokeColor:this.getStrokeColor(),fillColor:this.getFillColor(),gradient:this.isGradient(),dropShadow:this.isDropShadow(),state:this._state,shadowX:this.getShadowX(),shadowY:this.getShadowY(),opacity:this.getOpacity()}},applyStyle:function(style){var shadowSize;this.setGradient(style.gradient);this.setDropShadow(style.shadow);this.setFillColor(style.fill);if(style.strokeWidth!==undefined&&style.strokeWidth!==null&&style.strokeWidth!=="null"){this.setStrokeWidth(style.strokeWidth)}if(style.stroke){this.setStrokeColor(style.stroke)}},__fromObject:function(object){if(object.tid!==undefined){this.setTid(object.tid)}if(object.strokeWidth!==undefined){this.setStrokeWidth(object.strokeWidth)}if(object.strokeColor!==undefined){this.setStrokeColor(object.strokeColor)}if(object.fillColor!==undefined){this.setFillColor(object.fillColor)}if(object.gradient!==undefined){this.setGradient(object.gradient)}if(object.dropShadow!==undefined){this.setDropShadow(object.dropShadow)}if(object.shadowX!==undefined){this.setShadowX(object.shadowX)}if(object.shadowY!==undefined){this.setShadowY(object.shadowY)}if(object.opacity!==undefined){this.setOpacity(object.opacity)}if(object.state!==undefined){this._state=object.state}return this}})}());(function(){var DEFAULT_STYLE={zoom:1,stroke_linejoin:"miter"},TID="com.gliffy.stencil.custom.svg.static";_gliffy.Svg=_gliffy.AbstractGeometry.extend({_url:null,style:null,node:null,embeddedResourceId:null,_dirty:true,init:function(node){this.node=node;this.style=$.extend({},DEFAULT_STYLE)},markDirty:function(){this._dirty=true;if(this.node){this.node.markDirty()}},getTid:function(){return TID},getEmbeddedResourceId:function(){return this.embeddedResourceId},setEmbeddedResourceId:function(id){this.embeddedResourceId=id;this.markDirty();if(this.node){this.node.setFlag("skin")}},setShadowX:function(shadowX){this._shadowX=shadowX;this.markDirty()},getShadowX:function(){return this._shadowX},setShadowY:function(shadowY){this._shadowY=shadowY;this.markDirty()},getShadowY:function(){return this._shadowY},update:function(){if(this._dirty){var width=0,height=0,shadow_offset,maxMiter;if(this.node){width=this.node.getWidth();height=this.node.getHeight();this.style.width=width;this.style.height=height}this.style.center_x=width/2;this.style.center_y=height/2;this.style.graphic_width=(this.node)?this.node.getWidth():0;this.style.graphic_height=(this.node)?this.node.getHeight():0;this.style.stroke_width=10;maxMiter=this.maxMiterLength();this.style.graphic_width=width+maxMiter+2+this.style.stroke_width;this.style.graphic_height=height+maxMiter+2+this.style.stroke_width;shadow_offset=this.calculateShadowOffset();this.style.shadow_x=shadow_offset.x;this.style.shadow_y=shadow_offset.y;this.style.graphic_width=this.style.shadow?Math.abs(this.style.shadow_x)+this.style.graphic_width:this.style.graphic_width;this.style.graphic_height=this.style.shadow?Math.abs(this.style.shadow_y)+this.style.graphic_height:this.style.graphic_height;this.style.graphic_x_offset=maxMiter/2+-1*Math.min(shadow_offset.x,0);this.style.graphic_y_offset=maxMiter/2+-1*Math.min(shadow_offset.y,0);this.style.line_offset_x=0;this.style.line_offset_y=0;this.style.stroke_offset=this.style.stroke_width/2;this.style.offset_x=this.style.graphic_x_offset+this.style.stroke_offset;this.style.offset_y=this.style.graphic_y_offset+this.style.stroke_offset;this._dirty=false;return true}return false},maxMiterLength:function(){var defaultCanvasMiterLimit=10;return defaultCanvasMiterLimit*this.style.stroke_width},getClassName:function(){return"Svg"},__toObject:function(){return{embeddedResourceId:this.getEmbeddedResourceId(),strokeWidth:this.getStrokeWidth(),strokeColor:this.getStrokeColor(),dropShadow:this.isDropShadow(),shadowX:this.getShadowX(),shadowY:this.getShadowY()}},__fromObject:function(object){if(object.embeddedResourceId!==undefined){this.setEmbeddedResourceId(object.embeddedResourceId)}if(object.strokeWidth!==undefined){this.setStrokeWidth(object.strokeWidth)}if(object.strokeColor!==undefined){this.setStrokeColor(object.strokeColor)}if(object.dropShadow!==undefined){this.setDropShadow(object.dropShadow)}if(object.shadowX!==undefined){this.setShadowX(object.shadowX)}if(object.shadowY!==undefined){this.setShadowY(object.shadowY)}}})}());(function(){var DEFAULT_STYLE={text_background:true,text_background_fill:true,start_arrow:"none",end_arrow:"none",zoom:1,stroke_dasharray:null,stroke_linejoin:"miter"},TID="path",START_MARKER="start",END_MARKER="end",ARROW_SIZE=10,INTERPOLATION_TYPE={linear:0,quadratic:1},INTERPOLATION_LOOKUP={0:"linear",1:"quadratic"};_gliffy.Line=_gliffy.Graphic.extend({_strokeWidth:2,_strokeColor:"#000000",_fillColor:"none",_fillId:null,_dashStyle:null,_startArrow:null,_endArrow:null,_pointPath:null,_drawCommands:null,_centerLinePoint:null,_startArrowRotation:"auto",_endArrowRotation:"auto",_interpolationType:INTERPOLATION_TYPE.linear,_ortho:false,_length:0,_controlPath:null,style:null,node:null,aabb:null,_dirty:true,OVERLAY_EXTEND:7,OVERLAY_DISPLAY_EXTEND:5,LINE_TYPE_STRAIGHT:"straight",LINE_TYPE_ORTHO_RIGHT_ANGLE:"ortho-right-angle",LINE_TYPE_ORTHO_ROUNDED:"ortho-rounded",LINE_TYPE_QUADRATIC_BEZIER:"quad-bezier",_overlay:false,init:function(node,start,end){this.node=node;this.style=$.extend({},DEFAULT_STYLE);this.aabb=_gliffy.BoundingBox();if(start&&end){this._controlPath=[[start.x,start.y],[end.x,end.y]]}else{this._controlPath=[[0,0],[0,0]]}this._super()},getTid:function(){return TID},setStartArrow:function(startArrow){this._startArrow=startArrow;this.markDirty()},getStartArrowTid:function(){if(this._startArrow!==0&&this._startArrow!==null&&this._startArrow!==undefined&&this._startArrow!=="none"){return"com.gliffy.stencil.marker_start.v"+this._startArrow}return null},getEndArrowTid:function(){if(this._endArrow!==0&&this._endArrow!==null&&this._endArrow!==undefined&&this._endArrow!=="none"){return"com.gliffy.stencil.marker_end.v"+this._endArrow}return null},setStartArrowRotation:function(rotation){this._startArrowRotation=rotation;this.markDirty()},getStartArrowRotation:function(){return this._startArrowRotation},setEndArrowRotation:function(rotation){this._endArrowRotation=rotation;this.markDirty()},getEndArrowRotation:function(){return this._endArrowRotation},getStartArrow:function(){if(this._startArrow==="none"||this._startArrow===null||this._startArrow===undefined){this._startArrow=0}return this._startArrow},setEndArrow:function(endArrow){this._endArrow=endArrow;this.markDirty()},getEndArrow:function(){if(this._endArrow==="none"||this._endArrow===null||this._endArrow===undefined){this._endArrow=0}return this._endArrow},setStrokeWidth:function(strokeWidth){this._strokeWidth=strokeWidth;if(strokeWidth<3){this.setFillColor(null)}if(this.node){this.node.setFlag("bounds")}this.markDirty()},getStrokeWidth:function(){return this._strokeWidth},setStrokeColor:function(strokeColor){this._strokeColor=strokeColor;this.markDirty()},getStrokeColor:function(){return this._strokeColor},setFillColor:function(fillColor){this._fillColor=fillColor;if(this._fillColor===null){this._fillColor="none"}this.markDirty()},getFillColor:function(){return this._fillColor},getStartConnectionId:function(){var constraint;if(this.node){constraint=this.node.getConstraints().getStartConstraint();if(constraint){return constraint.nodeId}else{return null}}else{return null}},getEndConnectionId:function(){var constraint;if(this.node){constraint=this.node.getConstraints().getEndConstraint();if(constraint){return constraint.nodeId}else{return null}}else{return null}},setStartConnection:function(node,ratio){var worldStartPoint;if(node){if(!ratio){worldStartPoint=this.getWorldControlPoint(0);ratio=node.worldPointToRatio(worldStartPoint.x,worldStartPoint.y)}this.node.getConstraints().add(new _gliffy.StartPositionConstraint(node,ratio.x,ratio.y))}else{this.node.getConstraints().removeStartConstraint()}this.markDirty()},getStartConnection:function(){var startConnectionId=this.getStartConnectionId(),node;if(startConnectionId!==null&&this.node&&this.node.stage){node=this.node.stage.find(startConnectionId);if(node&&node.hasConnectionIndices()){return node}}return null},getStartConnectionRatio:function(){var constraint=this.node.getConstraints().getStartConstraint();if(constraint){return constraint.getRatio()}else{return null}},setEndConnection:function(node,ratio){var worldEndPoint;if(node){if(!ratio){worldEndPoint=this.getWorldControlPoint(this.getControlPointCount()-1);ratio=node.worldPointToRatio(worldEndPoint.x,worldEndPoint.y)}this.node.getConstraints().add(new _gliffy.EndPositionConstraint(node,ratio.x,ratio.y))}else{this.node.getConstraints().removeEndConstraint()}this.markDirty()},getEndConnectionRatio:function(){var constraint=this.node.getConstraints().getEndConstraint();if(constraint){return constraint.getRatio()}else{return null}},getEndConnection:function(){var endConnectionId=this.getEndConnectionId(),node;if(endConnectionId!==null&&this.node&&this.node.stage){node=this.node.stage.find(endConnectionId);if(node&&node.hasConnectionIndices()){return node}}return null},setDashStyle:function(dashStyle){this._dashStyle=dashStyle;this.markDirty()},setOverlay:function(overlay){this._overlay=overlay;this.markDirty()},getOverlay:function(){return this._overlay},getDashStyle:function(){return this._dashStyle},__getStrokePadding:function(){return Math.ceil(this.style.stroke_width+this.OVERLAY_EXTEND)/2},update:function(){if(this._dirty){var stage=null,background="#ffffff",width=0,height=0,padding,dashes,i;if(this.editable.isEditable&&this.node){this.editable.scaleControlPath(this.node.getScaleX(),this.node.getScaleY());this.editable.computeBestPath()}this._clearArrowMarkerAttributes(START_MARKER,this.style.start_arrow);this._clearArrowMarkerAttributes(END_MARKER,this.style.end_arrow);this.style.stroke=this._strokeColor;this.style.fill=this._fillColor;this.style.stroke_width=this.getStrokeWidth();if(this._dashStyle){dashes=this._dashStyle.split(",");for(i=0;i<dashes.length;i++){dashes[i]=parseFloat(dashes[i])*this.style.stroke_width}this.style.stroke_dasharray=dashes.join(",")}else{this.style.stroke_dasharray=null}this.style.start_arrow=this._startArrow||"none";this.style.end_arrow=this._endArrow||"none";this.style.start_arrow_tid=this.getStartArrowTid();this.style.end_arrow_tid=this.getEndArrowTid();this.aabb=this.getControlPathAabb(true);this.worldAabb=this.getWorldAabb(true);if(this.node){width=this.node.getWidth();height=this.node.getHeight();if(this.node.stage){stage=this.node.stage;background=stage.background}this.style.width=width;this.style.height=height}this.style.marker_fill=(background!=="transparent"?background:"#FFFFFF");this.style.center_x=width/2;this.style.center_y=height/2;this._drawCommands=this._generateDrawCommands();this._pointPath=this._generatePointPath();this._length=_gliffy.candash.getPathDistance(this._pointPath);if(this.editable.isEditable&&this.getInterpolationType()===INTERPOLATION_TYPE.quadratic){this.setStartArrowRotation(this.getQuadraticLineAngleAtStartPoint());this.setEndArrowRotation(this.getQuadraticLineAngleAtEndPoint())}else{this.setStartArrowRotation("auto");this.setEndArrowRotation("auto")}this.calculateStrokeOffset();this._dirty=false;return true}return false},calculateStrokeOffset:function(){if(this.node&&this.node.stage){var worldAabb,dimension;this.generateArrowMarkerAttributes(START_MARKER,this.style.start_arrow);this.generateArrowMarkerAttributes(END_MARKER,this.style.end_arrow);worldAabb=this.getWorldAabb();dimension=worldAabb.getDimension();this.style.width=dimension.x;this.style.height=dimension.y;this.style.stroke_offset=0;this.style.offset_x=this.node.worldTransform.getTranslateX()-worldAabb.min.x;this.style.offset_y=this.node.worldTransform.getTranslateY()-worldAabb.min.y;this.style.pos_x=this.node.worldTransform.getTranslateX();this.style.pos_y=this.node.worldTransform.getTranslateY();this.style.graphic_width=dimension.x;this.style.graphic_height=dimension.y}},maxMiterLength:function(){var defaultCanvasMiterLimit=10;return defaultCanvasMiterLimit*this.style.stroke_width},getClassName:function(){return"Line"},_clearArrowMarkerAttributes:function(arrowPos,arrowType){if(arrowType){delete this.style["marker_"+arrowPos+"_url"];delete this.style[arrowType+"_"+arrowPos];delete this.style["marker_"+arrowPos+"_width"];delete this.style["marker_"+arrowPos+"_height"];delete this.style["marker_"+arrowPos+"_viewbox"];delete this.style["marker_"+arrowPos+"_orient"];delete this.style["marker_"+arrowPos+"_clearx"];delete this.style["marker_"+arrowPos+"_cleary"];delete this.style["marker_"+arrowPos+"_refx"];delete this.style["marker_"+arrowPos+"_refy"]}},generateArrowMarkerAttributes:function(arrowPos,arrowType){this.style["marker_"+arrowPos+"_url"]=(arrowType!=="none")?"url(#"+arrowType+"_"+arrowPos+")":"none";this.style["marker_"+arrowPos+"_orient"]=(arrowPos==="start")?this.getStartArrowRotation():this.getEndArrowRotation();this.style[arrowType+"_"+arrowPos]=true;if(arrowType!=="none"){this.style["marker_"+arrowPos+"_viewbox"]="0 0 10 10";if(arrowType===1){this.style["marker_"+arrowPos+"_width"]=(this.style.stroke_width===1?20:10);this.style["marker_"+arrowPos+"_height"]=(this.style.stroke_width===1?20:10)}else{if(arrowType===2||arrowType===3){var w=22-4*this.style.stroke_width;var h=22-4*this.style.stroke_width;this.style["marker_"+arrowPos+"_width"]=Math.max(10,w);this.style["marker_"+arrowPos+"_height"]=Math.max(10,h)}else{if(arrowType===17){if(this.style.stroke_width<4){var w=30-5*this.style.stroke_width;var h=30-5*this.style.stroke_width;this.style["marker_"+arrowPos+"_width"]=Math.max(10,w);this.style["marker_"+arrowPos+"_height"]=Math.max(10,h)}else{this.style["marker_"+arrowPos+"_width"]=10+(10-this.style.stroke_width);this.style["marker_"+arrowPos+"_height"]=10+(10-this.style.stroke_width)}}else{this.style.marker_strokewidth=this.style.stroke_width;if(this.style.stroke_width===1){this.style.marker_viewbox_width=20;this.style.marker_viewbox_height=20;this.style["marker_"+arrowPos+"_width"]=20;this.style["marker_"+arrowPos+"_height"]=20;this.style.marker_start_refx=-1;this.style.marker_end_refx=15}else{this.style["marker_"+arrowPos+"_width"]=(this.style.stroke_width*10);this.style["marker_"+arrowPos+"_height"]=(this.style.stroke_width*10);this.style.marker_viewbox_width=(this.style.stroke_width*10);this.style.marker_viewbox_height=(this.style.stroke_width*10);this.style.marker_start_refx=-1*this.style.stroke_width;this.style.marker_end_refx=14+this.style.stroke_width}}}}if(arrowPos==="start"){if(arrowType===1){this.style.marker_start_cleary=3;this.style.marker_start_clearx=-2}else{if(arrowType===2){this.style.marker_start_cleary=4;this.style.marker_start_clearx=-2}else{if(arrowType===3){this.style.marker_start_cleary=4;this.style.marker_start_clearx=-2}else{if(arrowType===4){this.style.marker_start_cleary=5;this.style.marker_start_clearx=-12}else{if(arrowType===5){this.style.marker_start_cleary=5;this.style.marker_start_clearx=-12}else{if(arrowType===6){this.style.marker_start_cleary=5;this.style.marker_start_clearx=-12}else{if(arrowType===7){this.style.marker_start_cleary=4;this.style.marker_start_clearx=-10}else{if(arrowType===8){this.style.marker_start_cleary=0;this.style.marker_start_clearx=-10}else{if(arrowType===15){this.style.marker_start_cleary=1;this.style.marker_start_clearx=-12}else{if(arrowType===17){this.style.marker_start_cleary=0;this.style.marker_start_clearx=0}}}}}}}}}}}else{if(arrowType===1){this.style.marker_end_cleary=3;this.style.marker_end_clearx=9}else{if(arrowType===2){this.style.marker_end_cleary=4;this.style.marker_end_clearx=7}else{if(arrowType===3){this.style.marker_end_cleary=4;this.style.marker_end_clearx=7}else{if(arrowType===4){this.style.marker_end_cleary=5;this.style.marker_end_clearx=12}else{if(arrowType===5){this.style.marker_end_cleary=5;this.style.marker_end_clearx=12}else{if(arrowType===6){this.style.marker_end_cleary=5;this.style.marker_end_clearx=12}else{if(arrowType===7){this.style.marker_end_cleary=4;this.style.marker_end_clearx=10}else{if(arrowType===8){this.style.marker_end_cleary=0;if(this.style.stroke_width>3){this.style.marker_end_clearx=16}else{this.style.marker_end_clearx=13}}else{if(arrowType===15){this.style.marker_end_cleary=1;this.style.marker_end_clearx=15}else{if(arrowType===17){this.style.marker_end_cleary=0;this.style.marker_end_clearx=2}}}}}}}}}}}}},getControlPathAabb:function(excludeArrows){var boundingBox=_gliffy.BoundingBox.SMALLEST.clone(),controlPath=this.getControlPath(),strokePadding=this.__getStrokePadding(),i;for(i=0;i<controlPath.length;i++){boundingBox.grow(controlPath[i][0],controlPath[i][1])}boundingBox.extend(strokePadding);if(excludeArrows!==true){boundingBox.add(this.getStartArrowAabb());boundingBox.add(this.getEndArrowAabb())}return boundingBox},getWorldAabb:function(excludeArrows){var boundingBox=_gliffy.BoundingBox.SMALLEST.clone(),worldControlPath=this.getWorldControlPath(),i,strokePadding=this.__getStrokePadding();for(i=0;i<worldControlPath.length;i++){boundingBox.grow(worldControlPath[i][0],worldControlPath[i][1])}boundingBox.extend(strokePadding);if(excludeArrows!==true){boundingBox.add(this.getStartArrowWorldAabb());boundingBox.add(this.getEndArrowWorldAabb())}return boundingBox},getStartArrowWorldAabb:function(){var startPoint=this.getWorldControlPoint(0);if(this.style.start_arrow!=="none"){return this.__getArrowWorldAabb(startPoint)}else{return new _gliffy.BoundingBox(startPoint.x,startPoint.y,startPoint.x,startPoint.y)}},getEndArrowWorldAabb:function(){var endPoint=this.getWorldControlPoint(this.getControlPointCount()-1);if(this.style.end_arrow!=="none"){return this.__getArrowWorldAabb(endPoint)}else{return new _gliffy.BoundingBox(endPoint.x,endPoint.y,endPoint.x,endPoint.y)}},__getArrowWorldAabb:function(point){var boundingBox=new _gliffy.BoundingBox(point.x,point.y,point.x,point.y);boundingBox.extend(ARROW_SIZE+this.maxMiterLength());return boundingBox},getStartArrowAabb:function(){var startPoint=this.getControlPoint(0);if(this.style.start_arrow!=="none"){return this.__getArrowAabb(startPoint)}else{return new _gliffy.BoundingBox(startPoint.x,startPoint.y,startPoint.x,startPoint.y)}},getEndArrowAabb:function(){var endPoint=this.getControlPoint(this.getControlPointCount()-1);if(this.style.end_arrow!=="none"){return this.__getArrowAabb(endPoint)}else{return new _gliffy.BoundingBox(endPoint.x,endPoint.y,endPoint.x,endPoint.y)}},__getArrowAabb:function(point){var boundingBox=new _gliffy.BoundingBox(point.x,point.y,point.x,point.y);boundingBox.extend(ARROW_SIZE+this.maxMiterLength());return boundingBox},getControlPoint:function(index){return new _gliffy.Vec2(this._controlPath[index][0],this._controlPath[index][1])},getWorldControlPoint:function(index){var local=this.getControlPoint(index);if(this.node){return this.node.worldTransform.transformPoint(local.x,local.y)}},setControlPoint:function(index,point){if(this._controlPath){this._controlPath[index][0]=point.x;this._controlPath[index][1]=point.y}this.markDirty()},setWorldControlPoint:function(index,worldPoint){var local;if(this.node){local=this.node.worldTransform.createInverse().transformPoint(worldPoint.x,worldPoint.y)}else{local=worldPoint}this.setControlPoint(index,local)},getWorldControlPath:function(){if(this.node){return this.transformPath(this._controlPath,this.node.worldTransform)}else{return this.getControlPath()}},setWorldControlPath:function(worldControlPath){this.setControlPath(this.transformPath(worldControlPath,this.node.worldTransform.createInverse()))},getControlPath:function(){var path=[],i;for(i=0;i<this._controlPath.length;i++){path.push([this._controlPath[i][0],this._controlPath[i][1]])}return path},setControlPath:function(path){if(path){this._controlPath=path}else{this._controlPath=[[0,0],[0,0]]}},getControlPointCount:function(){return this._controlPath.length},getSegmentCount:function(){return this.getControlPointCount()-1},isSegmentHorizontal:function(index){return _gliffy.Utils.isHorizontal(this.getWorldControlPoint(index),this.getWorldControlPoint(index+1))},isLinearLine:function(){var i,numSegments=this.getSegmentCount(),horizontalCount=0,verticalCount=0;for(i=0;i<numSegments;i++){if(this.isSegmentHorizontal(i)){horizontalCount++}else{verticalCount++}}return((horizontalCount===numSegments)||(verticalCount===numSegments))},getNormalizedSegmentAngle:function(p1,p2){var x=0,y=1,dx=p2[x]-p1[x],dy=p2[y]-p1[y],rot=Math.atan(dy/dx)*180/Math.PI;if(p1[x]>p2[x]&&p1[y]<p2[y]){rot=180+rot}else{if(p2[x]<p1[x]&&p2[y]<=p1[y]){rot=180+rot}else{if(p2[x]>=p1[x]&&p2[y]<p1[y]){rot=360+rot}}}return rot},transformPath:function(path,transform){var i,controlPoint,result=[];for(i=0;i<path.length;i++){controlPoint=path[i];controlPoint=transform.transformPoint(controlPoint[0],controlPoint[1]);result.push([controlPoint.x,controlPoint.y])}return result},isOrtho:function(){return this._ortho},setOrtho:function(ortho){this._ortho=ortho;this.markDirty()},getInterpolationType:function(){return this._interpolationType},setInterpolationType:function(interpolationType){this._interpolationType=interpolationType;this.markDirty()},getCornerRadius:function(){return this._cornerRadius},setCornerRadius:function(cornerRadius){this._cornerRadius=cornerRadius;this.markDirty()},getPointAt:function(ratio){var linePoint;linePoint=_gliffy.candash.getPointInPathAtT(this._pointPath,ratio);linePoint=this.node.worldTransform.createInverse().transformPoint(linePoint.x,linePoint.y);return linePoint},getPointAtDistance:function(distance){var linePoint;linePoint=_gliffy.candash.getPointInPathAtDistance(this._pointPath,distance);linePoint=this.node.worldTransform.createInverse().transformPoint(linePoint.x,linePoint.y);return linePoint},getPathLength:function(){return this._length},getPointInPathAtT:function(ratio){return _gliffy.candash.getPointInPathAtT(this._pointPath,ratio)},getPointInPathAtDistance:function(distance){return _gliffy.candash.getPointInPathAtDistance(this._pointPath,distance,this._length)},getSlopeAtDistance:function(distance){var startDistance,endDistance;if(distance<3){startDistance=0;endDistance=4}else{if(distance>=this._length.totalDistance-2){startDistance=this._length.totalDistance-4;endDistance=this._length.totalDistance}else{startDistance=distance-2;endDistance=distance+2}}return _gliffy.Vec2.difference(this.getPointInPathAtDistance(endDistance),this.getPointInPathAtDistance(startDistance)).normalize()},getSlopeAtT:function(t){return this.getSlopeAtDistance(this._length.totalDistance*t)},getPointPath:function(){return this._pointPath},getDrawCommands:function(){return this._drawCommands},hasCardinality:function(type){var i=0,graphic;type=type||null;if(this.node.children){for(i=0;i<this.node.children.length;i++){graphic=this.node.children[i].getGraphic();if(type){if(graphic.getCardinality&&graphic.getCardinality()===type){return true}}else{if(graphic.isCardinality&&graphic.isCardinality()){return true}}}}return false},getQuadraticLineAngleAtStartPoint:function(){var a,b,c,angle,point=this.getPointInPathAtDistance(10);a=point.y-this._pointPath[0][0].y;b=point.x-this._pointPath[0][0].x;return this.__normalizeIncidenceAngle(Math.atan(a/b)*180/Math.PI,this.editable.getMagnitudeAndAxis("start"))},getQuadraticLineAngleAtEndPoint:function(){var a,b,c,angle,point=this.getPointInPathAtDistance(this.getPathLength().totalDistance-10);a=point.y-this._pointPath[this._pointPath.length-1][this._pointPath[this._pointPath.length-1].length-1].y;b=point.x-this._pointPath[this._pointPath.length-1][this._pointPath[this._pointPath.length-1].length-1].x;return this.__normalizeIncidenceAngle(Math.atan(a/b)*180/Math.PI,this.editable.getMagnitudeAndAxis("end"))},__normalizeIncidenceAngle:function(angle,magAxis){if(magAxis.axis==="y"){if(magAxis.mag===1&&angle<0){angle=angle+180}else{if(magAxis.mag===-1&&angle>0){angle=angle-180}}}else{if(magAxis.mag===-1&&magAxis.axis==="x"){angle=angle+180}}return angle},applyStyle:function(style){if(style.strokeWidth){this.setStrokeWidth(style.strokeWidth)}if(style.stroke){this.setStrokeColor(style.stroke)}this.setStartArrow(style.startArrow);this.setEndArrow(style.endArrow);if(!this._ortho){this.editable.setOrthoMode(_gliffy.Editor.ORTHO_MODE.straight)}else{if(style.orthoMode!==undefined&&style.orthoMode!==null){this.editable.setOrthoMode(style.orthoMode)}}if(style.fill&&this._strokeWidth>2){this.setFillColor(style.fill)}else{this.setFillColor(null)}if(style.dashStyle){this.setDashStyle(style.dashStyle)}},_generatePointPath:function(){var i,aPath=this._drawCommands,path=[];if(aPath===null||aPath===undefined){throw new Error("path is null")}for(i=0;i<aPath.length;i++){switch(aPath[i].name){case"M":var point=aPath[i].args.split(",");path.push([{x:parseFloat(point[0]),y:parseFloat(point[1])}]);break;case"L":var lastPoint=path[path.length-1][path[path.length-1].length-1];var point=aPath[i].args.split(",");path.push([lastPoint,{x:parseFloat(point[0]),y:parseFloat(point[1])}]);break;case"C":case"Q":var lastPoint=path[path.length-1][path[path.length-1].length-1];var currPath=[lastPoint];var points=aPath[i].args.split(" ");for(var j=0;j<points.length;j++){var p=points[j].split(",");currPath.push({x:parseFloat(p[0]),y:parseFloat(p[1])})}path.push(currPath);break;default:throw"We don't currently support "+aPath[i].name+" please add an implementation to candash.js"}}path.splice(0,1);return path},_generateDrawCommands:function(){if(this._controlPath.length>2&&this.getInterpolationType()===INTERPOLATION_TYPE.quadratic){return this._generateQuadratic(this.getWorldControlPath(),this.getCornerRadius())}else{return this._generateStraight(this.getWorldControlPath(),this.getCornerRadius())}},_generateStraight:function(controlPath,cornerRadius){var i,path=[],cur,next,offset0,offset0Mag,l,q1,q1Mag,prev;if(cornerRadius===null||cornerRadius===0||controlPath.length<3){for(i=0;i<controlPath.length;i++){path.push({name:(i===0?"M":"L"),args:this._controlPointToString(controlPath[i])})}}else{path.push({name:"M",args:this._controlPointToString(controlPath[0])});for(i=1;i<controlPath.length-1;i++){cur=new _gliffy.Vec2(controlPath[i][0],controlPath[i][1]);prev=new _gliffy.Vec2(controlPath[i-1][0],controlPath[i-1][1]);next=new _gliffy.Vec2(controlPath[i+1][0],controlPath[i+1][1]);offset0=cur.clone().subtract(prev);offset0Mag=offset0.magnitude();if(offset0Mag>cornerRadius*2){offset0.normalize().scale(cornerRadius)}else{offset0.safeNormalize().scale(offset0Mag/2)}l=cur.clone().subtract(offset0);q1=next.clone().subtract(cur);q1Mag=q1.magnitude();if(q1Mag>=cornerRadius*2){q1.normalize().scale(cornerRadius)}else{q1.safeNormalize().scale(q1Mag/2)}q1.add(cur);path.push({name:("L"),args:this._vec2ToString(l)});path.push({name:("Q"),args:this._vec2ToString(cur)+" "+this._vec2ToString(q1)})}path.push({name:"L",args:this._controlPointToString(controlPath[controlPath.length-1])})}return path},_generateQuadratic:function(controlPath,cornerRadius){if(controlPath.length<3){throw new Error("curved lines must have at least 3 points")}var len=controlPath.length,midPath,i,path;midPath=[controlPath[0]];for(i=1;i<len-2;i++){midPath.push(controlPath[i]);midPath.push([(controlPath[i][0]+controlPath[i+1][0])/2,(controlPath[i][1]+controlPath[i+1][1])/2])}midPath.push(controlPath[len-2]);midPath.push(controlPath[len-1]);path=[];path.push({name:"M",args:this._controlPointToString(midPath[0])});for(i=1;i<midPath.length-1;i+=2){path.push({name:"Q",args:this._controlPointToString(midPath[i])+" "+this._controlPointToString(midPath[i+1])})}return path},_controlPointToString:function(controlPoint){return(controlPoint[0])+","+(controlPoint[1])},_vec2ToString:function(vec2,offset){return(vec2.x)+","+(vec2.y)},__toObject:function(){this.update();return $.extend({strokeWidth:this.getStrokeWidth(),strokeColor:this.getStrokeColor(),fillColor:this.getFillColor(),dashStyle:this.getDashStyle(),startArrow:this.getStartArrow(),endArrow:this.getEndArrow(),startArrowRotation:this.getStartArrowRotation(),endArrowRotation:this.getEndArrowRotation(),ortho:this._ortho,interpolationType:INTERPOLATION_LOOKUP[this._interpolationType],cornerRadius:this._cornerRadius,controlPath:this._controlPath},this.editable.toObject())},__fromObject:function(object){if(object.strokeWidth!==undefined){this.setStrokeWidth(object.strokeWidth)}if(object.strokeColor!==undefined){this.setStrokeColor(object.strokeColor)}if(object.dashStyle!==undefined){this.setDashStyle(object.dashStyle)}if(object.startArrow!==undefined){this.setStartArrow(object.startArrow)}if(object.endArrow!==undefined){this.setEndArrow(object.endArrow)}if(object.startArrowRotation!==undefined){this.setStartArrowRotation(object.startArrowRotation)}if(object.endArrowRotation!==undefined){this.setEndArrowRotation(object.endArrowRotation)}if(object.fillColor!==undefined){this.setFillColor(object.fillColor)}if(object.interpolationType!==undefined){this._interpolationType=INTERPOLATION_TYPE[object.interpolationType]||INTERPOLATION_TYPE.linear}if(object.cornerRadius!==undefined){this._cornerRadius=object.cornerRadius}if(object.ortho!==undefined){this._ortho=object.ortho}if(object.controlPath!==undefined){this._controlPath=object.controlPath}if(this.editable.isEditable){this.editable.fromObject(object)}return this}});_gliffy.Line.INTERPOLATION_TYPE=INTERPOLATION_TYPE}());(function(){var DEFAULT_STYLE={zoom:1,stroke_linejoin:"miter"},TID="com.gliffy.shapes.image",CONNECTION_PT_PATTERN=["Midpoint","Octagon","Center"];_gliffy.Image=_gliffy.AbstractGeometry.extend({_url:null,style:null,node:null,svg:null,imgWidth:null,imgHeight:null,useOriginalDimensions:false,_dirty:true,init:function(node){this.node=node;this.style=$.extend({},DEFAULT_STYLE)},markDirty:function(){this._dirty=true;if(this.node){this.node.markDirty()}},setImgWidth:function(width){this.imgWidth=width},getImgWidth:function(){return this.imgWidth},setImgHeight:function(height){this.imgHeight=height},getImgHeight:function(){return this.imgHeight},resizeToOriginalDimensions:function(){this.useOriginalDimensions=true;this.markDirty();if(this.node){this.node.setFlag("skin")}},getTid:function(){return TID},setUrl:function(url){this._url=url;this.markDirty();if(this.node){this.node.setFlag("skin")}},getUrl:function(){return this._url},setShadowX:function(shadowX){this._shadowX=shadowX;this.markDirty()},getShadowX:function(){return this._shadowX},setShadowY:function(shadowY){this._shadowY=shadowY;this.markDirty()},getShadowY:function(){return this._shadowY},update:function(){if(this._dirty){var stage=null,width=0,height=0,shadow_offset;if(this.node){stage=this.node.stage;width=this.node.getWidth();height=this.node.getHeight();this.style.width=width;this.style.height=height}this.style.center_x=width/2;this.style.center_y=height/2;this.style.graphic_width=(this.node)?this.node.getWidth():0;this.style.graphic_height=(this.node)?this.node.getHeight():0;shadow_offset=this.calculateShadowOffset();this.style.shadow_x=shadow_offset.x;this.style.shadow_y=shadow_offset.y;this.style.graphic_width=this._dropShadow?Math.abs(this.style.shadow_x)+this.style.graphic_width:this.style.graphic_width;this.style.graphic_height=this._dropShadow?Math.abs(this.style.shadow_y)+this.style.graphic_height:this.style.graphic_height;this.style.graphic_x_offset=-1*Math.min(shadow_offset.x,0);this.style.graphic_y_offset=-1*Math.min(shadow_offset.y,0);this.style.line_offset_x=0;this.style.line_offset_y=0;this.style.stroke_offset=0;this.style.offset_x=this.style.graphic_x_offset+this.style.stroke_offset;this.style.offset_y=this.style.graphic_y_offset+this.style.stroke_offset;this._dirty=false;return true}return false},getClassName:function(){return"Image"},__toObject:function(){return{url:this.getUrl(),strokeWidth:this.getStrokeWidth(),strokeColor:this.getStrokeColor(),dropShadow:this.isDropShadow(),shadowX:this.getShadowX(),shadowY:this.getShadowY()}},__fromObject:function(object){if(object.url!==undefined){this.setUrl(object.url)}if(object.strokeWidth!==undefined){this.setStrokeWidth(object.strokeWidth)}if(object.strokeColor!==undefined){this.setStrokeColor(object.strokeColor)}if(object.dropShadow!==undefined){this.setDropShadow(object.dropShadow)}if(object.shadowX!==undefined){this.setShadowX(object.shadowX)}if(object.shadowY!==undefined){this.setShadowY(object.shadowY)}}})}());(function(){var FLAGS=["bounds","skin","position","guide"];_gliffy.Node=_gliffy.Serializable.extend({_id:null,_x:0,_y:0,_rotation:0,_width:100,_height:100,_lockAspectRatio:false,_lockPosition:false,_scaleX:1,_scaleY:1,_order:null,worldTransform:null,_graphic:null,_domId:null,_uid:null,stage:null,children:null,parent:null,_dirty:true,_serialize:true,_dirty_flags:null,_current_bounds:null,_aspectRatio:null,_parentDirty:false,_activeGuides:null,_constraints:null,_selectable:true,aabb:null,worldAabb:null,overlayAabb:null,worldOverlayAabb:null,__defaultTextGraphic:null,__editTextOnInit:true,init:function(stage,parent){this.stage=stage||null;this.parent=parent||null;this.worldTransform=new _gliffy.AffineTransform(1,0,0,1,0,0);this.worldAabb=new _gliffy.BoundingBox();this.aabb=new _gliffy.BoundingBox();this.overlayAabb=new _gliffy.BoundingBox();this.worldOverlayAabb=new _gliffy.BoundingBox();this._connections=null;if(_gliffy.Constraints){this._constraints=new _gliffy.Constraints(this)}this.hideGuides();this.resetFlags()},notify:function(){if(!isNaN(parseInt(this.getId(),10))){$(window).trigger("gliffy-node-update-"+this.getId(),[this.getId()])}},notifyRemove:function(){if(!isNaN(parseInt(this.getId(),10))){$(window).trigger("gliffy-node-remove-"+this.getId(),[this.getId()])}},getId:function(){return this._id},setId:function(id){if(this.stage){if(id==="auto"){this._id=this.stage._node_index;if(this._order==="undefined"||this._order===null){this.setOrder(this.stage._node_index)}this.stage._node_index++}else{if(isNaN(parseInt(id,10))){throw new Error("node id is not a number:"+id)}this._id=id}this.stage._node_map[this._id]=this;this._domId="gliffy_node_"+this._id}else{this._id=id}},setUid:function(uid){this._uid=uid},getUid:function(){return this._uid},getDomElement:function(){if(this._domId){return $("#"+this._domId)}return null},getDomElements:function(){var selector=["#"+this._domId],children=this.flattenChildren(),i;for(i=0;i<children.length;i++){selector=selector.concat(["#"+children[i]._domId])}return $(selector.join(","))},getDomViewbox:function(){if(this._domId){return $("#"+this._domId+"viewbox")}return null},setOrder:function(order){if(order!==this._order){this._order=order;this.setFlag("position");this._markDirty()}},getOrder:function(){if(this._order==="auto"){return(this.parent)?this.parent.getOrder():0}else{return this._order}},setX:function(x){if(x!==this._x&&x!==undefined&&x!==null){this._x=x;this.setFlag("position");this._markDirty()}},getX:function(){return this._x},setY:function(y){if(y!==this._y&&y!==undefined&&y!==null){this._y=y;this.setFlag("position");this._markDirty()}},getY:function(){return this._y},__clampWidth:function(width){},__clampHeight:function(height){var ratio=this.getWidth()/this.getHeight();if(height<this.getHeight()){this.setHeight(height);this.setWidth(this.getHeight()*ratio)}},clampTo:function(boundingBox){var dimension=boundingBox.getDimension(),ratio;ratio=this.getHeight()/this.getWidth();if(dimension.x<this.getWidth()){this.setWidth(dimension.x);this.setHeight(this.getWidth()*ratio)}ratio=this.getWidth()/this.getHeight();if(dimension.y<this.getHeight()){this.setHeight(dimension.y);this.setWidth(this.getHeight()*ratio)}},getPosition:function(){return new _gliffy.Vec2(this._x,this._y)},getRotateOffsetX:function(){return this.getWidth()/2},getRotateOffsetY:function(){return this.getHeight()/2},getCenterPosition:function(){return new _gliffy.Vec2(this._x+this._width/2,this._y+this._height/2)},setRotation:function(rotation){rotation=_gliffy.Utils.wrapDegrees(rotation);if(rotation!==this._rotation){this._rotation=rotation;this.setFlag("position");this._markDirty();var graphic=this.getGraphic();if(graphic&&graphic.isDropShadow&&graphic.isDropShadow()){this.setFlag("skin")}}},supportsConstraints:function(){return _gliffy.Constraints&&this._constraints},subscribeAllConstraints:function(){var i;if(this.hasConstraints()){this.getConstraints().subscribeAll()}for(i=0;this.children&&i<this.children.length;i++){this.children[i].subscribeAllConstraints()}},hasConstraints:function(){return this.supportsConstraints()&&this._constraints.hasConstraints()},getConstraints:function(){return this._constraints},setConstraints:function(constraints){if(_gliffy.Constraints){if(this._constraints){this._constraints.unsubscribeAll()}this._constraints=constraints;this._constraints.subscribeAll()}},getRotation:function(){return _gliffy.Utils.wrapDegrees(this._rotation)},getWorldRotation:function(){var current=this,totalRotation=0;while(current){totalRotation+=current.getRotation();current=current.parent}return totalRotation},setWidth:function(width){if(width!==this._width){this._width=Math.min(Math.max(width,1),5000);this._markDirty();this.setFlag("bounds")}},getWidth:function(){return Math.min(Math.max(this._width,1),5000)},setHeight:function(height){if(height!==this._height){this._height=Math.min(Math.max(height,1),5000);this._dirty_flags.bounds=true;this.setFlag("bounds");this._markDirty()}},getHeight:function(){return Math.min(Math.max(this._height,1),5000)},setScaleXNoRatio:function(scaleX){if(scaleX!==this._scaleX){this._scaleX=scaleX;this.setFlag("bounds");this._markDirty()}},setScaleYNoRatio:function(scaleY){if(scaleY!==this._scaleY){this._scaleY=scaleY;this.setFlag("bounds");this._markDirty()}},setScaleX:function(scaleX){if(scaleX!==this._scaleX&&!isNaN(scaleX)){this._scaleX=scaleX;if(this._lockAspectRatio){this._scaleY=scaleX}this.setFlag("bounds");this._markDirty()}},setScaleY:function(scaleY){if(scaleY!==this._scaleY&&!isNaN(scaleY)){this._scaleY=scaleY;if(this._lockAspectRatio){this._scaleX=scaleY}this.setFlag("bounds");this._markDirty()}},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},_applyScale:function(){var i,child;if(this._scaleX!==1||this._scaleY!==1){this.setWidth(this.getWidth()*this._scaleX);this.setHeight(this.getHeight()*this._scaleY);if(this.children){for(i=0;i<this.children.length;i++){child=this.children[i];if((!child.isTextChild())||child.getGraphic().getOverflow()==="none"){if(!child.hasConstraints()||child.getConstraints().parentCanScaleWidth()){child.setX(child.getX()*this._scaleX);child.setScaleXNoRatio(this._scaleX)}if(!child.hasConstraints()||child.getConstraints().parentCanScaleHeight()){child.setY(child.getY()*this._scaleY);child.setScaleYNoRatio(this._scaleY)}}}}}},getAspectRatio:function(){if(this.getLockAspectRatio()){if(this._aspectRatio===null){this._aspectRatio=this._width/this._height}return this._aspectRatio}else{return this._width/this._height}},getLockAspectRatio:function(){return this._lockAspectRatio},setLockAspectRatio:function(lockAspectRatio){this._lockAspectRatio=lockAspectRatio;if(!this._lockAspectRatio){this._aspectRatio=null}},getLockPosition:function(){return this._lockPosition},setLockPosition:function(lockPosition){this._lockPosition=lockPosition},getDefaultTextGraphic:function(){return this.__defaultTextGraphic},setDefaultTextGraphic:function(defaultTextGraphic){this.__defaultTextGraphic=defaultTextGraphic},isEditTextOnInit:function(){return this.__editTextOnInit},setEditTextOnInit:function(b){this.__editTextOnInit=b},getMinDimensions:function(){var minWidth=15,minHeight=15;if(this.getShapeInformation().minWidth){minWidth=this.getShapeInformation().minWidth}if(this.getShapeInformation().minHeight){minHeight=this.getShapeInformation().minHeight}return{x:minWidth,y:minHeight}},setGraphic:function(graphic){if(this._graphic){this._graphic.node=null}this._graphic=graphic;if(this._graphic){this._graphic.node=this;if(this.getUid()===null){if(this._graphic instanceof _gliffy.Line){this.setUid("com.gliffy.shape.basic.basic_v1.default.line")}}this._graphic.markDirty()}else{if(this.stage){this.stage.removeDomNode(this)}}return this},getGraphic:function(){return this._graphic},updateProperty:function(prop,value){var graphic,props={};props[prop]=value;if(this.stage){this.stage.commandHistory.addAndExecuteCommand(new _gliffy.ModifyNodeCommand({node:this,props:props}))}else{graphic=this.getGraphic();if(this["set"+prop]!==undefined){this["set"+prop](value)}else{graphic=this.getGraphic();if(graphic){graphic.updateProperty(prop,value)}}}},getChildrenAabb:function(includeSelf){var i,child,aabb=(includeSelf===true)?this.aabb.clone():_gliffy.BoundingBox.SMALLEST.clone(),childTransform,graphic,offsetY;for(i=0;this.children&&i<this.children.length;i++){child=this.children[i];childTransform=child.getLocalTransform();if(child.getGraphic() instanceof _gliffy.Text){graphic=child.getGraphic();offsetY=(graphic.getValign()==="middle")?(child.getHeight()/2)-(graphic.getCalculatedHeight()/2):0;childTransform=childTransform.clone().translate(child.getGraphic().style.x,child.getGraphic().style.y+offsetY)}aabb.add(child.getChildrenAabb(true).transform(childTransform))}return aabb},getChildrenWorldAabb:function(includeSelf){var i,child,aabb;if(includeSelf===true){if(this.getGraphic() instanceof _gliffy.Text){aabb=new _gliffy.BoundingBox(0,0,this.getGraphic().getCalculatedWidth(),this.getGraphic().getCalculatedHeight());aabb.transform(this.__getTextWordTransform())}else{aabb=this.worldAabb.clone()}}else{if(this.children.length>0){aabb=_gliffy.BoundingBox.SMALLEST.clone()}else{aabb=new _gliffy.BoundingBox()}}for(i=0;this.children&&i<this.children.length;i++){child=this.children[i];aabb.add(child.getChildrenWorldAabb(true))}return aabb},getLocalTransform:function(){var local=new _gliffy.AffineTransform(1,0,0,1,0,0);local.translate(this._x,this._y).rotate(this._rotation*(Math.PI/180),this.getRotateOffsetX(),this.getRotateOffsetY());return local},updateWorldTransform:function(){this.worldTransform=(this.parent)?this.parent.worldTransform.clone():new _gliffy.AffineTransform(1,0,0,1,0,0);this.worldTransform.translate(this._x,this._y).rotate(this._rotation*(Math.PI/180),this.getRotateOffsetX(),this.getRotateOffsetY())},update:function(){var self=this;_gliffy.Utils.tryCatch(function(){if(self._dirty){if(self.stage&&(self._dirty_flags.bounds||self._dirty_flags.position)&&_gliffy.Tree){_gliffy.Tree.remove(self)}self._applyScale();var i,child,grow=false,updateChildren;if(self.stage&&self.hasConstraints()){self.getConstraints().executeConstraints()}if(self.stage&&self.getGraphic() instanceof _gliffy.Text){if(self.parent===null||self.parent.isGroup()||self.parent.isSelection()){if(self.getUid()===null){self.setUid("com.gliffy.shape.basic.basic_v1.default.text")}}else{if(self.getUid()!==null){self.setUid(null)}}}self.updateWorldTransform();if(self._graphic){self._graphic.update();if(self._graphic.aabb){self.aabb.copy(self._graphic.aabb)}else{self.aabb.setMinMax(0,0,0,0);self.aabb.grow(self.getWidth(),self.getHeight())}if(self._graphic.worldAabb){self.worldAabb.copy(self._graphic.worldAabb)}else{if(self.getGraphic() instanceof _gliffy.Text){self.worldAabb.copy(self.aabb).transform(self.__getTextWordTransform())}else{self.worldAabb.copy(self.aabb).transform(self.worldTransform)}}self.overlayAabb.copy(self.aabb)}else{self.aabb.setMinMax(0,0,0,0);self.aabb.grow(self.getWidth(),self.getHeight());grow=true}if(self.children){updateChildren=(self._dirty_flags.bounds||self._dirty_flags.position);for(i=0;i<self.children.length;i++){child=self.children[i];if(updateChildren){if(self._dirty_flags.bounds){child.setFlag("bounds")}if(self._dirty_flags.position){child.setFlag("position")}child._markDirty();child._parentDirty=true}child.update();if(child.worldAabb){if(grow){if(self.isGroup()||self.isMultipartShape()){self.overlayAabb.copy(child.overlayAabb).transform(child.getLocalTransform())}self.worldAabb.copy(child.worldAabb);grow=false}else{if(self.isGroup()||self.isMultipartShape()){self.overlayAabb.add(child.overlayAabb.clone().transform(child.getLocalTransform()))}self.worldAabb.add(child.worldAabb)}}}}self.worldOverlayAabb.copy(self.overlayAabb).transform(self.worldTransform);if(self.stage&&(self._dirty_flags.bounds||self._dirty_flags.position)&&_gliffy.Tree){_gliffy.Tree.add(self)}self.setScaleX(1);self.setScaleY(1);self._dirty=false}self._parentDirty=false},function(e){_gliffy.Logger.error("Node "+self.getId()+" failed to update in node.js");if(self.stage){self.stage.removeNode(self)}_gliffy.handleError("com.gliffy.error.fatal_error",[],e)})},getBoundsOffset:function(){var worldPos=this.getWorldPosition();return _gliffy.Vec2.difference(worldPos,this.worldAabb.min)},getWorldPosition:function(){if(this.parent){return this.parent.worldTransform.transformPoint(this._x,this._y)}else{return{x:this._x,y:this._y}}},markDirty:function(){this._dirty=true;if(this.stage&&!isNaN(parseInt(this.getId(),10))&&this.stage.find(this.getId())===this){this.stage.addDirtyNode(this)}},_markDirty:function(){if(this.getGraphic()){this.getGraphic().markDirty()}else{this.markDirty()}},shouldBeDrawn:function(){if(this.stage&&!isNaN(parseInt(this.getId(),10))){return this.stage.dirty[this.getId()]===this.getId()}return true},isDirty:function(){return this._dirty},isAChildOf:function(n){if(this.parent===n){return true}else{if(this.parent===null){return false}else{this.parent.isAChildOf(n)}}},getRootParent:function(){var n=this;while(n.parent){n=n.parent}return n},setSerializable:function(serializable){this._serialize=serializable},toObjectNoGraphic:function(){return $.extend(true,{},this.__toObject(true))},__toObject:function(noGraphic){if(this._serialize){var i,object={x:this.getX(),y:this.getY(),rotation:this.getRotation(),id:this.getId(),uid:this.getUid(),width:this.getWidth(),height:this.getHeight(),lockAspectRatio:this.getLockAspectRatio(),lockShape:this.getLockPosition(),order:this._order,graphic:null,children:null},graphic=this.getGraphic(),childrenArray,child;if(!noGraphic&&this.hasConstraints()){object.constraints=this._constraints.toObject()}if(!noGraphic&&graphic!==null){if(graphic instanceof _gliffy.Graphic){object.graphic=_gliffy.Serializable.polymorphicToObject(graphic)}else{throw new Error("The graphic for this node is not an instance of Geometry")}}if(this.children){childrenArray=[];for(i=0;this.children&&i<this.children.length;i++){child=this.children[i].__toObject(noGraphic);if(child){childrenArray.push(child)}}object.children=childrenArray}if(!noGraphic&&this.stage&&this._uid!==null&&!this.isGroup()&&!this.isSelection()){object.linkMap=this.generateLinkMap()}return object}else{return null}},__getTextWordTransform:function(){var graphic,offsetY;if(this.getGraphic() instanceof _gliffy.Text){graphic=this.getGraphic();offsetY=(graphic.getValign()==="middle")?(this.getHeight()/2)-(graphic.getCalculatedHeight()/2):0;return new _gliffy.AffineTransform().concatenate(this.worldTransform).translate(graphic.style.x,graphic.style.y+offsetY)}else{return this.worldTransform}},generateLinkMap:function(){var nodes,node,domNode,links,boundingBox,css,cssNoTransform,linkMap=[],offset={x:0,y:0},container,i,handleLink;handleLink=function(index,link){var stageBB=new _gliffy.BoundingBox(0,0,5000,5000);boundingBox=_gliffy.Utils.getTextBoundingBox(link,offset);boundingBox.transform(node.__getTextWordTransform());if(stageBB.intersects(boundingBox)){linkMap.push({url:$(link).attr("href"),minX:Math.round(boundingBox.min.x),minY:Math.round(boundingBox.min.y),maxX:Math.round(boundingBox.max.x),maxY:Math.round(boundingBox.max.y)})}};if(_gliffy.Mouse){container=_gliffy.Mouse.getContainerOffset();offset.x-=container.left;offset.y-=container.top}if(this.stage){offset.x-=this.stage.pan_x;offset.y-=this.stage.pan_y}nodes=this.findGraphic(_gliffy.Text);for(i=0;i<nodes.length;i++){node=nodes[i];domNode=node.getDomElement();if(domNode&&domNode.length>0){links=domNode.find("a");domNode=domNode.get(0);if(links.length>0){css=domNode.style.cssText;cssNoTransform=css.replace(/ *((left)|(top)|(((-moz-)|(-webkit-)|(ms-)|(-o-))transform(-origin)?)) *:[^;]*;/g,"")+" left: 0px; top: 0px;";domNode.style.cssText=cssNoTransform;links.each(handleLink);domNode.style.cssText=css}}}return linkMap},__fromObject:function(object,opt){var i,graphic=null,constraints,child,order,childOrder,options=$.extend({subscribeToConstraints:true},opt);if(object.uid!==undefined){this.setUid(object.uid)}if(object.x!==undefined){this.setX(object.x)}if(object.y!==undefined){this.setY(object.y)}if(object.rotation!==undefined){this.setRotation(object.rotation)}if(object.width!==undefined){this.setWidth(object.width)}if(object.height!==undefined){this.setHeight(object.height)}if(object.lockAspectRatio!==undefined){this.setLockAspectRatio(object.lockAspectRatio)}if(object.lockShape!==undefined){this.setLockPosition(object.lockShape)}if(object.id!==undefined){this.setId(object.id)}if(object.order!==undefined){this._order=object.order}if(_gliffy.Constraints&&object.constraints!==undefined){constraints=new _gliffy.Constraints(this,options.subscribeToConstraints);constraints.fromObject(object.constraints);this.setConstraints(constraints)}if(object.graphic){graphic=_gliffy.Serializable.polymorphicFromObject(object.graphic,this);if(graphic instanceof _gliffy.Graphic){this.setGraphic(graphic);graphic.markDirty()}else{throw new Error("The graphic "+object.graphicClass+" is not an instance of Geometry.")}}order=0;if(object.children){this.children=[];for(i=0;i<object.children.length;i++){child=new _gliffy.Node().fromObject(object.children[i]);this.appendChild(child);childOrder=child.getOrder();if(order<childOrder){order=childOrder}}}if(this.isGroup()&&this.getOrder()<childOrder){this.setOrder(childOrder+1)}this.markDirty();return this},appendChild:function(node){if(this.stage&&this.stage.find(this.getId())===this){this.stage.appendNode(node,this)}else{if(!this.children){this.children=[]}node.parent=this;this.children.push(node)}},insertChild:function(node,index){if(this.stage&&this.stage.find(this.getId())===this){this.stage.insertNode(node,this,index)}else{if(!this.children){this.children=[]}node.parent=this;this.children.splice(index,0,node)}},prependChild:function(node){if(this.stage&&this.stage.find(this.getId())===this){this.stage.prependNode(node,this)}else{if(!this.children){this.children=[]}node.parent=this;this.children.unshift(node)}},removeChild:function(node,markForDeletion){if(this.stage&&this.stage.find(this.getId())===this){this.stage.removeNode(node,markForDeletion)}else{node.parent=null;this.__removeFromArray(this.children,node)}},__removeFromArray:function(array,object){var index=-1,other,i;for(i=0;array.length;i++){other=array[i];if((object.getId()!==null&&other.getId()===object.getId())||other===object){index=i;break}}if(index>-1&&index<array.length){array.splice(index,1)}},getShapeInformation:function(){return _gliffy.shapeLibrary.getShape(this.getUid())||{}},resetFlags:function(){var i;this._dirty_flags={};for(i=0;i<FLAGS.length;i++){this._dirty_flags[FLAGS[i]]=false}},setFlag:function(flag){if($.inArray(flag,FLAGS)<0){throw new Error($.inArray(flag,FLAGS)>-1+" node does not have flag "+flag)}this._dirty_flags[flag]=true;if((flag==="position"||flag==="bounds")&&this.stage&&this.stage.setBoundsDirty){this.stage.setBoundsDirty()}},hasFlag:function(flag){var i;if(flag){return this._dirty_flags[flag]||false}else{for(i=0;i<FLAGS.length;i++){if(this._dirty_flags[FLAGS[i]]===true){return true}}}return false},hasRepositionCanvasFlag:function(){return this._dirty_flags.position||this._dirty_flags.bounds},hasRedrawCanvasFlag:function(){return this._dirty_flags.bounds||this._dirty_flags.skin},hasGuideFlag:function(){return this._dirty_flags.guide},closestGraphic:function(type){if(this.getGraphic() instanceof type){return this}else{if(this.parent){return this.parent.closestGraphic(type)}else{return null}}},closestGroup:function(){if(this.isGroup()){return this}else{if(this.parent){return this.parent.closestGroup()}else{return null}}},topGroup:function(){if(this.isGroup()&&(this.parent===null||this.parent.isSelection())){return this}else{if(this.parent){return this.parent.topGroup()}else{return null}}},getFirstNodeWithGraphic:function(){if(this.getGraphic()){return this}else{var i,node;for(i=0;i<this.children.length;i++){node=this.children[i].getFirstNodeWithGraphic();if(node){return node}}return null}},findGraphic:function(type){var list=[],i;if((type!==null&&this.getGraphic() instanceof type)||(this.getGraphic()===null&&type===null)){list.push(this)}if(this.children&&this.children.length>0){for(i=0;i<this.children.length;i++){list=list.concat(this.children[i].findGraphic(type))}}return list},findGraphics:function(types){var list=[],i;for(i=0;i<types.length;i++){if((types[i]!==null&&this.getGraphic() instanceof types[i])||(this.getGraphic()===null&&types[i]===null)){list.push(this);break}}if(this.children&&this.children.length>0){for(i=0;i<this.children.length;i++){list=list.concat(this.children[i].findGraphics(types))}}return list},getUidNode:function(){if(this.getUid()!==null){return this}else{if(this.parent){return this.parent.getUidNode()}else{return null}}},getLeafNodes:function(includeSelf){var list=[],i;if(includeSelf||(this.getUid()&&!(this.isGroup()||this.isSelection()))){list.push(this)}for(i=0;this.children&&i<this.children.length;i++){list=list.concat(this.children[i].getLeafNodes(false))}return list},findUid:function(uid){return this.findUidFunction(function(u){return u===uid})},findUidFunction:function(check){var list=[],i;if(check(this.getUid())){list.push(this)}if(this.children&&this.children.length>0){for(i=0;i<this.children.length;i++){list=list.concat(this.children[i].findUidFunction(check))}}return list},hasText:function(){var i=0;if(this.getGraphic() instanceof _gliffy.Text){return true}else{if(this.children&&this.children.length>0){for(i=0;i<this.children.length;i++){if(this.children[i].hasText()){return true}}}}return false},immediateChildrenHaveMixedRotation:function(){var i=0;if(this.children){for(i=0;i<this.children.length;i++){if(this.children[i].getRotation()!==0){return true}}}return false},isLine:function(){return this.getGraphic() instanceof _gliffy.Line&&!this.isGroup()&&!this.isSelection()&&!this.isMultipartShape()},isGroup:function(){return this.getUid()==="com.gliffy.shape.basic.basic_v1.default.group"},isSelection:function(){return this.getUid()==="com.gliffy.shape.basic.basic_v1.default.selection"},isShape:function(){return !this.isGroup()&&!this.isSelection()&&((this.getUid()&&this.getGraphic() instanceof _gliffy.Shape)||this.isMultipartShape())},isShapePart:function(){return !this.getUid()&&this.getGraphic() instanceof _gliffy.Shape},isSvg:function(){return this.getGraphic() instanceof _gliffy.Svg&&this.getUid()==="com.gliffy.shape.basic.basic_v1.default.svg"},isProxy:function(){return _gliffy.Proxy&&this.getGraphic() instanceof _gliffy.Proxy},isImage:function(){return this.getGraphic() instanceof _gliffy.Image&&this.getUid()==="com.gliffy.shape.basic.basic_v1.default.image"},isMultipartShape:function(){return !this.isGroup()&&!this.isSelection()&&this.getUid()&&this.findGraphics([_gliffy.Shape,null]).length>1},isStandAloneText:function(){return this.getUid()==="com.gliffy.shape.basic.basic_v1.default.text"&&this.getGraphic() instanceof _gliffy.Text},isGuideNode:function(){return(this.isShape()||this.isImage()||this.isStandAloneText()||this.isSvg())},isAnnotation:function(){return this.getUid()==="com.gliffy.shape.bpmn.bpmn_v1.data_artifacts.annotation"},isText:function(){return this.getGraphic() instanceof _gliffy.Text},isTextChild:function(){return this.getGraphic() instanceof _gliffy.Text&&this.getUid()===null&&this.parent!==null},isSwimlane:function(){return(this.getUid()&&this.getUid().indexOf("com.gliffy.shape.swimlanes")===0)===true},isTable:function(){return(this.getUid()&&this.getUid().indexOf("com.gliffy.shape.table")===0)===true},isContainer:function(){var info=this.getShapeInformation();return info&&info.defaults&&info.defaults.isContainer},isPartOfMultipartShape:function(){var parent=this.getUidNode();return(parent&&parent.isMultipartShape()&&this!==parent)===true},supportsConnections:function(){var info=this.getShapeInformation();return !this.isProxy()&&info.defaults&&info.defaults.connPtPattern!==null&&info.defaults.connPtPattern!==undefined},supportsLockAspect:function(){var i,info,supports=true,shapeNodes=this.findGraphics([_gliffy.Shape,_gliffy.Image]);for(i=0;i<shapeNodes.length;i++){info=shapeNodes[i].getShapeInformation();if($.inArray("lockAspectRatio",info.mutableProperties)===-1){supports=false;break}}return supports},flattenChildren:function(){var nodes=[],i=0;for(i=0;this.children&&i<this.children.length;i++){this.__preorder(this.children[i],nodes)}nodes=nodes.sort(function(n1,n2){var result=n1.getOrder()-n2.getOrder();if(result===0){if(n1.isAChildOf(n2)){return 1}else{if(n2.isAChildOf(n1)){return -1}else{return n1.getId()>n2.getId()?1:-1}}}else{return result}});return nodes},getGuideData:function(){return{x:[this.worldAabb.min.x,(this.worldAabb.min.x+this.worldAabb.max.x)/2,this.worldAabb.max.x],y:[this.worldAabb.min.y,(this.worldAabb.min.y+this.worldAabb.max.y)/2,this.worldAabb.max.y]}},__hasDirtyGuides:function(){var i,j;for(i=0;i<2;i++){for(j=0;j<3;j++){if(this._activeGuides[i===0?"x":"y"][j]){return true}}}return false},hideGuides:function(){if(this._activeGuides!==null){if(this.__hasDirtyGuides()){this.markDirty()}}this._activeGuides={x:[false,false,false],y:[false,false,false]}},showGuide:function(xOrY,which){if((xOrY==="x"||xOrY==="y")&&which<3){if(!this._activeGuides[xOrY][which]){this._activeGuides[xOrY][which]=true;this.setFlag("guide");this.markDirty()}}},shouldShowGuide:function(xOrY,which){if((xOrY==="x"||xOrY==="y")&&which<3){return this._activeGuides[xOrY][which]}return false},worldPointToRatio:function(x,y){var point=this.worldTransform.createInverse().transformPoint(x,y);point.x/=this.getWidth();point.y/=this.getHeight();return point},ratioToWorldPoint:function(xRatio,yRatio){return this.worldTransform.transformPoint(xRatio*this.getWidth(),yRatio*this.getHeight())},__preorder:function(node,array){var c;if(!node){return}array.push(node);for(c=0;node.children&&c<node.children.length;c++){this.__preorder(node.children[c],array)}},getSubLibraryId:function(){var subLibraryId;if(this._uid!==null){if(this._uid.lastIndexOf(".")>-1){subLibraryId=this._uid.substring(0,this._uid.lastIndexOf("."))}}return subLibraryId},getConnections:function(){var i,patternStrings,patternString,pattern;if(!this._connections&&this.supportsConnections()){this._connections=[];patternStrings=this.getShapeInformation().defaults.connPtPattern;if(patternStrings){for(i=0;i<patternStrings.length;i++){patternString=patternStrings[i];pattern=_gliffy.ConnectionPointPattern.patterns[patternString];if(pattern){this._connections=this._connections.concat(pattern)}}}}else{if(!this._connections){this._connections=[]}}return this._connections},hasBoundsConnections:function(){var patternStrings,i;if(this.getShapeInformation().defaults){patternStrings=this.getShapeInformation().defaults.connPtPattern;if(patternStrings){for(i=0;i<patternStrings.length;i++){if(patternStrings[i]==="Bounds"){return true}}}}return false},updateGroupBounds:function(){var i,n,dimension,boundingBox;if(this.isGroup()||this.isSelection()){for(i=0;i<this.children.length;i++){n=this.children[i];n.updateGroupBounds();n.update()}boundingBox=this.getChildrenAabb();dimension=boundingBox.getDimension();this.setWidth(dimension.x);this.setHeight(dimension.y)}},getClosestConnectionPoint:function(point){point=this.worldTransform.createInverse().transformPoint(point.x,point.y);point.x/=this.getWidth();point.y/=this.getHeight();return this.getConnectionIndexByRatio(point)},hasConnectionIndices:function(){return this.getConnections()?true:false},getConnectionIndexByRatio:function(ratio){var connections=this.getConnections(),i,smallestDistance=Number.MAX_VALUE,index=0,distance;for(i=0;i<connections.length;i++){distance=_gliffy.Vec2.squaredDistance(ratio,connections[i].pos);if(distance<smallestDistance){index=i;smallestDistance=distance}}return index},getConnectionPointRatio:function(i){return this.getConnections()[i].pos},getConnectionPoint:function(i){var connLocal,xfm,pt;connLocal=this.getConnections()[i].pos;xfm=this.worldTransform.clone().translate(this.getWidth()*connLocal.x,this.getHeight()*connLocal.y);pt=xfm.transformPoint(0,0);return new _gliffy.Vec2(pt.x,pt.y)},getConnectionPointDom:function(i){return $("#cp"+i+"-"+this._domId)},getConnectionVector:function(i){var connections=this.getConnections();if(i<connections.length&&connections[i].vec){return(new _gliffy.Vec2(this.getConnections()[i].vec.x,this.getConnections()[i].vec.y)).rotate(this.getWorldRotation()*Math.PI/180)}else{return new _gliffy.Vec2(0,0)}},isSelectable:function(){return this._selectable},setSelectable:function(selectable){this._selectable=selectable},getLinks:function(){var linkArray=[];var __scanForLink=function(text){var anchors=$(text).find("a");var ret=[];for(var i=0;i<anchors.length;i++){var anchor=$(anchors[i]);linkArray.push(anchor.attr("href"))}return ret};var __getLinks=function(node){if(node.isText()){__scanForLink(node.getGraphic().getHTML())}if(!node.isGroup()&&!node.isSelection()&&node.children){for(var i=0;i<node.children.length;i++){__getLinks(node.children[i])}}};__getLinks(this);return linkArray}})}());(function(){var ZOOM_FIT_PADDING=20,MAX_ZOOM=8,MAX_WIDTH=5000,MAX_HEIGHT=5000;_gliffy.Stage=_gliffy.Serializable.extend({id:null,zoom:1,pan_x:0,pan_y:0,background:"#FFFFFF",__unsavedChanges:false,width:750,height:1000,maxWidth:MAX_WIDTH,maxHeight:MAX_HEIGHT,exportBorder:false,gridOn:true,snapToGrid:true,drawingGuidesOn:true,pageBreaksOn:false,printGridOn:false,printPaper:"LETTER",printShrinkToFit:false,printPortrait:true,shapeStyles:null,lineStyles:null,textStyles:null,themeData:null,objects:null,_node_map:null,_node_index:0,_calculate_bounds:true,_pan_dirty:true,deletes:null,dirty:null,autoFit:true,gon:null,document:null,commandHistory:null,worldAabb:null,options:{zoom:true,pan_x:true,pan_y:true,background:true,width:true,height:true,autoFit:true},init:function(options,id){var key;this.objects=[];this.shapeStyles={};this.lineStyles={};this.textStyles={};this._node_map={};this.deletes=[];this.dirty={};this.worldAabb=new _gliffy.BoundingBox();this.id=id||_gliffy.Utils.randomString(_gliffy.stages);_gliffy.stages[this.id]=this;if(_gliffy.Editor!==undefined){this.commandHistory=new _gliffy.CommandHistory(this)}if(options){for(key in options){if(options.hasOwnProperty(key)){if(this.options[key]){this[key]=options[key]}else{throw key+" is not a valid option for stage"}}}}},addDirtyNode:function(node){this.dirty[node.getId()]=node.getId()},removeDirtyNode:function(node){delete this.dirty[node.getId()]},update:function(){var i;for(i=0;i<this.objects.length;i++){this.objects[i].update()}this.updateBounds()},setBoundsDirty:function(){this._calculate_bounds=true},setBoundsClean:function(){this._calculate_bounds=false},updateBounds:function(){if(this._calculate_bounds){this.worldAabb=this.calculateBoundingBox();this.width=Math.ceil(Math.min(this.worldAabb.max.x,this.maxWidth));this.height=Math.ceil(Math.min(this.worldAabb.max.y,this.maxHeight));this.setBoundsClean()}},find:function(node_id){return this._node_map[node_id]||null},findGraphic:function(type){var list=[],i;for(i=0;i<this.objects.length;i++){list=list.concat(this.objects[i].findGraphic(type))}return list},iterateNodes:function(callback){$.each(this._node_map,function(key,node){callback(node)})},prependNode:function(new_node,parent){this.insertNode(new_node,parent,0)},insertNode:function(new_node,parent,index){this.removeNode(new_node,false);this.__resetNodeId(new_node);if(new_node&&parent){if(!parent.children){parent.children=[]}parent.children.splice(index,0,new_node);new_node.parent=parent;parent.markDirty()}else{this.objects.splice(index,0,new_node);new_node.markDirty()}if(new_node.supportsConstraints()){new_node.subscribeAllConstraints()}if(_gliffy.Editor&&new_node.isSelection()){_gliffy.Mouse.editor.overlayManager.addSelectionNodesToBreakup(new_node)}},appendNode:function(new_node,parent){var index;if(parent){if(parent.children){index=parent.children.length}else{index=0}}else{index=this.objects.length}this.insertNode(new_node,parent,index)},appendCopyNode:function(node){this.insertCopyNode(node,this.objects.length)},prependCopyNode:function(node){this.insertCopyNode(node,0)},insertCopyNode:function(node,index){var idMap={};this.__resetCopyNodeId(node,idMap);this.objects.splice(index,0,node);node.markDirty();if(node.supportsConstraints()){this.__updateConstraintIds(node,idMap)}if(node.isSelection()){_gliffy.Mouse.editor.overlayManager.addSelectionNodesToBreakup(node)}new _gliffy.BringToFrontCommand({node:node}).execute(this)},calculateBoundingBox:function(){if(this.objects.length>0){var i,bb=_gliffy.BoundingBox.SMALLEST.clone();for(i=0;i<this.objects.length;i++){bb.add(this.objects[i].getChildrenWorldAabb(true))}return bb}else{return new _gliffy.BoundingBox()}},__updateConstraintIds:function(node,idMap){var i;if(node.hasConstraints()){node.getConstraints().updateIds(idMap)}for(i=0;node.children&&i<node.children.length;i++){this.__updateConstraintIds(node.children[i],idMap)}},__resetNodeId:function(node){var i=0,id=node._id;node.stage=this;if(id===null||id===undefined||id<0){id="auto"}node.setId(id);for(i=0;node.children&&i<node.children.length;i++){this.__resetNodeId(node.children[i])}},__resetCopyNodeId:function(node,idMap){var i=0,id=node._id;node.stage=this;node.setId("auto");idMap[id]=node.getId();for(i=0;node.children&&i<node.children.length;i++){this.__resetCopyNodeId(node.children[i],idMap)}},removeNode:function(node,markForDeletion,isChild){var i,parent;this.setBoundsDirty();if(node){if(markForDeletion===undefined||markForDeletion===null){markForDeletion=true}node=this.find(node.getId());if(node){for(i=0;node.children&&i<node.children.length;i++){this.removeNode(node.children[i],markForDeletion,true)}if(markForDeletion){this.removeDomNode(node)}parent=node.parent;if(!isChild){if(parent===null){this.__removeFromArray(this.objects,node)}else{this.__removeFromArray(parent.children,node)}node.parent=null}if(markForDeletion){node.notifyRemove()}node.stage=null;delete this._node_map[node.getId()]}}return node},removeDomNode:function(node){if(node._domId){this.deletes.push("#"+node._domId)}},isDirty:function(){return this.deletes.length>0||Object.keys(this.dirty).length>0},hasUnsavedChanges:function(){return this.__unsavedChanges},setUnsavedChanges:function(hasChanges){if(_gliffy.Editor!==undefined&&hasChanges!==this.__unsavedChanges){this.__unsavedChanges=hasChanges;if(window.GliffyApp){GliffyApp.documentModel.update(this.document)}}},setBackground:function(color){this.background=color;if(window.GliffyApp){GliffyApp.documentModel.updateProperty("pageColor",color)}},__removeFromArray:function(array,object){var index=-1,other,i;for(i=0;i<array.length;i++){other=array[i];if(other.getId()===object.getId()){index=i;break}}if(index>-1&&index<array.length){array.splice(index,1)}},getStagePanX:function(){return -this.pan_x/this.zoom},getStagePanY:function(){return -this.pan_y/this.zoom},zoomAt:function(zoom,stageX,stageY,viewportWidth,viewportHeight){var stagePanX=this.getStagePanX(),stagePanY=this.getStagePanY(),zoomRatio;zoom=(zoom<MAX_ZOOM)?zoom:MAX_ZOOM;zoomRatio=zoom/this.zoom;stagePanX=(stagePanX-stageX)/(zoomRatio)+stageX;stagePanY=(stagePanY-stageY)/(zoomRatio)+stageY;viewportWidth=viewportWidth/zoomRatio;viewportHeight=viewportHeight/zoomRatio;this.setZoom(zoom);this.setStagePan(stagePanX,stagePanY,viewportWidth,viewportHeight)},setPanX:function(x){this.pan_x=x;this._pan_dirty=true},setPanY:function(y){this.pan_y=y;this._pan_dirty=true},setStagePan:function(x,y,viewportWidth,viewportHeight){this.setPan(-x*this.zoom,-y*this.zoom,viewportWidth,viewportHeight)},setPan:function(x,y,viewportWidth,viewportHeight){this.setPanX(x);this.setPanY(y);this.clampPanning(viewportWidth,viewportHeight)},offsetPan:function(x,y,viewportWidth,viewportHeight){this.setPan(this.pan_x+x,this.pan_y+y,viewportWidth,viewportHeight)},clampPanning:function(viewportWidth,viewportHeight){var stageWidth=(this.autoFit||this.width>this.maxWidth)?this.maxWidth:this.width,stageHeight=(this.autoFit||this.height>this.maxHeight)?this.maxHeight:this.height,minWidth=Math.ceil((viewportWidth-stageWidth)*this.zoom),minHeight=Math.ceil((viewportHeight-stageHeight)*this.zoom);if(minWidth>0){minWidth=0}if(minHeight>0){minHeight=0}if(this.pan_x>0){this.pan_x=0}else{if(this.pan_x<minWidth){this.pan_x=minWidth}}if(this.pan_y>0){this.pan_y=0}else{if(this.pan_y<minHeight){this.pan_y=minHeight}}this.pan_x=Math.ceil(this.pan_x);this.pan_y=Math.ceil(this.pan_y)},centerAt:function(stageX,stageY,viewportWidth,viewportHeight){this.setStagePan(stageX-viewportWidth/2,stageY-viewportHeight/2,viewportWidth,viewportHeight)},zoomToCenter:function(zoom,viewportWidth,viewportHeight){var zoomRatio,stageX=this.getStagePanX()+viewportWidth/2,stageY=this.getStagePanY()+viewportHeight/2;zoom=(zoom<MAX_ZOOM)?zoom:MAX_ZOOM;zoomRatio=this.zoom/zoom;this.setZoom(zoom);this.centerAt(stageX,stageY,viewportWidth*zoomRatio,viewportHeight*zoomRatio)},zoomToBox:function(boundingBox,viewportWidth,viewportHeight){var dimension,xZoom,yZoom,zoom,zoomRatio,center;dimension=boundingBox.getDimension();xZoom=viewportWidth*this.zoom/dimension.x;yZoom=viewportHeight*this.zoom/dimension.y;zoom=(xZoom<yZoom)?xZoom:yZoom;zoom=(zoom<MAX_ZOOM)?zoom:MAX_ZOOM;zoomRatio=this.zoom/zoom;viewportWidth=viewportWidth*zoomRatio;viewportHeight=viewportHeight*zoomRatio;center=boundingBox.getCenter();this.setZoom(zoom);this.centerAt(center.x,center.y,viewportWidth,viewportHeight)},zoomToFit:function(viewportWidth,viewportHeight){var i,aabb=new _gliffy.BoundingBox().copy(_gliffy.BoundingBox.SMALLEST);if(this.objects.length===0){this.pan_x=0;this.pan_y=0;this.setZoom(1)}else{for(i=0;i<this.objects.length;i++){aabb.add(this.objects[i].worldAabb)}aabb.extend(ZOOM_FIT_PADDING);this.zoomToBox(aabb,viewportWidth,viewportHeight)}},getZoom:function(){return this.zoom},setZoom:function(value){this.zoom=(value<MAX_ZOOM)?value:MAX_ZOOM;$(document).trigger("gliffy.zoom",value)},isGridVisible:function(){return this.gridOn},setGridVisible:function(b){this.gridOn=b},isPageBreaksVisible:function(){return this.pageBreaksOn},setPageBreaksVisible:function(b){this.pageBreaksOn=b},isSnapToGrid:function(){return this.snapToGrid},setSnapToGrid:function(b){this.snapToGrid=b},isDrawingGuideOn:function(){return this.drawingGuidesOn},setDrawingGuideOn:function(b){this.drawingGuidesOn=b},isExportBorder:function(){return this.exportBorder},setExportBorder:function(b){this.exportBorder=b},setMaxWidth:function(w){this.maxWidth=w;if(window.GliffyApp){GliffyApp.documentModel.updateProperty("maxWidth",w)}},setMaxHeight:function(h){this.maxHeight=h;if(window.GliffyApp){GliffyApp.documentModel.updateProperty("maxHeight",h)}},updateProperty:function(prop,value){if(this["set"+prop]!==undefined){this["set"+prop](value)}},__toObject:function(){var i,node,objects=[],object,type;for(i=0;i<this.objects.length;i++){object=this.objects[i];if(object instanceof _gliffy.Node){node=object.toObject();if(node){objects.push(object.toObject())}}else{throw new Error("Stage contains an unknown object type.")}}return{objects:objects,background:this.background,width:this.width,height:this.height,maxWidth:this.maxWidth,maxHeight:this.maxHeight,nodeIndex:this._node_index,autoFit:this.autoFit,exportBorder:this.exportBorder,gridOn:this.gridOn,snapToGrid:this.snapToGrid,drawingGuidesOn:this.drawingGuidesOn,pageBreaksOn:this.pageBreaksOn,printGridOn:this.printGridOn,printPaper:this.printPaper,printShrinkToFit:this.printShrinkToFit,printPortrait:this.printPortrait,shapeStyles:this.shapeStyles,lineStyles:this.lineStyles,textStyles:this.textStyles,themeData:this.themeData}},getAnalyticsData:function(){var data={diagramCategory:"none",categories:{},nodeType:{nodes:0,lines:0,groups:0,shapes:0,shapeParts:0,textChildren:0,standaloneTexts:0,images:0,multipartShapes:0,rotatedNodes:0}},split,category,uid,max=0;$.each(this._node_map,function(key,node){data.nodeType.nodes++;if(node.isLine()){data.nodeType.lines++}if(node.isGroup()){data.nodeType.groups++}if(node.isShape()){data.nodeType.shapes++;uid=node.getUid();if(uid){split=uid.split(".");if(split.length>=4){category=split[3];if(!data.categories[category]){data.categories[category]=0}data.categories[category]++}}}if(node.isShapePart()){data.nodeType.shapeParts++}if(node.isImage()){data.nodeType.images++}if(node.isMultipartShape()){data.nodeType.multipartShapes++}if(node.isTextChild()){data.nodeType.textChildren++}if(node.isStandAloneText()){data.nodeType.standaloneTexts++}if(node.getRotation()!==0){data.nodeType.rotatedNodes++}});$.each(data.categories,function(category,num){if(num>max){data.diagramCategory=category;max=num}});delete data.nodeType;return data},__fromObject:function(object,opt){this.objects.length=0;this._node_index=0;this._node_map={};this.dirty={};if(object.nodeIndex!==undefined){this._node_index=object.nodeIndex}var i,node,o,options=$.extend({subscribeToConstraints:true},opt);for(i=0;i<object.objects.length;i++){o=object.objects[i];node=new _gliffy.Node(this);node.fromObject(o,options);this.objects.push(node)}if(object.background!==undefined){this.background=object.background}if(object.width!==undefined){this.width=object.width}if(object.height!==undefined){this.height=object.height}if(object.autoFit!==undefined){this.autoFit=object.autoFit}if(object.exportBorder!==undefined){this.exportBorder=object.exportBorder}if(object.gridOn!==undefined){this.gridOn=object.gridOn}if(object.snapToGrid!==undefined){this.snapToGrid=object.snapToGrid}if(object.themeData!==undefined){this.themeData=object.themeData}if(object.drawingGuidesOn!==undefined){this.drawingGuidesOn=object.drawingGuidesOn}if(object.pageBreaksOn!==undefined){this.pageBreaksOn=object.pageBreaksOn}if(object.printGridOn!==undefined){this.printGridOn=object.printGridOn}if(object.printPaper!==undefined){this.printPaper=object.printPaper}if(object.printShrinkToFit!==undefined){this.printShrinkToFit=object.printShrinkToFit}if(object.printPortrait!==undefined){this.printPortrait=object.printPortrait}if(object.maxHeight!==undefined){this.maxHeight=object.maxHeight||MAX_WIDTH}if(object.maxWidth!==undefined){this.maxWidth=object.maxWidth||MAX_HEIGHT}if(_gliffy.Editor!==undefined){if(object.shapeStyles!==undefined){this.shapeStyles=this.__buildStyles(object.shapeStyles,"ShapeStyle")}if(object.lineStyles!==undefined){this.lineStyles=this.__buildStyles(object.lineStyles,"LineStyle")}if(object.textStyles!==undefined){this.textStyles=this.__buildStyles(object.textStyles,"TextStyle")}}return this},__buildStyles:function(stylesObject,type){var key,styles={};for(key in stylesObject){if(stylesObject.hasOwnProperty(key)){styles[key]=new _gliffy[type]();styles[key].fromObject(stylesObject[key])}}return styles},bringToFront:function(node){var nodes,sendList;if(node!==null){nodes=this.flattenNodes(false);sendList=this.__separateNodeSendToList(node,nodes);nodes=nodes.concat(sendList);return this.reorderNodes(nodes)}},sendToBack:function(node){var nodes,sendList;if(node!==null){nodes=this.flattenNodes(false);sendList=this.__separateNodeSendToList(node,nodes);nodes=sendList.concat(nodes);return this.reorderNodes(nodes)}},reorderNodes:function(nodes){var i,n,orderList=[];for(i=0;i<nodes.length;i++){n=nodes[i];if(n._order!=="auto"){orderList.push({id:n.getId(),order:n.getOrder(),newOrder:i});n.setOrder(i)}}return orderList},__separateNodeSendToList:function(node,flatNodeList){var ids,i,j,n,childrenList,sendList=[];ids=(node instanceof _gliffy.Node)?[node]:node;for(i=0;i<ids.length;i++){n=ids[i];flatNodeList.splice($.inArray(n,flatNodeList),1);if(ids.length===1&&n.children&&n.children.length>0){childrenList=n.flattenChildren();for(j=0;j<childrenList.length;j++){flatNodeList.splice($.inArray(childrenList[j],flatNodeList),1)}sendList=sendList.concat(childrenList)}sendList.push(n)}return sendList},flattenNodes:function(forceUpdate){var nodes=[],i=0;for(i=0;i<this.objects.length;i++){this.__preorder(this.objects[i],nodes,forceUpdate)}this.updateBounds();nodes=nodes.sort(function(n1,n2){var result=n1.getOrder()-n2.getOrder();if(result===0){if(n1.isAChildOf(n2)){return 1}else{if(n2.isAChildOf(n1)){return -1}else{return n1.getId()>n2.getId()?1:-1}}}else{return result}});return nodes},__preorder:function(node,array,forceUpdate){var c=0;if(!node){return}if(forceUpdate){if(node.getGraphic()){node.getGraphic().markDirty()}node.markDirty()}if(node.isDirty()){node.update()}array.push(node);for(c=0;node.children&&c<node.children.length;c++){this.__preorder(node.children[c],array,forceUpdate)}},detachSelectionFromGroup:function(parentNode){var stage=this,childNode,childTransform,childPos,parentParentNode,selectedNodeIds=[],children=[],i;while(parentNode.children.length){childNode=parentNode.children[0];selectedNodeIds.push(childNode.getId());parentParentNode=childNode.parent.parent;childTransform=childNode.worldTransform.clone();childPos=childTransform.transformPoint(childNode.getWidth()/2,childNode.getHeight()/2);childNode.setX(childPos.x-childNode.getWidth()/2);childNode.setY(childPos.y-childNode.getHeight()/2);childNode.setRotation(childNode.getRotation()+parentNode.getRotation());stage.removeNode(childNode,false);stage.appendNode(childNode,parentParentNode);children.push(childNode)}return selectedNodeIds},attachSelectionToGroup:function(group,nodes){var boundingBox=_gliffy.BoundingBox.SMALLEST.clone(),i,node,stage=this;group.update();this.__updateGroupAndBounds(group,nodes,boundingBox);for(i=0;i<nodes.length;i++){node=nodes[i];if(!node.isProxy()){node.setX(node.getX()-group.getX());node.setY(node.getY()-group.getY());stage.removeNode(node,false);stage.appendNode(node,group)}}},__updateGroupAndBounds:function(group,nodes,boundingBox){var i,node,dimension,stage=this;for(i=0;i<nodes.length;i++){node=nodes[i];if(!node.isProxy()){node.update();boundingBox.add(node.worldOverlayAabb)}}group.setX(boundingBox.min.x);group.setY(boundingBox.min.y);dimension=boundingBox.getDimension();group.setWidth(dimension.x);group.setHeight(dimension.y)},addSelectionToGroup:function(group,nodes){var i,node,stage=this,point,inverse,lastBB;group.update();lastBB=group.worldAabb.clone();this.__updateGroupAndBounds(group,nodes,group.worldAabb.clone());group.update();for(i=0;group.children&&i<group.children.length;i++){node=group.children[i];node.setX(node.getX()-(group.worldAabb.min.x-lastBB.min.x));node.setY(node.getY()-(group.worldAabb.min.y-lastBB.min.y))}for(i=0;i<nodes.length;i++){node=nodes[i];if(!node.isProxy()){node.update();stage.removeNode(node,false);stage.appendNode(node,group);node.setX(node.getX()-group.getX());node.setY(node.getY()-group.getY())}}},hasObjects:function(){return(this.objects!==null&&this.objects.length>0)}})}());(function(){var MIN_VERSION="1",CURRENT_VERSION="1.1",BETA_VERSION="1.2",ROOT_URL="/",CONTENT_TYPE="application/gliffy+json";function isValidVersion(version){var min=parseFloat(MIN_VERSION),max=parseFloat(BETA_VERSION);version=parseFloat(version);return min<=version&&version<=max}_gliffy.Gon=_gliffy.Serializable.extend({version:null,stage:null,metadata:null,embeddedResources:null,init:function(options){this.stage=new _gliffy.Stage(options);this.stage.gon=this;this.metadata=this.getDefaultMetadata();this.embeddedResources=new _gliffy.EmbeddedResources()},getDefaultMetadata:function(){return{title:"untitled",revision:0,exportBorder:false}},getMetadata:function(){return this.metadata},setMetadata:function(o){this.metadata=$.extend(this.getDefaultMetadata(),o)},getLibrariesMetadata:function(){if(this.metadata){return this.metadata.libraries}return null},setLibrariesMetadata:function(libraries){if(!this.metadata){this.metadata=this.getDefaultMetadata()}this.metadata.libraries=libraries},getEmbeddedResources:function(){return this.embeddedResources},setBetaVersion:function(){this.version=BETA_VERSION;_gliffy.Utils.disableExportsForBeta()},isBetaVersion:function(){return this.version===BETA_VERSION},setCurrentVersion:function(){this.version=CURRENT_VERSION;_gliffy.Utils.enableExportsForBeta()},updateProperty:function(prop,value){if(this["set"+prop]!==undefined){this["set"+prop](value)}else{this.stage.updateProperty(prop,value)}},__toObject:function(){var object=null,self=this,embeddedResources=null;_gliffy.Utils.tryCatch(function(){object=self.stage.toObject();embeddedResources=self.embeddedResources.toObject()},function(e){_gliffy.handleError("com.gliffy.error.file_save_malformed",[],e,self.errorTarget)});if(object!==null){return{contentType:CONTENT_TYPE,version:this.version===null?CURRENT_VERSION:this.version,metadata:this.metadata,embeddedResources:embeddedResources,stage:object}}else{return null}},fromObject:function(object,opt){if(!object.version||!isValidVersion(object.version)){_gliffy.Logger.error("gon.fromObject failed. The file being loaded is not a valid version:"+object.version);throw new Error("The file being loaded is not a valid version: "+object.version)}else{if(object.version===BETA_VERSION){_gliffy.Utils.disableExportsForBeta()}this.version=object.version||CURRENT_VERSION;this.setMetadata(object.metadata);this.stage.fromObject(object.stage,opt);this.embeddedResources.fromObject(object.embeddedResources)}return this},__populateUids:function(nodes,uids){var i,uid,node;for(i=0;i<nodes.length;i++){node=nodes[i];uid=node.getUid();if($.inArray(uid,uids)===-1&&uid){uids.push(uid)}if(node.children){this.__populateUids(node.children,uids)}}},loadEditableProperties:function(callback){if(!_gliffy.shapeLibrary){throw new Error("the shapeLibrary instance has not been initialized.")}var uids=[];this.__populateUids(this.stage.objects,uids);_gliffy.shapeLibrary.loadShapes(uids,this.errorTarget).done(callback)},__registerShapes:function(callBack){var i,tids=[],nodes,graphic,tid,deferred=[],svg,resource;if(!_gliffy.shapeLibrary){throw new Error("the shapeLibrary instance has not been initialized.")}nodes=this.__flattenNodes(this.stage);for(i=0;i<nodes.length;i++){graphic=nodes[i].getGraphic();if(graphic){if(graphic instanceof _gliffy.Svg&&graphic.getTid()==="com.gliffy.stencil.custom.svg.static"){resource=this.getEmbeddedResources().getResource(graphic.getEmbeddedResourceId());svg=resource.getData();deferred.push(_gliffy.shapeLibrary.loadSvgStencil(svg,resource,true))}else{if(graphic instanceof _gliffy.Shape&&$.inArray(graphic.getTid(),tids)===-1){tids.push(graphic.getTid())}else{if(graphic instanceof _gliffy.Line){tid=graphic.getStartArrowTid();if(tid&&$.inArray(graphic.getTid(),tids)===-1){tids.push(tid)}tid=graphic.getEndArrowTid();if(tid&&$.inArray(graphic.getTid(),tids)===-1){tids.push(tid)}}}}}}deferred.push(_gliffy.shapeLibrary.loadStencils(tids,this.errorTarget));$.when.apply(null,deferred).done(callBack)},__flattenNodes:function(stage){var i,nodes=[];for(i=0;i<stage.objects.length;i++){this.__preorder(stage.objects[i],nodes)}return nodes},__preorder:function(node,array){var c;if(!node){return}array.push(node);for(c=0;node.children&&c<node.children.length;c++){this.__preorder(node.children[c],array)}}})}());(function(){_gliffy.Document=_gliffy.Serializable.extend({__gon:null,__image:null,__title:"untitled",__revision:0,__urls:null,__autosaveDisabled:false,editable:null,errorTarget:null,init:function(options){this.__gon=new _gliffy.Gon(options);this.__gon.stage.document=this;this.__urls={};this.editable=_gliffy.Editor!==undefined},getUrls:function(){return this.__urls},getGon:function(){return this.__gon},getStage:function(){return this.__gon.stage},getImage:function(){return this.__image},setImage:function(image){this.__image=image},getMetadata:function(){return this.__gon.getMetadata()},getEmbeddedResources:function(){return this.__gon.getEmbeddedResources()},getLibrariesMetadata:function(){return this.__gon.getLibrariesMetadata()},setLibrariesMetadata:function(libraries){this.__gon.setLibrariesMetadata(libraries)},setMetadata:function(metadata){this.__gon.setMetadata(metadata)},setTitle:function(title){this.__title=title},getTitle:function(){return this.__title||"untitled"},getCurrentRevision:function(){return this.__revision||0},setCurrentRevision:function(rev){this.__revision=rev},setAutosaveDisabled:function(b){this.__autosaveDisabled=b},isAutosaveDisabled:function(){if(this.__autosaveDisabled===undefined||this.__autosaveDisabled===null){return false}return this.__autosaveDisabled},loadFromObject:function(object,callback){try{this.fromObject(object);var self=this;this.__gon.__registerShapes(function(){if(self.editable){self.__gon.loadEditableProperties(function(){self.getStage().update();if(callback){callback()}})}else{if(callback){callback()}}})}catch(e){if(callback){callback()}_gliffy.handleError("com.gliffy.error.file_malformed",[],e)}},loadFromText:function(text,callback){this.loadFromObject($.parseJSON(text),callback)},updateProperty:function(prop,value){this.__gon.updateProperty(prop,value)},refreshFromObject:function(object){this.__urls=object.urls||{};this.__title=object.title;this.__revision=object.revision;return this},isNewNotDirty:function(){return(this.getCurrentRevision()===0&&!this.getStage().isDirty())},convertToTemplate:function(){this.__title="untitled";this.__revision=0},__toObject:function(){var object=null,self=this;_gliffy.Utils.tryCatch(function(){if(_gliffy.FEATURES.allowDisableAutosave){self.__gon.setMetadata({autosaveDisabled:self.__autosaveDisabled})}object=self.__gon.toObject()},function(e){_gliffy.handleError("com.gliffy.error.file_save_malformed",[],e,self.errorTarget)});if(object!==null){return{gon:object,image:this.__image,urls:this.__urls,title:this.__title,revision:this.__revision}}else{return null}},fromObject:function(object){if(object.gon){this.__gon.fromObject(object.gon);this.__image=object.image;this.__urls=object.urls||{};this.__title=object.title;this.__revision=object.revision;if(_gliffy.FEATURES.allowDisableAutosave){if(object.gon.metadata&&object.gon.metadata.autosaveDisabled){this.setAutosaveDisabled(object.gon.metadata.autosaveDisabled)}}return this}else{this.__gon.fromObject(object);this.__image=null;this.__urls=object.urls||{};this.__title=object.title;this.__revision=object.revision;if(_gliffy.FEATURES.allowDisableAutosave){if(object.metadata&&object.metadata.autosaveDisabled){this.setAutosaveDisabled(object.metadata.autosaveDisabled)}}return this}}})}());(function(){_gliffy.Viewer=_gliffy.Class.extend({document:null,target:null,iframeTarget:null,errorTarget:null,renderer:null,pointerEvents:null,__pan_on:false,__textOnHover:false,init:function(o){var options=$.extend({},{rootServiceURL:_gliffy.shapeLibrary.rootServiceURL},o);_gliffy.shapeLibrary.setup({rootServiceURL:options.rootServiceURL});this.document=new _gliffy.Document()},render:function(o){var options,self,renderer,renderCallback,loadedCallback,queuedCallback,readyCallback,contents;options=$.extend({},{renderer:_gliffy.Renderer.StageMultiCanvas,url:null,json:null,jsonObj:null,target:null,iframe:false,callback:null,scale:1,textId:null,lazyLoad:false,queueRender:true,pan:false,resizeTarget:true,useImages:true,autoFitPadding:true,pointerEvents:($.browser.msie)?"auto":"none",textOnHover:($.browser.msie)?true:false,enablePan:true},o);self=this;if(!options.target){throw new Error("No target specified")}if(!options.url&&!options.json&&!options.textId&&!options.jsonObj){throw new Error("No diagram to view. Pass in a url or json string.")}this.target=options.target;this.errorTarget=options.target;if(options.iframe){this.iframeTarget=options.target}if(!_gliffy.renderers[options.renderer.prototype.id]){renderer=new options.renderer();_gliffy.renderers[renderer.id]=renderer}this.renderer=_gliffy.renderers[options.renderer.prototype.id];this.__pan_on=options.pan;this.__textOnHover=options.textOnHover;this.pointerEvents=options.pointerEvents;renderCallback=function(){if(self.iframeTarget){self.iframeTarget.css({width:Math.ceil(self.document.getStage().width),height:Math.ceil(self.document.getStage().height)})}if(self.__textOnHover){self.setupTextOnHover()}if(options.callback){options.callback()}};loadedCallback=function(){_gliffy.Utils.tryCatch(function(){self.document.getStage().setZoom(options.scale);self.renderer.render({object:self.document.getStage(),target:self.target,renderCallback:renderCallback,resizeTarget:options.resizeTarget,pointerEvents:self.pointerEvents,queueRender:options.queueRender,useImages:options.useImages,autoFitPadding:options.autoFitPadding,cssPan:options.enablePan})},function(e){_gliffy.handleError("com.gliffy.error.render_failed",[],e,self.errorTarget)})};queuedCallback=function(element){self.document.errorTarget=self.errorTarget;self.cleanTarget();self.setupPanHandler();_gliffy.Utils.tryCatch(function(){if(options.json){self.document.loadFromText(options.json,loadedCallback)}else{if(options.url){jQuery.ajax({type:"GET",url:options.url,dataType:"json",success:function(data){self.document.loadFromObject(data,loadedCallback)},error:function(xhr,text,error){if(xhr.status===404){_gliffy.handleError("com.gliffy.error.file_not_found",[options.url],error,self.errorTarget)}else{_gliffy.handleError("com.gliffy.error.file_malformed",[options.url],error,self.errorTarget)}}})}else{if(options.textId){self.document.loadFromText($(options.textId),loadedCallback)}else{if(options.jsonObj){self.document.loadFromObject(options.jsonObj,loadedCallback)}}}}},function(e){_gliffy.handleError("com.gliffy.error.file_load",[],e,self.errorTarget)})};readyCallback=function(){if(options.lazyLoad){var t=self.iframeTarget||self.target;t.lazyload({threshold:0,delay:200,callback:queuedCallback})}else{queuedCallback()}};if(options.iframe){contents=options.target.contents();if(contents&&contents.get(0).readyState==="complete"&&contents.find("#container").length>0){readyCallback()}else{options.target.load(function(){readyCallback()})}}else{readyCallback()}},cleanTarget:function(){this.target.html("");this.target.data("contexts",null)},setupTextOnHover:function(){var self,last;self=this;self.target.unbind("mousemove.gliffy.viewer");last=null;self.target.bind("mousemove.gliffy.viewer",function(event){var elements,i,ele;if(!last||last.x!==event.pageX||last.y!==event.pageY){elements=_gliffy.KoreSampl.fromEvent(event,this);i=0;for(i=0;i<elements.length;i++){ele=$(elements[i]);if(ele.hasClass("gliffy-text")){ele.css({zIndex:self.document.getStage()._node_index+1});break}}last={x:event.pageX,y:event.pageY}}})},redraw:function(callback,forceUpdate,resizeTarget,autoFitPadding){forceUpdate=(forceUpdate)?true:false;autoFitPadding=(autoFitPadding)?true:false;resizeTarget=(resizeTarget!==false);var self=this;_gliffy.Utils.tryCatch(function(){self.errorTarget=self.target;self.renderer.render({object:self.document.getStage(),target:self.target,cssPan:true,renderCallback:function(){if(self.__textOnHover){self.setupTextOnHover()}if(callback){callback()}},forceUpdate:forceUpdate,resizeTarget:resizeTarget,pointerEvents:self.pointerEvents,queueRender:true,useImages:true,autoFitPadding:autoFitPadding})},function(e){_gliffy.handleError("com.gliffy.error.render_failed",[],e,self.errorTarget)})},zoom:function(zoomValue,callback,resizeTarget){this.document.getStage().setZoom(zoomValue);this.redraw(callback,true,resizeTarget)},zoomToCenter:function(zoomValue,callback,resizeTarget){this.document.getStage().zoomToCenter(zoomValue,this.target.width(),this.target.height());this.redraw(callback,true,resizeTarget)},zoomToFit:function(viewportWidth,viewportHeight,callback,resizeTarget){this.document.getStage().zoomToCenter(viewportWidth,viewportHeight);this.redraw(callback,true,resizeTarget)},reset:function(callback,resizeTarget){this.document.getStage().pan_x=0;this.document.getStage().pan_y=0;this.document.getStage().setZoom(1);this.redraw(callback,true,resizeTarget)},pan:function(x,y){this.document.getStage().pan_x=x;this.document.getStage().pan_y=y;var self=this;_gliffy.Utils.tryCatch(function(){self.renderer.render({object:self.document.getStage(),target:self.target,panOnly:true,autoFitPadding:true,cssPan:true})},function(e){_gliffy.handleError("com.gliffy.error.render_failed",[],e,self.errorTarget)})},togglePan:function(activate){this.__pan_on=activate;this.setupPanHandler()},setupPanHandler:function(){var self,target,lastpos;self=this;target=this.target;target.css("cursor","auto");target.unbind("draginit");target.unbind("drag");if(this.__pan_on){lastpos={x:this.document.getStage().pan_x,y:this.document.getStage().pan_y};target.bind("draginit",{which:1},function(event){lastpos={x:event.pageX,y:event.pageY}});target.bind("drag",{which:1},function(event){var xDiff,yDiff;xDiff=event.pageX-lastpos.x;yDiff=event.pageY-lastpos.y;lastpos={x:event.pageX,y:event.pageY};self.document.getStage().pan_x=self.document.getStage().pan_x+xDiff;self.document.getStage().pan_y=self.document.getStage().pan_y+yDiff;_gliffy.Utils.tryCatch(function(){self.renderer.render({object:self.document.getStage(),target:self.target,panOnly:true,autoFitPadding:true,cssPan:true});$(window).trigger("gliffy.viewer.pan.drag",[self,{x:xDiff,y:yDiff}])},function(e){_gliffy.handleError("com.gliffy.error.render_failed",[],e,self.errorTarget)})});target.css("cursor","move")}},getImageData:function(imgType,callback){var tmp;tmp=$("<div/>");$("body").append(tmp);if(!_gliffy.renderers[_gliffy.Renderer.StageSingleCanvas.prototype.id]){_gliffy.renderers[_gliffy.Renderer.StageSingleCanvas.prototype.id]=new _gliffy.Renderer.StageSingleCanvas()}_gliffy.renderers[_gliffy.Renderer.StageSingleCanvas.prototype.id].render({object:this.document.getStage(),target:tmp,renderCallback:function(){var $canvas,canvas,imageData;$canvas=tmp.find("canvas");canvas=$canvas.get(0);imageData=canvas.toDataURL("image/"+imgType);tmp.remove();callback(imageData)}})}})}());(function(){_gliffy.Renderer=_gliffy.Class.extend({id:null,target:null,init:function(){throw"this is the renderer interface"},render:function(options){throw"check for renderer options later"}})})();(function(){var TID=null,OVERFLOW={name:"overflow",values:["left","none","right","both"],left:"left",right:"right",both:"both",none:"none"},VALIGN={name:"valign",values:["top","middle","bottom"],top:"top",middle:"middle",bottom:"bottom"},VPOSITION={name:"vposition",values:["above","none","below"],above:"above",none:"none",below:"below"},HPOSITION={name:"hposition",values:["left","none","right"],left:"left",none:"none",right:"right"},FONT_FIXES={Arial:{normal:{9:1,10:1,11:1,12:2,13:2.5,14:2.5,18:3,24:3,36:5,48:5,64:8,72:8,96:10,110:12,127:16},bold:{9:1,10:1,11:1,12:2,13:2.5,14:2.5,18:3,24:3,36:5,48:5,64:8,72:8,96:10,110:12,127:16},ascender:{9:2,10:2,11:2,12:3,13:2,14:2,18:6,24:6,36:8,48:10,64:14,72:15,96:20,110:23,127:27},ptag:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}},Verdana:{normal:{9:2.5,10:2.5,11:2.5,12:2.5,13:3.5,14:3,18:4,24:5,36:8,48:10,64:12,72:15,96:21,110:24,127:28},bold:{9:2.5,10:2.5,11:2.5,12:2.5,13:3.5,14:3.5,18:4,24:5,36:8,48:10,64:12,72:15,96:21,110:24,127:28},ascender:{9:0,10:2,11:2,12:2,13:3,14:1,18:4,24:5,36:7,48:10,64:12,72:15,96:21,110:24,127:28},ptag:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}},Helvetica:{normal:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},bold:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},ascender:{9:1.5,10:1.5,11:2,12:2,13:2,14:2,18:3,24:5,36:8,48:10,64:14,72:16,96:22,110:26,127:30},ptag:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}},Courier:{normal:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},bold:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},ascender:{9:2,10:2,11:3,12:2,13:3,14:3,18:4,24:6,36:9,48:13,64:16,72:19,96:23,110:28,127:30},ptag:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}},Times:{normal:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},bold:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},ascender:{9:1,10:2,11:2,12:2,13:2,14:2,18:3,24:6,36:10,48:11,64:16,72:18,96:25,110:26,127:30},ptag:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}},"Times New Roman":{normal:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},bold:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0},ascender:{9:1,10:2,11:2,12:2,13:2,14:2,18:3,24:6,36:10,48:11,64:16,72:18,96:25,110:26,127:30},ptag:{9:0,10:0,11:0,12:0,13:0,14:0,18:0,24:0,36:0,48:0,64:0,72:0,96:0,110:0,127:0}}},TextData=_gliffy.Class.extend({init:function(){this.lines=[];this._currentLine=null;this._styleStack=[];this._styleStack.push({})},parseText:function(text){var root,i,children,textData=new TextData();root=document.createElement("div");root.innerHTML=text;children=root.childNodes;for(i=0;i<children.length;i++){this.__parseTextNode(children[i],textData)}return this},__parseTextNode:function(node){var children,i;this._styleStack.push($.extend({},this.getCurrentStyle()));if(node.nodeType===1){if(node.tagName==="P"||node.tagName==="BR"){this.appendLine();this.__parseCss(node.style.cssText)}else{if(node.tagName==="SPAN"){this.__parseCss(node.style.cssText)}else{if(node.tagName==="A"){this.setCurrentStyle("color","blue");this.setCurrentStyle("text-decoration","underline");this.setCurrentStyle("href",node.getAttribute("href"));this.__parseCss(node.style.cssText)}else{if(node.tagName==="STRONG"){this.setCurrentStyle("font-weight","bold")}else{_gliffy.Logger.warn("TextCanvas.js invalid text element="+node.tagName)}}}}}else{if(node.nodeType===3){this.appendText(node.textContent)}else{_gliffy.handleError("com.gliffy.error.invalid_text_element")}}children=node.childNodes;for(i=0;i<children.length;i++){this.__parseTextNode(children[i])}this._styleStack.pop()},__parseCss:function(cssText){if(cssText&&cssText.length>0){var styles=cssText.split(";"),i;for(i=0;i<styles.length;i++){this.__parseCssStyle(styles[i])}}},__parseCssStyle:function(cssStyle){var name,value;if(cssStyle&&cssStyle.length>0){cssStyle=cssStyle.split(":");if(cssStyle[0]&&cssStyle[1]){name=cssStyle[0].trim();value=cssStyle[1].trim();this.setCurrentStyle(name,value)}}},appendLine:function(){this._currentLine={textBlocks:[],style:{}};this.lines.push(this._currentLine)},setCurrentStyle:function(name,value){this.getCurrentStyle()[name]=value},appendText:function(text){this._currentLine.textBlocks.push({text:text,style:$.extend({text:text},this.getCurrentStyle())})},getCurrentStyle:function(){return this._styleStack[this._styleStack.length-1]},getOldStyleLines:function(){var i,j,lines=[],line,textBlock,startIndex;for(i=0;i<this.lines.length;i++){if(this.lines[i].textBlocks.length>0){line={};line.align=this.lines[i].textBlocks[0].style["text-align"]||"center";line.text="";line.formats=[];startIndex=0;for(j=0;j<this.lines[i].textBlocks.length;j++){textBlock=this.lines[i].textBlocks[j];line.formats.push({startIndex:startIndex,bold:textBlock.style["font-weight"]==="bold",italic:textBlock.style["font-style"]==="italic",underline:textBlock.style["text-decoration"]==="underline",color:textBlock.style.color||"#000000",size:parseInt(textBlock.style["font-size"],10)||12,face:(textBlock.style["font-family"]||"Arial").replace(/['"]/g,""),href:textBlock.style.href});line.text+=textBlock.text;startIndex+=textBlock.text.length}lines.push(line)}}return lines}});_gliffy.Renderer.TextCanvas=_gliffy.Renderer.extend({id:"Gliffy.Renderer.TextCanvas",target:null,init:function(){_gliffy.renderers[this.id]=this},render:function(o){if(!o){throw"text renderer needs options"}if(!o.target){throw"needs a target canvas context"}if(!(o.object&&o.object instanceof _gliffy.Text)){throw"needs a text object to render!"}var options=$.extend({},{renderCallback:null},o),context=options.target,object=options.object,textData=new TextData(),lines,textResult,transform,result,textXOffset,textVOffset,j,padding_left,padding_right,padding_top,padding_bottom,underline_offset,i,offsetY,scale;lines=textData.parseText(object.getHTML()).getOldStyleLines();textResult=this.__calculateResult(lines,object);if(object.getOverflow()==="none"){textResult=this.__calculateResult(lines,object)}offsetY=(object.getValign()==="middle")?(object.node.getHeight()/2)-(object.getCalculatedHeight()/2):0;context.save();transform=object.node.worldTransform.getValues();if(!o.ignorePan){context.translate(object.node.stage.pan_x,object.node.stage.pan_y)}scale=object.node.stage.zoom;if(o.ignoreZoom){scale=1}context.scale(scale,scale);context.transform(transform[0],transform[1],transform[2],transform[3],transform[4],transform[5]);context.translate(object.style.x,object.style.y+offsetY);for(i=0;i<textResult.length;i++){result=textResult[i].result;textXOffset=textResult[i].textXOffset;textVOffset=textResult[i].textVOffset;for(j=0;j<result.value.fragments.length;j++){context.font=result.value.fragments[j].fontString;if(object.style.text_background_fill){context.save();context.fillStyle=object.node.stage.background;padding_left=(j===0)?2:0;padding_right=(j===result.value.fragments.length-1)?4:0;padding_top=(i===0)?0:-2;padding_bottom=(i===textResult.length-1)?4:2;context.fillRect(textXOffset-padding_left,textVOffset-result.value.fragments[j].height-padding_top,result.value.fragments[j].width+padding_right,result.value.fragments[j].height+padding_bottom);context.restore()}if(result.value.fragments[j].underline&&context instanceof window.C2S){context.__fontUnderline="underline"}else{context.__fontUnderline="none"}if(result.value.fragments[j].format.href&&context instanceof window.C2S){context.__fontHref=result.value.fragments[j].format.href}else{context.__fontHref=""}context.fillStyle=result.value.fragments[j].fillStyle;context.fillText(result.value.fragments[j].text,textXOffset,textVOffset);if(result.value.fragments[j].underline&&!(context instanceof window.C2S)){context.strokeStyle=result.value.fragments[j].fillStyle;context.lineWidth=1;context.beginPath();underline_offset=result.value.fragments[j].height*0.07;context.moveTo(textXOffset,textVOffset+underline_offset);context.lineTo(textXOffset+result.value.fragments[j].width,textVOffset+underline_offset);context.stroke()}textXOffset+=result.value.fragments[j].width}}context.restore();if(options.renderCallback){options.renderCallback()}},__buildCanvasFontString:function(format){var font="";if(format.italic){font+="italic "}if(format.bold){font+="bold "}if(font.length===0){font+="normal "}font+=format.size+"px "+format.face;return font},__measureFormattedText:function(text,hardTextLine,formatOffset,textGraphic){var measure={width:0,height:0,fragments:[],baseline:0,lineHeight:0,ascender:null,ptag:null},i=0,format,endIndex,startIndex,fragment,width,height,baselineDiff,style,browser,font,fontFix;do{format=hardTextLine.formats[i];endIndex=(i+1<hardTextLine.formats.length)?hardTextLine.formats[i+1].startIndex:-1;if(endIndex===-1||endIndex>=formatOffset){startIndex=format.startIndex-formatOffset;endIndex=(endIndex===-1)?text.length:endIndex-formatOffset;font=this.__buildCanvasFontString(hardTextLine.formats[i]);this.__tcontext.font=font;fragment=text.substring(startIndex,endIndex);width=this.__tcontext.measureText(fragment).width;style=((format.bold)?"bold":"normal");if(!FONT_FIXES[format.face]){format.face="Arial"}if(FONT_FIXES[format.face]&&FONT_FIXES[format.face][style]&&FONT_FIXES[format.face][style][format.size]){fontFix=FONT_FIXES[format.face][style][format.size]}else{fontFix=0}height=format.size+fontFix;measure.width+=width;measure.height=Math.max(measure.height,height);if(fragment.length>0){measure.lineHeight=Math.max(measure.lineHeight,format.size+fontFix+"px");if(measure.ascender===null){measure.ascender=FONT_FIXES[format.face].ascender[format.size]||0}else{measure.ascender=Math.max(measure.ascender,FONT_FIXES[format.face].ascender[format.size]||0)}if(measure.ptag===null){measure.ptag=FONT_FIXES[format.face].ptag[format.size]||0}else{measure.ptag=Math.max(measure.ptag,FONT_FIXES[format.face].ptag[format.size]||0)}measure.fragments.push({text:fragment,width:width,height:height,format:format,fontString:font,fillStyle:format.color,underline:format.underline})}}else{endIndex=endIndex-formatOffset}i++}while(i<hardTextLine.formats.length&&endIndex<text.length);return measure},__binarySearch:function(text,hardTextLine,target,low,high,formatOffset,max,textGraphic){var mid,value,width,current;if(high>=low){mid=low+Math.floor((high-low)/2);value=this.__measureFormattedText(text.substring(0,mid+1),hardTextLine,formatOffset,textGraphic);width=value.width;current={index:mid,value:value};if(max===null){max=current}if(width>target){return this.__binarySearch(text,hardTextLine,target,low,mid-1,formatOffset,max,textGraphic)}else{if(width<target){return this.__binarySearch(text,hardTextLine,target,mid+1,high,formatOffset,current,textGraphic)}else{mid=this.__findBreak(text,mid);return(mid<0||mid===current.index||current.index===text.length-1)?current:{index:mid,value:this.__measureFormattedText(text.substring(0,mid+1),hardTextLine,formatOffset,textGraphic)}}}}else{mid=this.__findBreak(text,max.index);return(mid<0||mid===max.index||max.index===text.length-1)?max:{index:mid,value:this.__measureFormattedText(text.substring(0,mid+1),hardTextLine,formatOffset,textGraphic)}}},__findBreak:function(text,max){var breakIndexSpace=text.lastIndexOf(" ",max),breakIndexHyphen=text.lastIndexOf("-",max);return Math.max(breakIndexSpace,breakIndexHyphen)},__calculateResult:function(lines,textGraphic){this.__tcontext=_gliffy.Utils.getContext($('<canvas style="display:none;white-space: nowrap;"></canvas>').appendTo("body").get(0));var textVOffset=0,textXOffset=0,i=0,text,increment,formatOffset,result,h,canvasVOffset;this.__cachedResult=[];for(i=0;i<lines.length;i++){text=lines[i].text;if(text.length===0){increment=lines[i].formats[0].size;textGraphic.style.height+=increment;textVOffset+=increment}else{formatOffset=0;while(text.length>0){if(textGraphic.getOverflow()===OVERFLOW.none){result=this.__binarySearch(text,lines[i],textGraphic.style.width,0,text.length-1,formatOffset,null,textGraphic)}else{result={index:text.length-1,value:this.__measureFormattedText(text,lines[i],formatOffset,textGraphic)}}if(lines[i].align==="right"){textXOffset=(textGraphic.style.width-result.value.width)}else{if(lines[i].align==="center"){textXOffset=(textGraphic.style.width-result.value.width)/2}else{textXOffset=0}}h=parseInt(result.value.height,10);textVOffset=textVOffset+h;canvasVOffset=textVOffset-result.value.ascender;textVOffset+=result.value.ptag;this.__cachedResult.push({textXOffset:textXOffset,textVOffset:canvasVOffset,height:h,lineHeight:result.value.lineHeight,result:result});text=text.substring(result.index+1);textGraphic.style.height=textVOffset;if(textGraphic.getOverflow()!==OVERFLOW.none){textGraphic.style.width=Math.max(textGraphic.style.width,result.value.width)}formatOffset+=result.index+1}}}$(this.__tcontext.canvas).remove();return this.__cachedResult}})}());(function(){_gliffy.Renderer.TextDom=_gliffy.Renderer.extend({id:"Gliffy.Renderer.TextDom",target:null,__vertical_offset:0,__middle_valign_offset:0,init:function(){_gliffy.renderers[this.id]=this},render:function(o){if(!o){throw new Error("text renderer needs options")}if(!o.container){throw new Error("needs a target container")}if(!(o.object&&o.object instanceof _gliffy.Text)){throw new Error("needs a text object to render!")}var options=$.extend({},{renderCallback:null},o),object=options.object,container=options.container,domStage=options.stage,stage=object.node.stage,zIndex=options.zIndex,offsetY,transform,padding,bounds,createTextNodes;if(!(object.editable.isEditable&&object.editable.getEditMode())&&(object.node.hasRepositionCanvasFlag()||object.node.hasRedrawCanvasFlag())){createTextNodes=!object.__cachedDomResult||object.node.hasRepositionCanvasFlag();if(createTextNodes){object.node.getDomElement().remove();object.__cachedDomResult=this.__buildDomObject(object);domStage.append(object.__cachedDomResult)}object.__cachedDomResult.data("node",object.node);if(!options.zIndex){zIndex=0}this.__middle_valign_offset=(object.node.getHeight()/2)-(object.getCalculatedHeight()/2);offsetY=(object.getValign()==="middle")?this.__middle_valign_offset+this.__vertical_offset:this.__vertical_offset;transform=object.node.worldTransform;transform=new _gliffy.AffineTransform(1,0,0,1,0,0).scale(object.node.stage.zoom,object.node.stage.zoom).concatenate(transform).translate(object.style.x,object.style.y+offsetY);padding=(object.style.text_background_fill||object.style.overflow!=="none")?2:0;if(createTextNodes||object.node.hasRepositionCanvasFlag()){object.__cachedDomResult.css($.extend(_gliffy.Utils.transformCss(transform,{roundTranslate:true}),{width:this.__getObjectWidth(object)+padding,height:object.style.height+padding,visibility:"visible",position:"absolute",zIndex:zIndex,display:"block",margin:0,padding:0}))}if(object.isComputePositioning()){object.markDirty();object.update();object.node.getDomElement().remove();object.__cachedDomResult=this.__buildDomObject(object);object.__cachedDomResult.data("node",object.node);transform=object.node.worldTransform;transform=new _gliffy.AffineTransform(1,0,0,1,0,0).scale(object.node.stage.zoom,object.node.stage.zoom).concatenate(transform).translate(object.style.x,object.style.y+offsetY);padding=(object.style.text_background_fill)?2:0;object.__cachedDomResult.css($.extend(_gliffy.Utils.transformCss(transform,{roundTranslate:true}),{width:this.__getObjectWidth(object)+padding,height:object.style.height+padding,visibility:"visible",position:"absolute",zIndex:zIndex,display:"block",margin:0,padding:0}));domStage.append(object.__cachedDomResult);object.positionComputed()}object.__cachedDomResult.data("transform",transform);if(stage.autoFit){bounds=_gliffy.Utils.maxBounds(transform,object.style.width+padding,object.style.height+padding,stage);object.node.current_bounds=bounds;if(bounds.x>stage.width||bounds.y>stage.height){stage.width=Math.max(stage.width,bounds.x);stage.height=Math.max(stage.height,bounds.y)}}object.node.resetFlags();if(options.renderCallback){options.renderCallback()}}},__getObjectWidth:function(object){return(_gliffy.BrowserDetect.browser==="Firefox")?object.style.width+1:object.style.width},__buildDomObject:function(object){var textNode,class_,bgcolor="transparent",shapeInfo,themeType;class_="gliffy-text gliffy-graphic gliffy-rte-text";if(object.node.parent){if(object.node.parent.isLine()){class_+=" gliffy-text-with-line-parent";bgcolor=object.node.stage.background==="transparent"?"#ffffff":object.node.stage.background}else{if(object.node.parent.isShape()){shapeInfo=object.node.parent.getShapeInformation();themeType=(shapeInfo&&shapeInfo.defaults&&shapeInfo.defaults.themeType)?shapeInfo.defaults.themeType:null;if(themeType){class_+=" gliffy-text-with-shape-parent-"+themeType}}}}else{class_+=" gliffy-text-standalone"}textNode=$("<div/>",{id:object.node._domId,"class":class_}).css({width:this.__getObjectWidth(object),height:object.style.height,visibility:"hidden",overflow:"visible",display:"block",margin:0,padding:0,backgroundColor:bgcolor}).append(object.getHTML());return textNode}})}());(function(){_gliffy.Renderer.ShapeCanvas=_gliffy.Renderer.extend({id:"Gliffy.Renderer.ShapeCanvas",target:null,init:function(){_gliffy.renderers[this.id]=this},render:function(o){if(!o){throw new Error("shape renderer needs options")}if(!o.target){throw new Error("needs a target canvas context")}if(!o.object){throw new Error("no shape to render")}var ctx=o.target,object=o.object,renderCallback=o.renderCallback,transform,values,offsetX,offsetY,scale=object.node.stage.zoom,data,shadow_scale_x,shadow_scale_y,originalFill,pan_x,pan_y;originalFill=object.style.fill;if(originalFill==="none"){object.style.fill="rgba(255,255,255,"+_gliffy.MIN_OPACITY+")"}if(object.style.single_canvas){if(o.ignoreZoom){scale=1}pan_x=(o.ignorePan)?0:object.node.stage.pan_x;pan_y=(o.ignorePan)?0:object.node.stage.pan_y;transform=new _gliffy.AffineTransform(1,0,0,1,0,0).translate(pan_x,pan_y).scale(scale,scale).concatenate(object.node.worldTransform);values=transform.getValues();object.style.matrix_a=values[0];object.style.matrix_b=values[1];object.style.matrix_c=values[2];object.style.matrix_d=values[3];object.style.matrix_e=values[4];object.style.matrix_f=values[5];offsetX=(object.style.stroke_width%2===1)?0.5:0;offsetY=(object.style.stroke_width%2===1)?0.5:0}else{offsetX=object.style.offset_x;offsetY=object.style.offset_y}data=object.style;ctx.save();ctx.translate(offsetX*scale,offsetY*scale);ctx.transform(data.matrix_a,data.matrix_b,data.matrix_c,data.matrix_d,data.matrix_e,data.matrix_f);if(object.isDropShadow()&&!(object.getFillColor()==="none"&&object.getStrokeWidth()===0)){ctx.save();if(originalFill!=="none"){shadow_scale_x=(object.style.width+object.style.stroke_width/2)/object.style.width;shadow_scale_y=(object.style.height+object.style.stroke_width/2)/object.style.height;ctx.translate(object.style.shadow_x,object.style.shadow_y);ctx.scale(shadow_scale_x,shadow_scale_y);_gliffy.shapeLibrary.drawStencil(object.getTid(),ctx,$.extend({},object.style,{fill:"#000000",opacity:0.294117647,stroke:"none",gradient:false}),_gliffy)}else{if(object.style.stroke_width>0){ctx.translate(object.style.shadow_x,object.style.shadow_y);_gliffy.shapeLibrary.drawStencil(object.getTid(),ctx,$.extend({},object.style,{opacity:0.294117647,fill:"none",gradient:false}))}}ctx.restore()}if(_gliffy.shapeLibrary.canDrawStencil(object.getTid())){_gliffy.shapeLibrary.drawStencil(object.getTid(),ctx,data);object.node.resetFlags()}ctx.restore();object.style.fill=originalFill;if(renderCallback){renderCallback()}}})}());(function(){_gliffy.Renderer.SvgCanvas=_gliffy.Renderer.extend({id:"Gliffy.Renderer.SvgCanvas",target:null,init:function(){_gliffy.renderers[this.id]=this},render:function(o){if(!o){throw new Error("svg renderer needs options")}if(!o.target){throw new Error("needs a target canvas context")}if(!o.object){throw new Error("no svg to render")}var ctx=o.target,object=o.object,renderCallback=o.renderCallback,transform,values,offsetX,offsetY,scale=object.node.stage.zoom,data,originalFill,pan_x,pan_y,dim,svg;originalFill=object.style.fill;if(originalFill==="none"){object.style.fill="rgba(255,255,255,"+_gliffy.MIN_OPACITY+")"}if(object.style.single_canvas){if(o.ignoreZoom){scale=1}pan_x=(o.ignorePan)?0:object.node.stage.pan_x;pan_y=(o.ignorePan)?0:object.node.stage.pan_y;transform=new _gliffy.AffineTransform(1,0,0,1,0,0).translate(pan_x,pan_y).scale(scale,scale).concatenate(object.node.worldTransform);values=transform.getValues();object.style.matrix_a=values[0];object.style.matrix_b=values[1];object.style.matrix_c=values[2];object.style.matrix_d=values[3];object.style.matrix_e=values[4];object.style.matrix_f=values[5]}offsetX=(object.style.single_canvas)?0:object.style.offset_x;offsetY=(object.style.single_canvas)?0:object.style.offset_y;data=object.style;ctx.save();ctx.translate(offsetX*scale,offsetY*scale);ctx.transform(data.matrix_a,data.matrix_b,data.matrix_c,data.matrix_d,data.matrix_e,data.matrix_f);svg=object.node.stage.gon.getEmbeddedResources().getResource(object.getEmbeddedResourceId()).getData();dim=_gliffy.shapeLibrary.svgDim[svg];ctx.scale(object.style.width/dim.width,object.style.height/dim.height);ctx.translate(-dim.x,-dim.y);if(_gliffy.shapeLibrary.canDrawStencil(svg)){_gliffy.shapeLibrary.drawStencil(svg,ctx,data);object.node.resetFlags()}ctx.restore();object.style.fill=originalFill;if(renderCallback){renderCallback()}}})}());(function(){_gliffy.Renderer.LineCanvas=_gliffy.Renderer.extend({id:"Gliffy.Renderer.LineCanvas",target:null,init:function(){_gliffy.renderers[this.id]=this},render:function(o){if(!o){throw new Error("line renderer needs options")}if(!o.target){throw new Error("needs a target canvas context")}if(!o.object){throw new Error("no line to render")}var context=o.target,object=o.object,callback=o.renderCallback,self=this;if(object.getFillColor()&&object.getFillColor()!=="none"&&object.getFillColor()!==object.getStrokeColor()){o.renderCallback=function(){o.renderCallback=function(){if(callback){callback()}};self._renderFillLine(o)}}this._render(o)},_render:function(o){if(!o){throw new Error("line renderer needs options")}if(!o.target){throw new Error("needs a target canvas context")}if(!o.object){throw new Error("no line to render")}var style,context=o.target,line,object=o.object,data=object.style,callback=o.renderCallback,scale=object.node.stage.zoom,c,tmpCtx,transform,values,pan_x,pan_y;line=new _gliffy.Linevg(object.getDrawCommands());if(!object.style.single_canvas){this._pushContextMatrix(context,data,scale);if(object.editable.isEditable){style=$.extend({},data,{stroke:object.node.stage.background==="transparent"?"#ffffff":object.node.stage.background,stroke_width:data.stroke_width+object.OVERLAY_EXTEND,opacity:0.008,stroke_dasharray:null,start_arrow:"none",end_arrow:"none"});line.drawPath(context,style)}if(object.getOverlay()){style=$.extend({},data,{stroke_width:data.stroke_width+object.OVERLAY_DISPLAY_EXTEND,stroke:"#97bfe0",stroke_dasharray:null,start_arrow:"none",end_arrow:"none"});line.drawPath(context,style)}line.drawPath(context,data);this._popContextMatrix(context)}else{if(o.ignoreZoom){scale=1}object.style.matrix_a=scale;object.style.matrix_b=0;object.style.matrix_c=0;object.style.matrix_d=scale;object.style.matrix_e=0;object.style.matrix_f=0;if(!object.getStartArrow()&&!object.getEndArrow()&&context instanceof window.C2S){tmpCtx=new C2S(object.style.graphic_width*scale,object.style.graphic_height*scale);c=tmpCtx.canvas}else{c=document.createElement("canvas");c.width=object.style.graphic_width*scale;c.height=object.style.graphic_height*scale;tmpCtx=_gliffy.Utils.getContext(c)}this._pushContextMatrix(tmpCtx,data,scale);line.drawPath(tmpCtx,data);this._popContextMatrix(tmpCtx);transform=new _gliffy.AffineTransform(1,0,0,1,0,0).scale(scale,scale).translate(object.style.pos_x,object.style.pos_y).translate(-object.style.offset_x,-object.style.offset_y).scale(1/scale,1/scale);values=transform.getValues();context.save();context.transform(values[0],values[1],values[2],values[3],values[4],values[5]);context.drawImage(c,0,0);context.restore()}if(callback){callback()}},_pushContextMatrix:function(context,style,scale){context.save();context.translate(-style.pos_x*scale,-style.pos_y*scale);context.translate(style.offset_x*scale,style.offset_y*scale);context.transform(style.matrix_a,style.matrix_b,style.matrix_c,style.matrix_d,style.matrix_e,style.matrix_f)},_popContextMatrix:function(context){context.restore()},_renderFillLine:function(o){if(!o){throw new Error("line renderer needs options")}if(!o.target){throw new Error("needs a target canvas context")}if(!o.object){throw new Error("no line to render")}var context=o.target,object=o.object,callback=o.renderCallback,scale=object.node.stage.zoom,fillStyle=$.extend({},object.style),c,tmpCtx,fillLine,transform,values,offset,strokeScale=[1,2,3,17];fillStyle.stroke=object.style.fill;this.generateArrowMarkerAttributes("start",fillStyle,fillStyle.start_arrow);this.generateArrowMarkerAttributes("end",fillStyle,fillStyle.end_arrow);if(object.style.stroke_width===6&&((fillStyle.start_arrow&&strokeScale.indexOf(fillStyle.start_arrow)!==-1)||(fillStyle.end_arrow&&strokeScale.indexOf(fillStyle.end_arrow)!==-1))){fillStyle.stroke_width=object.style.stroke_width-0.3;offset=1}else{fillStyle.stroke_width=object.style.stroke_width>3?object.style.stroke_width-2:object.style.stroke_width;offset=2}fillStyle.offset_y-=2;fillStyle.path=this._calculatePath(object,fillStyle,offset);if(!object.getStartArrow()&&!object.getEndArrow()&&context instanceof window.C2S){tmpCtx=new C2S(object.style.graphic_width*scale,object.style.graphic_height*scale);c=tmpCtx.canvas}else{c=document.createElement("canvas");c.width=object.style.graphic_width*scale;c.height=object.style.graphic_height*scale;tmpCtx=_gliffy.Utils.getContext(c)}this._pushContextMatrix(tmpCtx,object.style,object.node.stage.zoom);fillLine=new _gliffy.Linevg(fillStyle.path);fillLine.drawPath(tmpCtx,fillStyle);this._popContextMatrix(tmpCtx);if(object.style.single_canvas){context.save();transform=new _gliffy.AffineTransform(1,0,0,1,0,0).scale(object.node.stage.zoom,object.node.stage.zoom).translate(object.style.pos_x,object.style.pos_y).translate(-object.style.offset_x,-object.style.offset_y).scale(1/scale,1/scale);values=transform.getValues();context.transform(values[0],values[1],values[2],values[3],values[4],values[5]);context.drawImage(c,0,0);context.restore()}else{context.drawImage(c,0,0)}if(callback){callback()}},generateArrowMarkerAttributes:function(arrowPos,style,arrowType){if(arrowType===17){switch(style.stroke_width){case 4:style["marker_"+arrowPos+"_width"]+=7;style["marker_"+arrowPos+"_height"]+=7;break;case 5:style["marker_"+arrowPos+"_width"]+=4;style["marker_"+arrowPos+"_height"]+=4;break;case 7:style["marker_"+arrowPos+"_width"]+=1;style["marker_"+arrowPos+"_height"]+=1;break;case 9:style["marker_"+arrowPos+"_width"]+=0.5;style["marker_"+arrowPos+"_height"]+=0.5;break}}else{if(arrowType<4){switch(style.stroke_width){case 4:style["marker_"+arrowPos+"_width"]+=7.6;style["marker_"+arrowPos+"_height"]+=7.6;break;case 5:style["marker_"+arrowPos+"_width"]+=5;style["marker_"+arrowPos+"_height"]+=5;break;case 7:style["marker_"+arrowPos+"_width"]+=2.9;style["marker_"+arrowPos+"_height"]+=2.9;break;case 9:style["marker_"+arrowPos+"_width"]+=2.1;style["marker_"+arrowPos+"_height"]+=2.1;break}}else{switch(style.stroke_width){case 4:style["marker_"+arrowPos+"_width"]-=6;style["marker_"+arrowPos+"_height"]-=6;break;case 5:style["marker_"+arrowPos+"_width"]-=6;style["marker_"+arrowPos+"_height"]-=6;break;case 7:style["marker_"+arrowPos+"_width"]-=8;style["marker_"+arrowPos+"_height"]-=8;break;case 9:style["marker_"+arrowPos+"_width"]-=10;style["marker_"+arrowPos+"_height"]-=10;break}}}},_calculatePath:function(object,fillStyle,offset){var distance,startDistance,endDistance,startPoint,endPoint;distance=object.getPathLength();startDistance=0;if(fillStyle.start_arrow>0){startDistance=offset}endDistance=distance.totalDistance;if(fillStyle.end_arrow>0){endDistance=distance.totalDistance-offset}startPoint=object.getPointInPathAtDistance(startDistance);endPoint=object.getPointInPathAtDistance(endDistance);return this._buildStylePath(object.getDrawCommands(),startPoint,endPoint)},_buildStylePath:function(path,start,end){var newPath=[],i=0,args;for(i=0;i<path.length;i++){newPath.push({name:path[i].name,args:path[i].args})}if(start){newPath[0].args=start.x+","+start.y}if(end){args=newPath[newPath.length-1].args.split(" ");args.pop();args.push(end.x+","+end.y);newPath[newPath.length-1].args=args.join(" ")}return newPath}})}());(function(){var imageNotAvailable="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAWdEVYdENyZWF0aW9uIFRpbWUAMTEvMjAvMTL51e9HAAAgAElEQVR4nO3dOXAbV7YG4L+xA1ywL6TElA6HE1KpUjnVhKPslSdV5rKjp3KmeplcL5NDK6VSpVQyVUNHU48pKRLERuw70C/gnOsGCIAg2EB3A/8X2WMOcUkC+HHuuYv2z3/+UwcREdEjeeQfXC6XleMgIiKHGA6HAP4TIC6XC3/961/RbrfRbrcRCAQQCAQsHSAREdmPruv497//DV3X/6xAAKDdbuP29hYejwfJZJIhQkREiq7rKBQKCAQCGA6HGJm3CgQC8Hg86PV6yGaz6HQ6Vo2TiIhsZDAYoFAooFarAQC63e79AEkmk3C5XBgOh8jlcmi325YMloiI7EPCQ9M0dLtdtNtt3OucBwIB7O3twev1shIhItpwUkw0Gg0AQDgcRqvVgq7r9wMEAPx+/0glcnNzw0qEiGjD6LqOfD6Per0OANjd3UU0GlX/feraXalEPB4P+v0+crkcut3u8kdMRESWGw6HyOfzaDQa0DQN0WgU8Xgcmqapr5m5+cPv9yOVSsHtdqPf7+P6+prTWUREa24wGCCXy6nKY2dnB9FodCQ8gAcCBLirRNLpNFwul/qmrESIiNZXoVBAs9mEpmmIRCKIx+MTv26u7ecSIrLE9+rqiiFCRLRmBoMBstmsmraKRCKIxWL3Kg8x9/klwWAQqVQKmqapxjqns4iI1kc+n0ez2QQARCIRRCKRmV//qAOwAoEAMpmMqkRubm5YiRAROdxgMMDNzY0Kj3g8PrHnMe7RJygGg0Ekk0nVWOc+ESIi55q02iocDs/1/13oCF4JEZfLhX6/j3w+z0qEiMhhZJ+HsWH+0LSV0cJnuIdCIdVY73a7bKwTETmITFvJDvNIJDLXtJXRky4BkUpEGuu5XI7TWUREDvCUykM8+RapYDCozs7qdrvIZrOsRIiIbEqW6kp4xGKxmUt1ZzHlGsJAIIBEIqE2G3KJLxGR/QyHQ7VJELg722rehvkkpt1jK/tEZIkvd6wTEdmH8VRdY+XxFKZehB4KhdQS316vh+vra4YIEZHF5EBcqTzC4TAikchC01ZGpgYIMLrEV87O6vV6Zj8MERHNQdd1FR7SMDceyf4UpgcIcFeJyCm+ssS33+8v46GIiGiKfr+v7nN6asN8kqUECHAXIolEApqmqa4/p7OIiFZj0ibB3d1dUx9jaQECAFtbW0in06oS4XQWEdHyyYf2VqsFTdPmPtvqsZYaIMCfjXWXy4Vut8vGOhHREknvWcJjGZWHWHqAAKPTWXJ2FisRIiJzScO81WrB5XIhHo8vtMN8XisJEADY3t5WZ2d1Oh1cXV0xRIiITCKno49XHmZPWxmtLECAu0pELmXn9bhERObQdR2FQkGFRywWe9IO83mtNECAu8a67FjvdDrIZrOsRIiIFtTv93F9fa1WW8XjcYTD4aVWHmLlAQLchYixJ8KbDYmIHm8wGKBQKKh9HstsmE9iSYAA91dn5XI5bjYkIprTcDhU19C6XC7EYrGlNswnsSxAgLvGunHH+rdv3zidRUT0ADnbqt1uA7i7DGpV01ZGlgYIcH/HOjcbEhFNp+u6us9DKo9VNMwnsTxAgD8b6263WzXWB4OB1cMiIrIVaZh3u1212sqMU3UXZYsAAe5CRJb49no9rs4iIjKQGRrjwYirbJhPYpsAAe56ItJY73Q6uLm5ga7rVg+LiMhScrZVu92Gy+VCMpm0bNrKyFYBAvwZIpqmodvt4vLykpUIEW0s2erQ6XSgaRqi0Si2t7etHhYAGwYIcDedJSEi1+NyiS8RbRpd19V9Hi6XC4lEwhaVh7BlgACjS3w7nQ6ur68ZIkS0MeRacKk84vE4dnZ2rB7WCNsGCDC6Y73X6+Hm5obTWUS09uQyKGmY2zE8AJsHCPBniBgb61ziS0Trqt/v4+rqSoVHIpGwfLXVNLYPEADY2dkZaaxfX1+zEiGitSNLde08bWXkiAABRqezut0u8vk8eyJEtDbGl+raufIQjgkQ4K4SkcZ6u93G9fU1p7OIyPHGl+ravfIQjgoQ4K4SicViI411ViJE5FTGHeZytpUTwgNwYIAAd5WINNbb7TZ3rBORI8lSXWPD3E77PB7iyAAB7kJEzs6SfSJsrBORU/T7feTz+ZGDEe2yw3xejg0QYDRE2u028vk8KxEisj1j5eF2u5FKpRxVeQhHBwgA7O7uqtVZ7XYbV1dX7IkQkW31ej3k83n0ej1VeWxtbVk9rIU4PkCA+9NZuVyOq7OIyHaMS3XdbjeSyaRjGuaTrEWAAH9WItJY56VURGQnxuOYpGHutJ7HuLUJEOB+JcIlvkRkB+NLdROJhGOnrYzWKkCAuxCJxWKqEsnlcmysE5Fler0erq6u0Ol01GVQTp62Mlq7AAGAcDg80lj/9u0bKxEiWjm5z0imreLx+FpUHmItAwS4u09EdqzL2VnsiRDRqkjDvNPpqKW661J5iLUNEOCuEpE71lutFs/OIqKV6PV6yGazIw3zdao8xFoHCHC/EuH1uES0TIPBAPl8XvU81jU8gA0IEODP1VlSibCxTkTL0O128e3bN7Xaap0a5pNsRIBomobd3V1Eo1HVWOcSXyIyk+ww7/f7a9kwn2QjAkTs7u4iEolA0zQ0m02enUVEpjAu1fV4PEin02tdeYiNChBN0xCNRtVmw1arxR3rRPQk0lsdDAaq8giFQlYPayU2KkCEsRKRnghDhIgeS1ZbSeWRSqXWftrKaCMDBAAikQgb60S0sG63q3qp67xUd5aNDRBprBsrkWw2y8Y6ET2o3+8jl8uh2+2q1VabMm1ltLEBIsLhsNonIpUIEdE0vV4P3759Q7fbVTvMnX6q7qI2PkA0TUM4HB652fD6+pqVCBHdI9NW0jBPJBIbWXmIjQ8QYdwn0mq1UCgU2FgnImUwGOD6+lpVHplMZuN6HuMYIAYyneVyudBsNnFzc4PhcGj1sIjIYt1uV52lp2kakskkgsGg1cOyHAPEQKazIpEIAKj7RFiJEG0uuQxKGubpdHqjp62MGCATGBvrsmOdiDZPt9vF5eWlCo9UKsXwMGCATKBpGiKRCKLRKACg2WxyxzrRhhlvmDM87mOAzBAOhxEOh3l2FtGG6Xa7uLq6Qq/Xg9vt5rTVFAyQGeRcG+N0Vi6XY2OdaI11Oh21gEbTNIbHDB6rB+AE4XAYg8EAlUoFjUYDuq4jmUzC7XZbPTQiMpHxeBKPx4NkMolAIGD1sGyLFcicotHoyFHwhULB6iERkYk6nY46zsjtdnOp7hwYIHOSo+AlRBqNBhvrRGui2+2qy6DkbCuGx8MYII8UiUTUPhEu8SVyPmmYd7tddRkUex7zYYA8kvFSKgBqxzorESLn6XQ6amEMd5g/HpvoCwqHwxgOhyiXy6qxnkql4HIxk4mcoNvtqmlor9fLhvkC+G73BDKdxX0iRM4iS3UHgwFcLhcSiQTDYwEMkCcwNtYBoNFocDqLyOZ6vR5yuRx6vZ66hpbTVothgJhgvBLhEl8ie+p2u/j27ZvaYb6pNwmahQFiAk3TEIvF1NlZrESI7Kfb7Y40zNPpNCuPJ2IT3UThcBj9fh/VahWNRkPNrWqaZvXQiDZau91GNpvFcDhU01bseTwdKxATydlZMp1Vq9WQz+d5dhaRheRen+FwqI5kZ3iYgwFiMpnO2tnZAQDU63UUi0WGCJEFJDzkbKtMJsPwMBEDZEni8bg6Cr5Wq7GxTrRi7XZ75GBEVh7mYw9kSWQ6CwAqlQrq9Tp0XUcikeApvkRL1ul0kM/nMRgM4Ha7GR5LwgBZslgsBgDqKHgASKfTVg6JaK11Oh1cXV1B13XuMF8yTmEtmfREjJsN2VgnWg7peei6rq6hZXgsDyuQFZAQ0XUdlUoFtVoNw+EQyWSSZ2cRmUR6HnK2VSqVgt/vt3pYa43vXisUi8VUY73RaKBYLFo9JKK1IJWH9DySySTDYwUYICskjfVwOAwAqNVq3LFO9ETjS3XT6TSnrVaEAWKBaDSK3d1dAHc9kVKpZPGIiJzJeA0tl+quHnsgFtA0DYlEAi6XC+VyGfV6HcDd3hH2RIjm02631YIU7jC3BgPEQtFoFIPBALVaDbVaTU1x8ewsotmMZ1uxYW4dBoiFpBKR3erVahUAGCJEM7RarZGzrdgwtw4DxGISIrquj4RILBbjdBbRGAkPWaqbTqfh8/msHtbG4juUTcTjcezs7EDTNFSrVS7xJRrTarXUqkVpmDM8rMUKxCakFJcAqdfragMiKxHadMaGudvtxt7eHrxer9XD2ngMEJuJx+Mj01m6riOZTFo9LCLLtFotZLNZdbZVKpVieNgEP9rajPREjJsNi8UidF23eGREq9dqtZDP56HrOlwuF9LpNBvmNsIAsSFZzru9vQ3g7iTfQqHAEKGN0mw21Q5zr9eL/f199jxshgFiY4lEAru7u2qZLxvrtCmMq63YMLcvBoiNuVwuJBIJVYnwjnXaBDJtNRwO1TW0nLayJzbRHUA2FlarVbVjPZFIWD0sItPJDnNd1+Hz+ZBMJll52BgDxAFcLtfI6iwJkVgsxh3rtDbGG+actrI/BohDGO9Yr9VqqFQq6o51IqeTTYJythV3mDsDeyAOIpWI9ESq1Spub28tHhXR0zSbTRUebreblYeDsAJxGCntAaBer+P29hbD4ZDTWeRIslRXGubcYe4sDBCHkp5Io9FApVJR/xuRU0jlIQ1z7jB3Hk5hOZTb7UY6ncbOzg6Au+msUqnEzYbkCMaGuZxtxWkr52EF4nDxeBzD4RCNRgPlchnD4ZCNdbK1RqOBXC43Unm43W6rh0ULYAXicHKKr7ESYWOd7KrZbKpjeaSKZuXhXKxA1oCEiFQit7e3GAwGvNmQbKVer6NQKGA4HMLn8yGTycDj4VuQk7ECWSPGY0+kJ0JkB81mUx1PItNWDA/n419wjcgaeuDu057xelxWImSVRqOhriTweDxIp9NcbbUmGCBrKJFIqBN8uWOdrGRsmPv9fiSTSYbHGuEU1hoa37Feq9VQLpe5xJdWqtlsqsqDO8zXEyuQNSWNddlsWCqVVGOdaNnq9bra5+H3+7lJcE2xAlljcux7KBQCcNdYl13rRMtiXKrr8Xg4bbXGGCBrzu12I5PJIBQKQdd1lEol7linpanVaupsK5/Pxx3ma44BsiGSyaQKkUqlgnK5bPWQaM00Go2RfR6ctlp/DJANIbt+t7a2oOs6yuUybm9vWYmQKWSToK7r8Hq9rDw2BJvoG0TTNNVYbzabqgqJRqMWj4ycbFLDnGdbbQZWIBtGVmdJJXJ7e8vGOi1Mpq2k8uC01WZhgGwgmc6S1VnFYpHTWfRo9XpdNcz9fj/29/cZHhuGAbLBpLEOAOVymY11mluj0VDTVjySfXMxQDaYLPFlY50eY3za6tmzZ6w8NhSb6IREIqEa6xIgsVjM6mGRDdVqNRUe0jDnQZ2bixUIqXOKtra2AACVSkWd5EskjKfqer1enqpLDBC643K5kEql1GZDaawTAaM7zP1+P/b29nifBzFA6E9ydlYgEFA9EVYiZOx58DIoMmKA0AiPx4P9/X0Eg0FVifAo+M1VrVZHVlvt7e1x2ooUBghNlEwmVYjc3t6yEtlAtVoNxWJRTVul02ku1aURDBCaSK4elRAplUrqdkNafxIeUnmwYU6TMEBoKpfLNTFEaL1Vq1V1qm4gEGDDnKZigNBMcnYWp7M2g7Hy4MGI9BAGCD3I4/Fgb29Prc4qFouczlpDUnnouo5AIID9/X1WHjQTA4TmlkqlRqazWImsD2PlEQgEkEwmucOcHsQAobl5PB5kMpl7IcJKxNnGp624VJfmxQChR9E0baQSkX0i5EyVSmWkYZ5Op1l50NwYIPRocnaWhAh3rDtTvV5Xh2fKPg/2POgxGCC0EDkK3liJcImvc1QqFeTzeVV5ZDIZrraiR2OA0MLkjnVZnVUqlVCv160eFj2gXq+jVCqphjmX6tKiGCD0JLLE1+fzQdd1FAoFNtZtStf1kaW6crYVp61oUQwQejJN09R01nA4RLFYRK1Ws3pYNKZaraqzrYLBIDKZDBvm9CQMEDKFx+NBKpVSlQins+xD13VUKhXVMOeR7GQWBgiZxu12Y29vT1Ui+XyejXUbKJfLKJVKGA6HCIVC2NvbY8+DTMEAIVO53W4kk0lWIjZRrVbVfS6BQACJRILhQaZhgJDpPB4Pnj17plZnFQoFViIrJgdfyg5zqTw4bUVmYoDQUsiO9UAggOFwiFKpxMb6CtVqNVV5BINBJBIJNszJdAwQWhq5lMrv96vNhpzOWi5pmMs+D1ltxcqDloEBQkslO9alEmFjfbmq1apqmAeDQaRSKVYetDQMEFo6OTtLKhFOZy2HhIdUHtxhTsvGAKGV8Hg82N/fH7mUiiFiDjnQUhrmMm3F8KBlY4DQyhjPzhoOhygUCmg0GlYPy/Gq1araJMjLoGiVGCC0Ul6vF+l0Gl6vVy3xZWN9MZMa5ryGllaJAUIrZ2ysDwYD5PN5TmctYDw8ksmk1UOiDcMAIUt4vV4kk0lViZRKJU5nzUl6HjJtFQwGeRkUWYIBQpbxer3Y29tTlUgul2MlModSqaQqj1AohHQ6DZeLL2VaPT7ryFIej2fk7Cw21merVCrq+uBQKIRkMsnwIMvwmUeWk0pEQoQ9kftkms9YeXCpLlmNAUK24Ha71bEnXOJ7X7lcRqVSUeHBhjnZAQOEbGPSEt9NDxE5VVcORtza2kI6nWblQbbAACFbkTvW/X6/aqxv8j6RcrmswkMqD24SJLtggJDtyPW4Uonk8/mNrESM19BubW2xYU62w2cj2ZLX68Xz589HGuubUokYL4MCoJbqctqK7IYBQraladpIYz2fz6PZbFo9rKWTaSsAbJiTrXHrKtma1+vFs2fPrB7GSkWjUUSjUauHQfQgViBERLQQBggRES2EAUJERAthgBAR0UIYIEREtBAGCBERLYQBQkREC2GAEBHRQhggRES0EAYIEREthAFCREQLYYAQEdFCGCBERLSQjTqN97/+67/UP799+xaHh4cWjmZznZyc4PPnz+rfH/O3OD8/x/v37wEAr169wvfff7+UMS7LxcUF3r17p/7diT+DvI4ODw/x9u3buf+bGcz8+y97rJuAFQhZ7uPHj7a756NYLOL8/Bzn5+emju3Lly8j//7161fTvjfRqjFAyHLFYvHeG6vVTk9P8f79e7x//x6Xl5emfd+zs7ORfy8Wi7i4uDDt+xOt0kZNYZF9ff78GUdHRzg4OLB6KEtzdnaGVqsFAHj+/LkKpq9fvzrq5/7f//1fq4dANsEKhCx1fHys/vnTp08WjmT5Tk9P1T+/efMGwWAQwP2qhMgpWIHMoVgsolgsAsDUZm+z2VSfKOPxOOLx+KMf5/z8XP3zot/DOI7nz58jFAo9+nsI48/91O81zYsXL0b6DV++fMHLly9NfYyLi4uRT/7L+Dke0mw28ccffwC4+9seHBzg6OgIX79+RbFYxNnZGY6OjlY+LjOec3Z5fOPfeRkLZFbxenAaBoiBrO44ODjA69evcX5+jo8fP6onDQAEg0G8fPlSrf64uLjAp0+fRl4IwN0T7M2bNw9OTVxcXODk5ES9uRjF43EcHR3h1atXDz5Zp43j8PAQr1+/xsHBwb2fb5Jms4kvX77gy5cv6sVo/JlevnyJFy9ezBzLY7158wY//vgjgLsVWsfHx09+cTabTXz69Glk2kjM+jk+ffqEi4uLkb/577//rsYjv8vHMlYZEhQSIPLfpwXI6emp+rpZfztRLBbx8ePHqV//1OfcPM+jWcx6zgOzn6/Hx8f4/vvvnxRKVrwenIQBYmB88z09PcVvv/1272tarRY+f/6MVquFo6MjfPjw4d4TCwAuLy/x/v17vH37duobzrTHENJcPj09Xfj7nJ+f4927d/j73/9+L1zGXVxc4Ndffx158xz/mX777Td8/foVP/zwg2mfwOLxOF69eqV+rx8/fsQ//vGPhb/fxcUF3r9/P/HvAsz+OS4uLu79noxN9Gnf8yHGRQJSYR0dHSEYDKLVas2cxvruu+/U3/f8/PzBN9fT01P1MxinCOW/PfU599DzaBaznvPA3d9i1iKHr1+/4uzs7MHvM41VrwcnYYBMIG8iwWAQL168UJ8MjZ8E5UnearVweHiI4+NjJBIJFAoFfP36Fefn52i1Wjg5OZn4ZlgsFkdeSMbvIWP48uULisUiWq0Wfv31V/zyyy/3vs/5+fnI9zk+PsbR0RFCodDIWB7qLzSbzZE33fHxnJ2dqZ/3/Pwcv/76q6lr57///ns1nfPHH3/g/Px8oWmIYrE48+f4v//7P/U4sqfg559/Vv9/eaOZNl0hfYvHjsk4rWj8RCxViITIpCokHo+PNN3Pzs5mfuo1Lg02fj+znnOLMvvxjaE8/rz//Pmz+j7v37/HL7/88qg3eKtfD07BAJmg1WohGAze++Qib2jyAm21Wjg+PsabN29GvubFixf48ccf1ZvhJMaG6vj3kO9zfHyMd+/eqTezi4uLe5+kZKoCAH744YeRNwwZy8ePHx/cb/Dx40f1Yvn73/9+7w3q8PAQr169Up/4zs/PcXp6amr5/ubNGzU98vHjR/z000+P/lRn/DkmbTQ7PDzEy5cv1c9xeXmJk5MT9XUyJWPc7Pi3v/3tSXPqxje68d+XcRrr9PR06jTWixcv1IeAWQFinH4bnwo06zm3qGU8/rTX6YsXL/D+/Xv1Qe7Tp0/3Hm8WO7wenICrsKaYNtdtfIEHg8Gpc8DGqYNJJb/xf5u2mzYUCo18n/Hpk9PTU/Vm8erVq6lvPm/evJn5BnhxcaGC7tWrV1NfBKFQaORFaPbqIXkDARbbG2Kcfjo8PJz5e3379q2qJpa9B2VS/8P47zKOP/74Y+qmRePzYNbXTas+AHOec0+xjMef1Wdc9Llql9eDE7ACmWLWk0ZIybyI169fqxfHok0+4wvyoU8+x8fHU+eujW86D62AOjg4UNMp06qrp3j9+rVqfD92b8hjfo5QKDQyfbTolNlDzs/PR6bCJv2tx5vpk/6WoVAIf/nLX9TvfNrXyZuYNKONzHjOPYXZjz/pZxz/7/I7e8zf2E6vB7tjBTLB8+fP5/q6p7wIDg4OcHh4OPUJLSXxrE/HsoM5GAw+OJbvvvvuwe9zeHg4VyAav9e0BuOiQqHQSFX3mL0hxh3d8yyJNf7ul7Ub3DhtM+3NyDjWWZ9ijYEx6evOzs7U32PSz2/Gc+4pzH78ecLA+Fyd929sp9eD3bECmWCVqykuLi5wdnamqoPHrHCRpuo8n9BnBYzxsY0HTs6jWCya/mn2xYsXqvn/mL0h8nPM+wFAGqIAlnYWl/GN/suXLw/2ov7444+pv1Pjqi2ZxjI+V42PNev39ZTnnBnMevx5nnfG18a8f2O7vR7sjAFikWaziY8fP84se2Vj1apf4HYwvjfk6Oho7hemXZZTyiodMe+ZWmdnZzOrlWnTXRIgh4eHE39XVj/nrH58Mh8DxCLj69dlqebBwYHaqXxwcICTk5OVvZji8fi9fQPz/H+WNRbj3pDff//9SXtDrLBoU/X09HRqgLx8+XJigBg3TE77G1r9nLP68R/LTq8Hu2KAWOD09HTk2JOHVklNI9MZ88y7znpByvcJBoO2uptifG/I2dnZzOriMb8P4G5PiDD7MEPj0SUA8D//8z8PVkay9Pvy8nLqVIi82crvRKaxpNcSDAYn9j/Mes4tahmPP09Pw/g18/6N7fp6sCM20S1g/GT60Atp1jLGSZve5nnMad/n8vJyrnliWS67ik+JxmWSnz59mjm+x/w+gMXeXOZl7HXMezSL8Y1/ViPZWJ2cnZ2NhNW0lYFmPecWtYzHn2dKcJG/sZ1fD3bDALGA8QXy0KewWW/8xjcc42qfccViceZ/n3cVkHyvd+/e4f379/j9999nfq0ZZOOfPPbJycnUr5339yHfS950py2vfQrj4897SKJxumTev/vZ2dnI105bzm3Wc25Ry3h8OU1gmmazObKsed6/sZ1fD3bDALGA8TiMWS+A8YMcxxmf6J8/f574plksFqee1yWOj4/VmGZ9ym82m/jw4YP6d7NPzZ3m1atXanyzPnWOf4KfNcVhfLE/9HM8doWW8eiSaVNKk8j0lHyPaeOX/Q3A3fPH+CY57c3ZrOfcopb1+L///vvUv8+nT59GTiWYl91fD3bCALGA8Q3lw4cPI2/8sgP7xx9/xNevX0deeONP5Hg8PrJn4rfffsN///d/4+TkBCcnJ/jw4QN+/PFHXF5ezlzaGgqF1Fxvq9XCu3fvcHp6qh6v2WyqG/qMZzqt6tiG8R2/00jjHfjzoL2Tk5ORN6SzszO8f/9+pPp46Of49OmT+p3O8+ZmnH567BHtxq+fteRXvk6W9ALTm+fj3/cpz7lFLevx5dBSY6VwcXGBDx8+qN/fY5+rdn892Amb6BZ48eIFvnz5gsvLS7RaLfz2228TTyh9/vw5/va3v6nzoX799VcAozfCyace2XAn5zsZSdPy3bt3U8f08uVLXFxcqKb1tDHJuFZ9cNzR0REODw8fnGf+/vvvUSwW1Q7zz58/qzOtxsXj8akru46OjtT/r1gsqn/+7rvvHpwKmWdKaZrj42MVQKenp1OPyjk6Ohr5hP3QY5n5nFvEMh7/5cuXODs7w+Xlpfq6ccFg8FFnYBm/t51fD3bBCsQib9++VdMQ44LBIF69eoWff/4Zh4eHD26Me/nyJX755RccHx+PvLk9f/4cr169wk8//TRXA/HNmzf44YcfZr5BHh8f4+3bt5bstTDe4vfQ171+/Xrm1x4fH+Onn36a+rMeHBw8atpDGI8umTWlNI1xGmvWMe9yFIuYtvfDyMzn3CLMfnw5SHHa7/jw8BA///zzwgsk7P56sAPtn//8p/zm7vgAABVESURBVO5yufDXv/7V6rFsJLmNTsrj77777t4Lotls4uvXr2g2m+omu8e6uLhQFchf/vKXB/dUnJ+f31vmOu/RDnby1J/DeMNjMBh01N3l06zqObfKx5fd7cBduB4eHpr6t1qX14NZ/vWvf2E4HDJANoXxIp9Jx5wTEc1LAoQ9EAeT61cBPHgj2qxjvomIFsEeiIPJmUGzbhyU84ek+SxHRhARPRUrEAc7Pj7GyckJWq2WOr3W2EyVuWbjSp0ffvjBquES0ZphD8ThLi4u8Ouvvz64PyEYDOIf//jHSs8/IqL1xB7Imjg4OMBPP/2kjrSQO6CBP1cNHR0dzX0eExHRvBggayAUCuHFixcbuROWiKzDJjoRES2EAUJERAthgBAR0UIYIEREtBAGCBERLYQBQkREC2GAEBHRQrgPhBwtm82i2WxC0zSEw2FEo1Fommb1sGZqNpvI5/MYDAZwu93Y39+H1+u1elhEj8YKhByp3+/j+vpahUcsFkMsFrN9eAB3Gz+TySQ0TcNgMMDNzQ263a7VwyJ6NAYIOc5wOEShUFBHtuzu7iIcDls8qscJhUJIpVJwu93odru4ublBr9ezelhEj8IAIUcZDAZq2srlciEejyMWi1k9rIVsbW0hmUzC5XKh1+shm82yEiFHYYCQY/T7feTzebTbbWiahkgkgnA47Ihpq2lCoRASiYQKkXw+j36/b/WwiObCACFH0HUduVxOVR7RaNRx01bTbG9vq+msTqeDb9++sRIhR2CAkO31+33c3NyoyiMajSISiTi68hgnlYg01vP5PEOEbI8BQram6zry+bxabRWJRLC7u2v1sJZia2sL6XQaHo8HnU4H19fXnM4iW2OAkG1Jw7zVakHTNMTjcUfs83iK8UqEq7PIzhggZEuDwQC5XE6FxzpXHuOMS3w7nQ5ubm4wGAysHhbRPQwQsh1pmLdaLbVUNxKJWD2sldra2lKVSLfbxfX1NSsRsh0GCNlKv98fmbaSymOdp62mGQ+RXC7HngjZCgOEbMU4bRWLxdZmqe6idnZ2kEql4HK52Fgn22GAkC3I2VayVDcejzt+k6BZtra2EI/HoWkaer0eG+tkGwwQstx4wzwajW5Mw3xeUolIYz2bzULXdauHRRuOAUKWkqW6Unlw2mo6Y0+k1+vh27dvrETIUgwQsky/30cul0On04GmaUgkEpy2eoAcwGhsrHOJL1mFAUKW0HVdrbaSpbrb29tWD8sR5OwsaaxfXV2xEiFLMEBo5aRh3u12VeWxqUt1FzU+nZXP5xkitHIMEFopaZgbex6sPBazvb2NZDIJt9uNdruNbDbL6SxaKQYIrYyxYe5yuZBMJtkwf6Lt7e2RSoRLfGmVGCC0EnIkuzTMo9EoKw+TyHSWy+VCu91GPp/nEl9aCQYILZ2u6+o+D5fLpVZbkXl2dnbUZsN2u42rqyvuWKelY4DQUvV6PVxfX6vKIx6PY2dnx+phraWdnR3EYjFomoZOp8MlvrR0DBBaGrkMyng8CcNjucLhMJLJpJrOYmOdlokBQkvR7/dxdXWlwkOW6tLybW9vj1QiNzc3nM6ipWCAkOlkqS6nrayzs7Mz0li/ubmxeki0hhggZCpj5SENc1Yeq6dpmgoRqUS+ffvGSoRMxQAh0xj3IbDysIft7W21OouNdTIbA4RMMRgM1D4PqTwYHvawu7vLxjotBQOEnkyW6srZVslkkuFhM+OVCBvrZAYGCD1Jv99HPp8fORhxa2vL6mHRBBIixsY6d6zTUzBAaGFSebTbbbjdbqRSKVYeNqZpGnZ3d0ca67xjnZ6CAUILMR4hLqfqsvJwBuM+kXa7jUKhwEqEFsIAoUcznqrrdrvZ83CgcDiseiLNZpOVCC2EAUKPMr5UN5FI8FRdh9rd3UUkEhmpRLg6ix6DAUJzM14GJUt1OW3lbJFIBLFYDC6XC81mEzc3NxgOh1YPixyCAUJz6fV6uLq6Uvs8OG21HjRNQzgcRiQSAQC0223kcjlOZ9FcGCD0oF6vh1wuN7LDnJXHegmHwyOVSC6Xs3pI5AAMEJqp3+8jm82i0+lwqe4a0zRNTWdJT4SNdXoIA4Sm6na7yGazrDw2yO7uLqLRKDRNQ6vVQj6fZ0+EpmKA0EQybdXtdlXlwdVWm0GmsyRE2FinaRggdE+321VnW0nDnJXH5pDG+niIcDqLxjFAaITsMO/3+2qfRygUsnpYZIFJ01lERgwQUoxLdT0eD9LpNKetNpg01mXHeqvVwtXVFSsRUhggBOBu2kouG5KGOSsPAv7csQ6AZ2fRCAYIodfrqaW6Ho8HqVSKPQ8aEY1G1Sm+smOdx54QA2TDdbtd1SDlfR40y+7uLsLhMACg2Wzy7CxigGyyfr+vlurKaitOW9Es0WhUNdYbjQby+TynszYYA2RD9Xo9fPv2jfs86FE0TUM0GlU9ETn2hJXIZmKAbCCZtpKGOZfq0mNFIhF1FLxUIrR5GCAbZjAYqE2CbrcbmUyGPQ96NLmFMhaLAQAb6xuKAbJBOp0Orq6uVOWRTCYRDAatHhY5WDgcRjgcHqlEeOzJ5mCAbAjjTYIulwvpdJrTVmSKWCymGuvNZpON9Q3CANkAUnn0+3243W6GB5lKdqzLEt9Go8HprA3BAFlzxh3mLpcLqVSK01a0FMYlvlKJ0HpjgKyxbreLq6sr9Ho9dbYVw4OWRZb4GkMkm82yElljDJA11el01D0Omqax8qCVkTvWWYmsPwbIGpJ9HlJ5ZDIZBAIBq4dFG0J6ItFoFABUiHB11vphgKyZTqeDbDarGuZcqktWGG+s12o1hsgaYoCskW63qy6DkrOtGB5kpVgsNrJPpFgsWj0kMpHH6gGQOaRhPhwO4fF4GB5kC3K3jKZpKJfLqNVq0HUd8Xgcbrfb6uHRE7ECWQOdTge5XE41zBkeZDfRaBS7u7sAgHq9jkKhYPGIyAwMEIfrdrvIZrPodrvwer3Y29tjeJDtyKGd0ljnsSfrgQHiYLJUVzYJJhIJrrYiWzNWImysOx97IA7VbrdVeHg8HiQSCVYe5AjxeBwulwuVSgWNRkMt+CDnYQXiQMbwkKW6PNuKnEKOgjdWIjw7y5kYIA7T6XSQz+dVePB4EnIqWeIL3PVE2Fh3HgaIg7TbbVxfX6PX68Hr9SKdTrPnQY4lS3zHr8dlT8Q5GCAO0W631YtLTtVleNA6iEajCIfD0HUd9Xqd94k4CAPEASQ8+v2+OtvK7/dbPSwiU0hPZHzHOkPE/hggNicNcwkPVh60jmQ6a2dnBwBQrVZRKBQYIjbHALGx8YY5w4PWXSwWw87ODjRNQ61WQ6lUsnpINAP3gdiUXEOr6zq8Xi+SySTDg9ae7AmRfSKVSgXD4VDtHSF74V/EhqTnoeu6ugyK4UGbRCoRAKxEbIwViM0YNwl6vV6kUik2zGnjyNlZUolUq1UAUCf7kj2wArERqTyMO8wZHrSppLG+vb0N4K6xztVZ9sIKxCZarZa6DIqrrYj+lEgkoGka6vW6qkQSiYTFoyKAAWILMm0ll0ExPIj+ZDxssVaroVqtqkup2Fi3Fn/7FjPuMOdSXaLpjPtEarUar8e1AVYgFpKzrXRdh8/nQyqVgs/ns3pYRLY0vsS3Xq/D5XIhFouxsW4RViAWabVauLm5ga7r6mwrhgfRw2SJr67rqFQq3LFuIQaIBVqtllpt5fV68ezZM4YH0Zxkia8cBV+r1XB7e2vxqDYTA2TFpPKQmwRTqRS8Xq/VwyJylPGzs8rlMisRCzBAVqjdbqs7oN1uN/b29rjPg+gJYrEYtra2ANztE2ElsloMkBVptVq4vr5Gv9+H1+tFJpNh5UH0RHIrp1QilUqFmw1XiAGyArJJUBrm6XSalQeRieLxOLa2tlRjnWdnrQaX8S5Zs9lUR7LLNbRsmBOZy7jEt1aroVKpQNM0RKNRLvFdIlYgS2RcbSUNc4YH0XJIiEhPpFwuo1QqcTpriViBLIlMW8nxJJlMhuFBtAJyTlaz2USlUgFwN8VF5mMFsgTNZhPZbBb9fh8+n4/TVkQrJI114+osNtaXgwFismazqdajyw5zNsyJVi+RSIw01nl2lvkYICZqNBq4ublBv9+H3+/H/v4+Kw8ii8gHOOMBjLe3t6xETMQAMYmx8pDLoBgeRNaSY0+kErm9veV0lonYRDdBs9lUR7L7/X6k02l4PPzVEtmBpmlIJpMjl1J5PB5EIhGrh+Z4rECeqNlsqsugfD4fkskkw4PIZmQ6Sxrrt7e3XOJrAr7TPYFxh7mcbeV2u60eFhFNIUt8G40GyuWy2mxIi2EFsqBGo4FsNovBYACfz8fwIHIAufUzFAoBuNtsyMb64hggCxhvmHOfB5FzSE/E2FjnKb6L4RTWI9XrdRQKBdXzyGQy7HkQOYzb7UYikYCu62rHutvtVpdU0XxYgTyCHIwo4ZFKpRgeRA5l3LGu6zqKxSKX+D4SA2ROjUZDTVt5PB5OWxGtAdknIj2RarWqzs+ihzFA5tBoNJDL5dQOc14GRbQ+3G43MpnMSE+ES3znwwB5gLHykBUcrDyI1o9UIrquo1wuo1wuWz0k22OAzFCr1dR9HnK2FSsPovUkHxCN94lwOms2BsgUjUZDNdS8Xi9SqRTDg2jNyY51qURKpRIb6zMwQCao1WpqtVUgEGDlQbRBZJ+IhEilUmElMgUDZIz0PORgxGQyyR3mRBtGGuuyOuv29hblcpmVyBgGiIFsEpRpK662Itpsxkrk9vYW1WrV6iHZCgPkP+r1OvL5vGqYZzIZVh5EG04a64FAQIVIpVJhJfIfDBCMLtVlw5yIjFwuF9LpNEKhEIbDIUqlEpf4/sfGB0i9Xh+5DIoNcyIaJ2dnSSVSLpc5nYUND5BGo6Hu85CzrThtRUSTeDwe7O3tqZ5IsVjc+KPgNzZAxqetnj17xsqDiGaSs7OCwaCqRGq1mtXDssxGBsj4DvNMJgNN06weFhE5gMfjQSaTUSEiPZFNrEQ2LkDGd5in02lWHkT0KJqmIZVKIRgMYjgcbuwS340KkEqlMtIw39vb430eRLQQWeJrrEQ2LUQ2JkBqtZo6opmXQRGRGWTHuoRIsVjcqOmsjQiQSqWipq0CgQAb5kRkGjk7y7jZcFMqkbUPEKk8hsMhgsEgkskkG+ZEZCqPx4P9/f2R6axarbb2lchaB0itVlOVh9/v5w5zIloqYyVSKBTWfonv2gZItVpVp+oGAgGebUVES+fxeJBOp+H3+1UlUq/XrR7W0qxlgEyqPBgeRLQK0lgPBAIYDofI5/Nre5/I2gWIVB7SMN/f3+dqKyJaKVnia6xE1nE6a60CxFh5BAIBNsyJyDLSWJeeSLFYXLtKZG0CZHzaam9vjw1zIrKULPGVHevrVomsRYBUKpWRhnk6nWblQUS2IHcMyXRWsVhcmxBxfIDU63V1pLLf70c6nWbPg4hsZbyxXigU1mKzoaMD5Pb2Fvl8nkt1icj2xhvr61CJODZAqtWqqjwCgQCX6hKR7Y031p1eiTguQOQSl1KpBAAIBAI8VZeIHGP87CwnVyKOCxCpPIbDIUKhEFKpFBvmROQoXq8Xe3t7jp/OckyA6LqOSqVyb9qKlQcROZGmaUin0yONdaeFiGMCRKatpPJIp9NwuRwzfCKie+TsLK/XqyqRRqNh9bDm5oh34Gq1qi5pCQQCSCQSbJgT0Vpwu91qOms4HCKXyzmmErF1gMjlLLLDPBQKsWFORGvH4/EglUrB5/Op1VlOqERsHSC1Wk1VHsFgEIlEgg1zIlpL0lg3hojdKxFbBog0zOUO82AwiEwmw8qDiNaa2+1WjfXBYIBCoWDr+0RsGSDVanXkGlou1SWiTSFnZzmhsW67AJHwkMqDO8yJaNN4PB51dtZgMLBtY902ASI7zKVhLtNWDA8i2kRerxfJZNLWlYhtAsTY8+BlUEREdyEiZ2fJ9bh2qkQsDxBZqnt7ewsACAaDvIaWiOg/3G43ksmk2idipyW+lgfI7e2tWqorZ1sREdGfvF4vMpmMms6yy+osywJEeh6VSgW6rmNrawvpdJo9DyKiCeRSKr/fj8FggHw+j2azaemYLAuQUqmkDkYMhULseRARPUCW+Lrdbui6bnmIWBIglUoF1WpVVR7JZJIHIxIRzcHr9eLZs2fw+Xxqia9V01krfdfWdR2lUkmttpJTdTltRUQ0P+PZWbI6y4pKZKUBYux5yLQVERE9ns/nQzqdhsfjsewAxpUEiCzVldVWbJgTET2drM7y+/3o9/vI5XIrDZGVBEi5XB5ZqsuGORGROXw+30hjvVgsrmw6a+kBYryGlg1zIiLzyY51qURubm5W0lhf2ju58TIoAGyYExEtkZydZeyJLLsSWVqAyLQVADbMiYhWwOfzqUupZHXWMnsipgeIzMEZG+Y8VZeIaDVks6Fxn0ir1VrKY5keIMVicWSpbiKRMPshiIhoBp/Ppz6467qOXC63lOks0wJEeh5y1PDOzg57HkREFvF4PNjf31eVyM3NDdrttqmPYUqAyLSVcbVVIpHgUl0iIgvJdJbL5YKu67i5uTF1OsuUALm9vUW1WgUAbG9vc58HEZFN+Hw+PHv2DF6v1/SeyJMCRJaKVSoVAMDW1pZKOyIisgepRDwej5rOMiNEnvROXyqV1Km629vbbJgTEdmU3+/H3t4e3G63WuL71J7IQgEiPY/xaSs2zImI7Mt4s2G/38f19fWTKpGFAsS4VHdnZ4cNcyIih/D7/Uin06qxns/nFw6RRwfIeMM8Ho+z50FE5CA+nw/7+/uqEll0n8jc7/zSML+9vQVwFx5smBMROZOc4iuN9UVWZ8397m+sPLa2thCPxx83WiIishW/349MJgOPx6Ma648JkQcDZDgcjizV5Q5zIqL1ITcb+nw+9Pt9ZLPZuVdnPRggxqW6rDyIiNaP3+8f2bE+byUyNUCk5yHTVru7u7wMiohoTUlj3efzodfrzXV21sQ0mLTPI5FIMDyIiNaYz+dTe/qGwyFyudzMEJmYCBIemqapfR5ERLT+ZMe6x+NRS3w7nc7Erx0JEGmYj+8wZ+VBRLQ5jEt8Zcf6pEpkJBnGp63YMCci2kyBQEDtWJclvuOVyEiAyE7EcDjMTYJERBtO9ol4vV70er17lchIQsRiMSQSCcRisZUPlIiI7CcQCKiCQhrrHo8HAOAB7nof//rXvywdJBER2Zfb7UYoFEK/31eH53rkPw6HQ8sGRkRE9jYcDtFoNOB2u9Hv9wEA/w9ZPyqYyhmyLwAAAABJRU5ErkJggg==";_gliffy.Renderer.ImageCanvas=_gliffy.Renderer.extend({id:"Gliffy.Renderer.ImageCanvas",target:null,init:function(){_gliffy.renderers[this.id]=this},getUrl:function(object){return object.getUrl()},render:function(o){if(!o){throw new Error("shape renderer needs options")}if(!o.target){throw new Error("needs a target canvas context")}if(!o.object){throw new Error("no shape to render")}var context=o.target,object=o.object,renderCallback=o.renderCallback,scale,transform,offsetX,self=this,offsetY,image,url=this.getUrl(object),canvas,ctx;scale=object.node.stage.zoom;offsetX=(object.style.single_canvas)?0:object.style.offset_x;offsetY=(object.style.single_canvas)?0:object.style.offset_y;if(url===undefined||url===null){url=imageNotAvailable}if(object.node.hasFlag("skin")){if(url===imageNotAvailable){_gliffy.Logger.error("image does not have a valid url.");_gliffy.handleError("com.gliffy.error.file_malformed",[],new Error("image does not have a valid url"))}image=new Image();image.onload=function(){if(url===self.getUrl(object)||url===imageNotAvailable){object.imgWidth=image.width;object.imgHeight=image.height;if(object.node&&object.useOriginalDimensions){object.node.setWidth(object.imgWidth);object.node.setHeight(object.imgHeight);object.node.clampTo(_gliffy.Mouse.editor.getDocumentManager().getActiveStageViewPort());object.node.update();object.useOriginalDimensions=false}context.save();if(object.style.single_canvas){transform=object.node.worldTransform.getValues();if(!o.ignorePan){context.translate(object.node.stage.pan_x,object.node.stage.pan_y)}if(!o.ignoreZoom){context.scale(scale,scale)}context.transform(transform[0],transform[1],transform[2],transform[3],transform[4],transform[5])}else{context.canvas.width=object.style.graphic_width*scale;context.canvas.height=object.style.graphic_height*scale;context.scale(scale,scale);$(context.canvas).css({width:"",height:""})}if(object.isDropShadow()===true){context.save();context.translate(object.style.shadow_x,object.style.shadow_y);context.fillStyle="rgba(0,0,0,0.294117647)";context.fillRect(0,0,object.style.width,object.style.height);context.restore()}if(context instanceof C2S&&url.indexOf("data:")===-1){canvas=document.createElement("canvas");canvas.width=image.width;canvas.height=image.height;ctx=canvas.getContext("2d");ctx.drawImage(image,0,0);context.drawImage(canvas,offsetX,offsetY,object.style.width,object.style.height)}else{context.drawImage(image,offsetX,offsetY,object.style.width,object.style.height)}context.restore();object.node.resetFlags();if(renderCallback){renderCallback()}}};image.onerror=function(){_gliffy.Logger.error("image did not load.");_gliffy.handleError("com.gliffy.error.file_malformed",[],new Error("image did not load"));image.src=imageNotAvailable};image.src=url}else{$(context.canvas).css({width:object.style.graphic_width*scale,height:object.style.graphic_height*scale});object.node.resetFlags();if(renderCallback){renderCallback()}}}});_gliffy.Renderer.ImageCanvas.imageNotAvailable=imageNotAvailable}());(function(){_gliffy.Renderer.NodeCanvas=_gliffy.Renderer.extend({id:"Gliffy.Renderer.NodeCanvas",target:null,init:function(){_gliffy.renderers[this.id]=this},render:function(o){var ctx=o.target,object=o.object,callback=o.renderCallback,renderers=o.renderers,singleCanvas=o.singleCanvas,container=o.container,viewbox=o.viewboxDom,loadImage=singleCanvas||o.loadImage,graphic=object.getGraphic(),nodeCallback,ignorePan=o.ignorePan||false,ignoreZoom=o.ignoreZoom||false;_gliffy.Utils.tryCatch(function(){if(!o){throw new Error("shape renderer needs options")}if(!o.target&&!o.container){throw new Error("needs a target")}if(!o.object){throw new Error("no shape to render")}if(!o.renderers){throw new Error("no renderers defined for node")}nodeCallback=function(){if(!object.isProxy()&&object.supportsConnections()&&renderers.controls){_gliffy.renderers[renderers.controls.prototype.id].render({target:object,renderCallback:callback,viewboxDom:viewbox})}else{if(callback){callback()}}};if(graphic&&(singleCanvas||graphic.node.hasRedrawCanvasFlag()||(graphic instanceof _gliffy.Text&&graphic.node.hasFlag()))){graphic.style.single_canvas=singleCanvas;if(graphic instanceof _gliffy.Line){_gliffy.renderers[renderers.line.prototype.id].render({target:ctx,object:graphic,renderCallback:nodeCallback,ignorePan:ignorePan,ignoreZoom:ignoreZoom})}else{if(graphic instanceof _gliffy.Image){if(singleCanvas){object.setFlag("skin")}_gliffy.renderers[renderers.image.prototype.id].render({target:ctx,object:graphic,renderCallback:nodeCallback,loadImage:loadImage,ignorePan:ignorePan,ignoreZoom:ignoreZoom})}else{if(graphic instanceof _gliffy.Svg){_gliffy.renderers[renderers.svg.prototype.id].render({target:ctx,object:graphic,renderCallback:nodeCallback,ignorePan:ignorePan,ignoreZoom:ignoreZoom})}else{if(graphic instanceof _gliffy.Shape){_gliffy.renderers[renderers.shape.prototype.id].render({target:ctx,object:graphic,renderCallback:nodeCallback,ignorePan:ignorePan,ignoreZoom:ignoreZoom})}else{if(graphic instanceof _gliffy.Text){_gliffy.renderers[renderers.text.prototype.id].render({target:ctx,object:graphic,renderCallback:nodeCallback,stage:o.stage,container:o.container,zIndex:o.zIndex,ignorePan:ignorePan,ignoreZoom:ignoreZoom})}else{if(graphic instanceof _gliffy.Proxy){if(singleCanvas){object.setFlag("skin")}_gliffy.renderers[renderers.proxy.prototype.id].render({target:ctx,object:graphic,renderCallback:nodeCallback,loadImage:loadImage,ignorePan:ignorePan,ignoreZoom:ignoreZoom})}else{throw"draw not implemented for "+graphic.getClassName()}}}}}}}else{nodeCallback()}},function(e){if(graphic){_gliffy.Logger.error("Node "+graphic.node.getId()+" failed to render. "+JSON.stringify(graphic.node.toObject()))}else{_gliffy.Logger.error("Node failed to render.")}throw e})}})}());(function(){_gliffy.Renderer.StageSingleCanvas=_gliffy.Renderer.extend({id:"Gliffy.Renderer.StageSingleCanvas",target:null,init:function(){_gliffy.renderers[this.id]=this},render:function(o){if(!o){throw"stage renderer needs options"}if(!o.target){throw"needs a target container"}if(!(o.object&&o.object instanceof _gliffy.Stage)){throw"needs a stage object to render!"}var options=$.extend({},{renderCallback:null,textRenderer:_gliffy.Renderer.TextCanvas,shapeRenderer:_gliffy.Renderer.ShapeCanvas,svgRenderer:_gliffy.Renderer.SvgCanvas,lineRenderer:_gliffy.Renderer.LineCanvas,imageRenderer:_gliffy.Renderer.ImageCanvas,forceUpdate:false,whitespace_x_padding:20,whitespace_y_padding:20,show_progress_bar:false,ignorePan:true,ignoreZoom:true,boundingBoxFit:false},o),i=0,stage=options.object,container=options.target,ctx=o.context,forceUpdate=options.forceUpdate,nodeRenderer,c,width,height,objects,renderers={text:options.textRenderer,shape:options.shapeRenderer,line:options.lineRenderer,image:options.imageRenderer,svg:options.svgRenderer},bb,scale,offsetX=0,offsetY=0,bounds;if(!_gliffy.renderers[options.textRenderer.prototype.id]){_gliffy.renderers[options.textRenderer.prototype.id]=new options.textRenderer()}if(!_gliffy.renderers[options.shapeRenderer.prototype.id]){_gliffy.renderers[options.shapeRenderer.prototype.id]=new options.shapeRenderer()}if(!_gliffy.renderers[options.svgRenderer.prototype.id]){_gliffy.renderers[options.svgRenderer.prototype.id]=new options.svgRenderer()}if(!_gliffy.renderers[options.lineRenderer.prototype.id]){_gliffy.renderers[options.lineRenderer.prototype.id]=new options.lineRenderer()}if(!_gliffy.renderers[options.imageRenderer.prototype.id]){_gliffy.renderers[options.imageRenderer.prototype.id]=new options.imageRenderer()}if(!_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id]){_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id]=new _gliffy.Renderer.NodeCanvas()}nodeRenderer=_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id];if(options.show_progress_bar){GliffyApp.progressBarController.show("Exporting to Image")}if(!ctx){c=$("<canvas/>");stage.update();bb=stage.calculateBoundingBox();scale=stage.zoom;if(options.ignoreZoom){scale=1}bounds=new _gliffy.BoundingBox();bounds.min.x=Math.max(0,bb.min.x-options.whitespace_x_padding)*scale;bounds.min.y=Math.max(0,bb.min.y-options.whitespace_y_padding)*scale;bounds.max.x=Math.min(bb.max.x+options.whitespace_x_padding,stage.maxWidth)*scale;bounds.max.y=Math.min(bb.max.y+options.whitespace_y_padding,stage.maxHeight)*scale;if(options.boundingBoxFit){width=bounds.getDimension().x;height=bounds.getDimension().y;offsetX=-bounds.min.x;offsetY=-bounds.min.y}else{width=bounds.max.x;height=bounds.max.y}c.get(0).width=width;c.get(0).height=height;container.append(c);ctx=_gliffy.Utils.getContext(c.get(0))}ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx.save();ctx.fillStyle=stage.background;ctx.fillRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx.restore();ctx.translate(offsetX,offsetY);ctx.save();stage.update();objects=stage.flattenNodes(forceUpdate);for(i=0;i<objects.length;i++){_gliffy.workQueue.delay(1).queue(this.__createWorkQueueFunction(nodeRenderer,objects,i,ctx,renderers,container,options))}_gliffy.workQueue.delay(1).queue(function(next){if(options.show_progress_bar){GliffyApp.progressBarController.getBar().animate({width:"100%"})}ctx.restore();if(options.renderCallback){options.renderCallback()}next()})},__createWorkQueueFunction:function(nodeRenderer,objects,i,ctx,renderers,container,options){return function(next){_gliffy.Utils.tryCatch(function(){nodeRenderer.render({object:objects[i],target:ctx,renderCallback:function(){if(options.show_progress_bar){GliffyApp.progressBarController.getBar().queue(function(n){$(this).width(Math.floor(((i+1)/objects.length)*100)+"%");n()})}next()},renderers:renderers,container:container,singleCanvas:true,ignorePan:options.ignorePan,ignoreZoom:options.ignoreZoom})},function(e){_gliffy.workQueue.clearQueue();if(options.renderCallback()){options.renderCallback()}_gliffy.handleError("com.gliffy.error.render_failed",[],e,options.target)})}}})}());(function(){var AUTOFIT_PADDING=25;_gliffy.Renderer.StageMultiCanvas=_gliffy.Renderer.extend({id:"Gliffy.Renderer.StageMultiCanvas",target:null,__bindToScroll:true,__setupScrollEvent:false,init:function(){_gliffy.renderers[this.id]=this},disableScroll:function(){this.__bindToScroll=false},enableScroll:function(){this.__bindToScroll=true},__fixWebkitIframeFlicker:function(){if($.browser.webkit){var chromeFix,transform,canvasStyle;chromeFix=$("#gliffy-webkit-fix");if(chromeFix.length===0){transform=new _gliffy.AffineTransform(1,0,0,1,0,0);canvasStyle=$.extend(_gliffy.Utils.transformCss(transform),{visibility:"hidden",position:"absolute",zIndex:1});chromeFix=$("<canvas />",{id:"gliffy-webkit-fix"}).css(canvasStyle).addClass("gliffy-graphic");$(".gliffy-stage").append(chromeFix);chromeFix.get(0).width=1000;chromeFix.get(0).height=1000;_gliffy.Utils.getContext(chromeFix.get(0)).fillRect(0,0,1000,1000)}}},render:function(o){if(!o){throw new Error("stage renderer needs options")}if(!o.target){throw new Error("needs a target container")}if(!(o.object&&o.object instanceof _gliffy.Stage)){throw new Error("needs a stage object to render!")}var options=$.extend({},{renderCallback:null,useTimer:false,textRenderer:_gliffy.Renderer.TextDom,shapeRenderer:_gliffy.Renderer.ShapeCanvas,lineRenderer:_gliffy.Renderer.LineCanvas,imageRenderer:_gliffy.Renderer.ImageCanvas,svgRenderer:_gliffy.Renderer.SvgCanvas,proxyRenderer:_gliffy.Renderer.ProxyRenderer||false,controlRenderer:_gliffy.Renderer.ControlRenderer||false,cssPan:false,panOnly:false,scrollForPan:_gliffy.Editor!==undefined,forceUpdate:false,queueRender:false,delayEvery:1,resizeTarget:true,pointerEvents:"auto",showGrid:_gliffy.Editor!==undefined,fixedDrawingSpace:_gliffy.Editor!==undefined,useImages:false,renderViewbox:_gliffy.Editor!==undefined,renderGuides:_gliffy.Editor!==undefined,autoFitPadding:false},o),stage=options.object,container=options.target,renderers,stageInfo,canvasInfo,contexts,nodeRenderer,render_complete,flattenedNodes,j,node,object,currentStage,stageMulti=this;renderers=options.renderers={text:options.textRenderer,shape:options.shapeRenderer,line:options.lineRenderer,image:options.imageRenderer,controls:options.controlRenderer,svg:options.svgRenderer,proxy:options.proxyRenderer};if(_gliffy.Editor&&!this.__setupScrollEvent){container.bind("scroll.gliffy_pan",function(){if(stageMulti.__bindToScroll){currentStage=_gliffy.Mouse.editor.getDocumentManager().getActiveStage();currentStage.pan_x=-container.scrollLeft();currentStage.pan_y=-container.scrollTop()}});this.__setupScrollEvent=true}stageInfo=this.__setupStageAndPan(options);this.__fixWebkitIframeFlicker();contexts=container.data("contexts");if(!contexts){contexts={}}this.__deleteNodes(stage,stageInfo.domStage,contexts);if(options.cssPan){$(options.target).css({position:"absolute",left:stage.pan_x+"px",top:stage.pan_y+"px"})}if(!options.panOnly){render_complete=this.__afterRenderComplete(container,stage,stageInfo,contexts,options);if(!_gliffy.renderers[options.textRenderer.prototype.id]){_gliffy.renderers[options.textRenderer.prototype.id]=new options.textRenderer()}if(!_gliffy.renderers[options.shapeRenderer.prototype.id]){_gliffy.renderers[options.shapeRenderer.prototype.id]=new options.shapeRenderer()}if(!_gliffy.renderers[options.svgRenderer.prototype.id]){_gliffy.renderers[options.svgRenderer.prototype.id]=new options.svgRenderer()}if(!_gliffy.renderers[options.lineRenderer.prototype.id]){_gliffy.renderers[options.lineRenderer.prototype.id]=new options.lineRenderer()}if(!_gliffy.renderers[options.imageRenderer.prototype.id]){_gliffy.renderers[options.imageRenderer.prototype.id]=new options.imageRenderer()}if(options.proxyRenderer&&!_gliffy.renderers[options.proxyRenderer.prototype.id]){_gliffy.renderers[options.proxyRenderer.prototype.id]=new options.proxyRenderer()}if(options.controlRenderer&&!_gliffy.renderers[options.controlRenderer.prototype.id]){_gliffy.renderers[options.controlRenderer.prototype.id]=new options.controlRenderer()}if(!_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id]){_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id]=new _gliffy.Renderer.NodeCanvas()}nodeRenderer=_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id];if(!options.forceUpdate){this.__notifyNodes(stage);this.__notifyNodes(stage)}if(options.forceUpdate){stage.setBoundsDirty()}flattenedNodes=this.__flattenNodes(stage,options.forceUpdate);if(flattenedNodes.length===0){render_complete()}else{$(".gliffy-drawing-guide:hidden").remove();for(j=0;j<flattenedNodes.length;j++){node=flattenedNodes[j];object=node.getGraphic();canvasInfo=this.__setupNodeCanvas(node,object,contexts,stage,stageInfo,container,options);container.data("contexts",contexts);if(options.queueRender){if(j%options.delayEvery===0){_gliffy.workQueue.delay(1)}_gliffy.workQueue.queue(this.__createWorkQueueFunction(j,node,canvasInfo,options,flattenedNodes,render_complete,nodeRenderer,container,stageInfo))}else{_gliffy.Utils.tryCatch(function(){if(options.fixedDrawingSpace||canvasInfo.bounds.inViewport){nodeRenderer.render({object:node,target:canvasInfo.ctx,renderCallback:stageMulti.__createSimpleLoopCallback(canvasInfo,options,node),renderers:renderers,singleCanvas:false,container:container,stage:stageInfo.domStage,zIndex:node.getOrder(),viewboxDom:canvasInfo.viewbox,loadImage:!canvasInfo.ctx||options.forceUpdate||options.useImages})}else{stage.removeDirtyNode(node)}if(j===flattenedNodes.length-1){render_complete()}},function(e){render_complete();_gliffy.RenderLoop.stop();_gliffy.handleError("com.gliffy.error.render_failed",[],e,options.target)})}}}}else{if(options.renderCallback){options.renderCallback()}}},__createWorkQueueFunction:function(j,node,canvasInfo,options,flattenedNodes,render_complete,nodeRenderer,container,stageInfo){return function(next){_gliffy.Utils.tryCatch(function(){var callback=function(){node.stage.removeDirtyNode(node);if(options.useImages&&canvasInfo.canvas&&canvasInfo.ctx){canvasInfo.canvas.attr("src",canvasInfo.ctx.canvas.toDataURL())}next();if(j===flattenedNodes.length-1){render_complete()}};if(options.fixedDrawingSpace||canvasInfo.bounds.inViewport){nodeRenderer.render({object:node,target:canvasInfo.ctx,renderCallback:callback,renderers:options.renderers,singleCanvas:false,container:container,stage:stageInfo.domStage,zIndex:node.getOrder(),viewboxDom:canvasInfo.viewbox,loadImage:!canvasInfo.ctx||options.forceUpdate||options.useImages})}else{callback()}},function(e){_gliffy.workQueue.clearQueue();render_complete();_gliffy.RenderLoop.stop();_gliffy.handleError("com.gliffy.error.render_failed",[],e,options.target)})}},__createSimpleLoopCallback:function(canvasInfo,options,node){return function(){delete node.stage.dirty[node.getId()];if(options.useImages&&canvasInfo.canvas&&canvasInfo.ctx){canvasInfo.canvas.attr("src",canvasInfo.ctx.canvas.toDataURL())}}},__setupNodeCanvas:function(node,object,contexts,stage,stageInfo,container,options){var ctx,canvas,viewbox,guides=new Array(6),bounds={inViewport:true},scale,transform,dirtyWidth,dirtyHeight,canvasStyle,i,j,guideData,show,xOrY,viewboxStyles,chromeFix;if((node.isGroup()||(!object&&node.isMultipartShape()))&&options.renderViewbox){viewbox=$("#"+node._domId+"viewbox");if(viewbox.length===0){viewbox=$("<div/>",{id:node._domId+"viewbox"}).addClass("gliffy-viewbox");if(node.isGroup()){viewbox.addClass("gliffy-group")}}viewbox.css($.extend({position:"absolute",zIndex:node.getOrder()+1,width:node.getWidth(),height:node.getHeight()},_gliffy.Utils.transformCss(new _gliffy.AffineTransform(1,0,0,1,0,0).scale(stage.zoom,stage.zoom).concatenate(node.worldTransform))));stageInfo.domStage.append(viewbox)}else{if(!(object instanceof _gliffy.Text)){ctx=contexts[node._domId];canvas=$("#"+node._domId);viewbox=(options.renderViewbox)?$("#"+node._domId+"viewbox"):null;if(options.forceUpdate||!ctx){node.setFlag("bounds");node.setFlag("skin")}if(!ctx){if(options.renderViewbox){viewbox=$("<div/>",{id:node._domId+"viewbox"}).addClass("gliffy-viewbox")}if(options.useImages){canvas=$("<img/>",{id:node._domId}).addClass("gliffy-graphic");ctx=_gliffy.Utils.getContext(document.createElement("canvas"))}else{canvas=$("<canvas/>",{id:node._domId}).addClass("gliffy-graphic");ctx=_gliffy.Utils.getContext(canvas.get(0))}if(options.renderViewbox){stageInfo.domStage.append(viewbox)}stageInfo.domStage.append(canvas);contexts[node._domId]=ctx;container.data(contexts)}$("#"+node._domId).data("node",node);scale=stage.zoom;dirtyWidth=object.style.graphic_width*scale;dirtyHeight=object.style.graphic_height*scale;if(object instanceof _gliffy.Line){transform=new _gliffy.AffineTransform(1,0,0,1,0,0).scale(stage.getZoom(),stage.getZoom()).translate(object.style.pos_x,object.style.pos_y).translate(-object.style.offset_x,-object.style.offset_y).scale(1/scale,1/scale)}else{transform=new _gliffy.AffineTransform(1,0,0,1,0,0).scale(stage.getZoom(),stage.getZoom()).concatenate(object.node.worldTransform).translate(-object.style.offset_x,-object.style.offset_y).scale(1/scale,1/scale)}if(node.hasRedrawCanvasFlag()){if(!(object instanceof _gliffy.Image||(_gliffy.Proxy&&object instanceof _gliffy.Proxy))){ctx.canvas.width=Math.min(dirtyWidth,32767);ctx.canvas.height=Math.min(dirtyHeight,32767)}}bounds=_gliffy.Utils.maxBounds(transform,dirtyWidth,dirtyHeight,stage);node._current_bounds=bounds;object.style.matrix_a=scale;object.style.matrix_b=0;object.style.matrix_c=0;object.style.matrix_d=scale;object.style.matrix_e=0;object.style.matrix_f=0;if(node.hasRepositionCanvasFlag()){canvasStyle=$.extend(_gliffy.Utils.transformCss(transform),{"pointer-events":options.pointerEvents,visibility:"visible",position:"absolute",zIndex:node.getOrder()});canvas.css(canvasStyle).data("transform",transform).data("scale",scale);if(options.renderViewbox){viewboxStyles={position:"absolute",zIndex:node.getOrder()+1,width:node.getWidth(),height:node.getHeight()};viewbox.css($.extend(viewboxStyles,_gliffy.Utils.transformCss(new _gliffy.AffineTransform(1,0,0,1,0,0).scale(stage.zoom,stage.zoom).concatenate(object.node.worldTransform))))}}}}if(options.renderViewbox&&(object instanceof _gliffy.Shape||node.isMultipartShape())&&node.hasBoundsConnections()){viewbox.addClass("gliffy-shape-bounds-viewbox")}if(node.hasGuideFlag()&&options.renderGuides&&node.isGuideNode()){for(i=0;i<6;i++){guides[i]=$("#"+node._domId+"guide"+i);if(guides[i].length===0){guides[i]=$("<div/>",{id:node._domId+"guide"+i}).addClass("gliffy-drawing-guide "+node._domId+"guide");stageInfo.domStage.append(guides[i])}}for(i=0;i<6;i++){guides[i].css({position:"absolute",width:(i<3)?"1px":"100%",height:(i<3)?"100%":"1px",backgroundColor:(i===1||i===4)?"red":"green",zIndex:10000})}guideData=node.getGuideData();for(j=0;j<2;j++){xOrY=j===0?"x":"y";for(i=0;i<3;i++){show=node.shouldShowGuide(xOrY,i);transform=_gliffy.AffineTransform.getScaleInstance(stage.zoom,stage.zoom).translate(j===0?guideData[xOrY][i]:-stage.pan_x/stage.zoom,j===0?-stage.pan_y/stage.zoom:guideData[xOrY][i]);guides[i+(j===0?0:3)].css({top:transform.getTranslateY()+"px",left:transform.getTranslateX()+"px",display:show||_gliffy.Debug.DISPLAY_GUIDES?"block":"none",opacity:show?"0.3":"0.1"})}}}else{$("."+node._domId+"guide").remove()}return{canvas:canvas,viewbox:viewbox,ctx:ctx,bounds:bounds}},__setupStageAndPan:function(options){var stageWidth,stageHeight,domStage,stageBackground,panTransform,stage=options.object,container=options.target,self=this;if(options.fixedDrawingSpace){stageWidth=stage.maxWidth*stage.zoom;stageHeight=stage.maxHeight*stage.zoom}else{stageWidth=stage.width*stage.zoom;stageHeight=stage.height*stage.zoom}domStage=container.find(".gliffy-stage");if(domStage.length===0){domStage=$('<div class="gliffy-stage"/>');container.append(domStage)}stageBackground=stage.background;domStage.css({backgroundColor:stageBackground,width:stageWidth,height:stageHeight});if(options.scrollForPan){if(stage._pan_dirty){container.scrollTop(-stage.pan_y).scrollLeft(-stage.pan_x);stage._pan_dirty=false}}else{panTransform=new _gliffy.AffineTransform(1,0,0,1,stage.pan_x,stage.pan_y);domStage.css(_gliffy.Utils.transformCss(panTransform,{roundTranslate:true}))}return{domStage:domStage,stageWidth:stageWidth,stageHeight:stageHeight}},__afterRenderComplete:function(container,stage,stageInfo,contexts,options){return function(){var autoFitWidth,autoFitHeight;if(options.fixedDrawingSpace){stageInfo.domStage.css({width:stageInfo.stageWidth,height:stageInfo.stageHeight})}else{if(options.resizeTarget){autoFitWidth=(options.autoFitPadding)?stage.width+AUTOFIT_PADDING:stage.width;autoFitHeight=(options.autoFitPadding)?stage.height+AUTOFIT_PADDING:stage.height;autoFitWidth=Math.min(autoFitWidth,stage.maxWidth);autoFitHeight=Math.min(autoFitHeight,stage.maxHeight);container.css({width:autoFitWidth*stage.getZoom(),height:autoFitHeight*stage.getZoom()});stageInfo.domStage.css({width:autoFitWidth*stage.getZoom(),height:autoFitHeight*stage.getZoom()})}}if(options.renderCallback){options.renderCallback()}}},__flattenNodes:function(stage,forceUpdate){var nodes=[],i,dirtyNodes,node;if(forceUpdate){dirtyNodes=stage.objects}else{dirtyNodes=Object.keys(stage.dirty)}for(i=0;i<dirtyNodes.length;i++){node=dirtyNodes[i];if(!forceUpdate){node=stage.find(dirtyNodes[i]);if(!node){delete stage.dirty[dirtyNodes[i]]}}this.__preorder(node,nodes,forceUpdate)}stage.updateBounds();return nodes},__preorder:function(node,array,forceUpdate){var c;if(!node){return}if(node.shouldBeDrawn()||forceUpdate){if(forceUpdate){node.setFlag("bounds");if(node.getGraphic()){node.getGraphic().markDirty()}node.markDirty()}if(node.isDirty()){node.update()}if(node.getGraphic()||(node.supportsConnections()&&node.isMultipartShape())||(node.getGraphic()===null&&node.isMultipartShape()&&node.hasGuideFlag())){array.push(node)}else{node.stage.removeDirtyNode(node)}}else{node.stage.removeDirtyNode(node)}for(c=0;node.children&&c<node.children.length;c++){this.__preorder(node.children[c],array,forceUpdate)}},__preorderNotify:function(node){var c;if(!node){return}if(node.shouldBeDrawn()){if(node.isDirty()){node.update()}node.notify()}for(c=0;node.children&&c<node.children.length;c++){this.__preorderNotify(node.children[c])}},__notifyNodes:function(stage){var i,dirtyNodes,node;dirtyNodes=Object.keys(stage.dirty);for(i=0;i<dirtyNodes.length;i++){node=dirtyNodes[i];node=stage.find(dirtyNodes[i]);this.__preorderNotify(node)}},__deleteNodes:function(stage,domStage,contexts){var removeNodeSel="",i,j;for(i=0;i<stage.deletes.length;i++){removeNodeSel+=stage.deletes[i]+","+stage.deletes[i]+"viewbox,";for(j=0;j<6;j++){removeNodeSel+=stage.deletes[i]+"guide"+j+(j<5?",":"")}removeNodeSel+=(i<stage.deletes.length-1)?",":"";delete contexts[stage.deletes[i].substr(1)]}domStage.find(removeNodeSel).remove();stage.deletes=[]}})}());(function(){_gliffy.Renderer.StageSvg=_gliffy.Renderer.extend({id:"Gliffy.Renderer.StageSvg",target:null,init:function(){_gliffy.renderers[this.id]=this},render:function(o){if(!o){throw"stage renderer needs options"}if(!(o.object&&o.object instanceof _gliffy.Stage)){throw"needs a stage object to render!"}var options=$.extend({},{renderCallback:null,textRenderer:_gliffy.Renderer.TextCanvas,shapeRenderer:_gliffy.Renderer.ShapeCanvas,svgRenderer:_gliffy.Renderer.SvgCanvas,lineRenderer:_gliffy.Renderer.LineCanvas,imageRenderer:_gliffy.Renderer.ImageCanvas,forceUpdate:false,whitespace_x_padding:20,whitespace_y_padding:20,show_progress_bar:false,ignorePan:true,ignoreZoom:true,boundingBoxFit:false},o),i=0,stage=options.object,container=options.target||document.createElement("div"),ctx,forceUpdate=options.forceUpdate,nodeRenderer,width,height,objects,renderers={text:options.textRenderer,shape:options.shapeRenderer,line:options.lineRenderer,image:options.imageRenderer,svg:options.svgRenderer},bb,scale,offsetX=0,offsetY=0,bounds;if(!_gliffy.renderers[options.textRenderer.prototype.id]){_gliffy.renderers[options.textRenderer.prototype.id]=new options.textRenderer()}if(!_gliffy.renderers[options.shapeRenderer.prototype.id]){_gliffy.renderers[options.shapeRenderer.prototype.id]=new options.shapeRenderer()}if(!_gliffy.renderers[options.svgRenderer.prototype.id]){_gliffy.renderers[options.svgRenderer.prototype.id]=new options.svgRenderer()}if(!_gliffy.renderers[options.lineRenderer.prototype.id]){_gliffy.renderers[options.lineRenderer.prototype.id]=new options.lineRenderer()}if(!_gliffy.renderers[options.imageRenderer.prototype.id]){_gliffy.renderers[options.imageRenderer.prototype.id]=new options.imageRenderer()}if(!_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id]){_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id]=new _gliffy.Renderer.NodeCanvas()}nodeRenderer=_gliffy.renderers[_gliffy.Renderer.NodeCanvas.prototype.id];if(options.show_progress_bar){GliffyApp.progressBarController.show("Exporting to SVG")}stage.update();bb=stage.calculateBoundingBox();scale=stage.zoom;if(options.ignoreZoom){scale=1}bounds=new _gliffy.BoundingBox();bounds.min.x=Math.max(0,bb.min.x-options.whitespace_x_padding)*scale;bounds.min.y=Math.max(0,bb.min.y-options.whitespace_y_padding)*scale;bounds.max.x=Math.min(bb.max.x+options.whitespace_x_padding,stage.maxWidth)*scale;bounds.max.y=Math.min(bb.max.y+options.whitespace_y_padding,stage.maxHeight)*scale;if(options.boundingBoxFit){width=bounds.getDimension().x;height=bounds.getDimension().y;offsetX=-bounds.min.x;offsetY=-bounds.min.y}else{width=bounds.max.x;height=bounds.max.y}ctx=new C2S(width,height);ctx.canvas.width=width;ctx.canvas.height=height;ctx.save();ctx.fillStyle=stage.background;ctx.fillRect(0,0,width,height);ctx.restore();ctx.translate(offsetX,offsetY);stage.update();objects=stage.flattenNodes(forceUpdate);for(i=0;i<objects.length;i++){_gliffy.workQueue.delay(1).queue(this.__createWorkQueueFunction(nodeRenderer,objects,i,ctx,renderers,container,options))}_gliffy.workQueue.delay(1).queue(function(next){if(options.show_progress_bar){GliffyApp.progressBarController.getBar().animate({width:"100%"})}if(options.renderCallback){if(options.target){$(container).append(ctx.getSvg())}options.renderCallback(ctx)}next()})},__createWorkQueueFunction:function(nodeRenderer,objects,i,ctx,renderers,container,options){return function(next){_gliffy.Utils.tryCatch(function(){nodeRenderer.render({object:objects[i],target:ctx,renderCallback:function(){if(options.show_progress_bar){GliffyApp.progressBarController.getBar().queue(function(n){$(this).width(Math.floor(((i+1)/objects.length)*100)+"%");n()})}next()},renderers:renderers,container:container,singleCanvas:true,ignorePan:options.ignorePan,ignoreZoom:options.ignoreZoom})},function(e){_gliffy.Logger.warn("Problems exporting to svg, skipping to next node. "+e);next()})}}})}());(function(){_gliffy.Slider=_gliffy.Class.extend({_sliderMarkup:'<div class="gliffy-slider"><div class="gliffy-initial-pos"></div><div class="gliffy-slider-handler" /></div>',_handle:null,_handle_width:null,_slider:null,_max:null,_min:null,_width:null,_reset_value:null,_reset_step:null,_reset_pos:null,target:null,value:null,init:function(o){var lastpos,self=this,options=$.extend({},{min:0,max:100,step:0,value:50,namespace:"gliffy.viewer.zoom",reset_step:2,reset_value:50,dragStartCallback:function(self){},dragEndCallback:function(self){},dragCallback:function(self,lastValue){}},o);if(!options.target){throw new Error("Slider must have a target container set")}this._max=options.max;this._min=options.min;this.value=options.reset_value;this._step=options.step;this._reset_value=options.reset_value;this._reset_step=options.reset_step;this.target=options.target;this._slider=$(this._sliderMarkup);this._handle=this._slider.find(".gliffy-slider-handler");options.target.append(this._slider);this._handle_width=this._handle.width();this._width=this._slider.width();this.moveHandle();this._reset_pos=this._slider.find(".gliffy-initial-pos");if(this._reset_step>0){this._reset_pos.css({left:this._handle.css("left")})}else{this._reset_pos.hide()}this.value=options.value;this.moveHandle();this.dragEvent="drag."+options.namespace;this.dragInitEvent="draginit."+options.namespace;this.dragEndEvent="dragend."+options.namespace;this.clickEvent="mousedown."+options.namespace;lastpos={x:this._handle.offset().left};this._handle.bind(this.dragInitEvent,{which:1},function(){lastpos={x:self._handle.offset().left};options.dragStartCallback(self)}).bind(this.dragEvent,{which:1},function(event){var lastValue=self.value,pos=lastpos;lastpos=self._updatePosition(event,lastpos);options.dragCallback(self,lastValue)}).bind(this.dragEndEvent,{which:1},function(event){lastpos=self._updatePosition(event,lastpos);options.dragEndCallback(self)}).mousedown(function(event){event.stopPropagation()});this._slider.bind(this.clickEvent,function(event){event.preventDefault();event.stopPropagation();var lastValue=self.value;lastpos=self._updatePosition(event,lastpos);options.dragStartCallback(self);options.dragCallback(self,lastValue);options.dragEndCallback(self)})},_updatePosition:function(event,lastpos){var xDiff=event.pageX-this._handle_width/2-lastpos.x,valueDiff=(this._max-this._min)*(xDiff/this._width),newValue=this.value+valueDiff;if(this._handle_width===0){this._handle_width=this._handle.width()}if(this._width===0){this._width=this._slider.width()}if(Math.abs(valueDiff)>this._step){if(newValue>(this._reset_value-this._reset_step)&&newValue<(this._reset_value+this._reset_step)){this.value=this._reset_value}else{if(newValue>this._max){this.value=this._max}else{if(newValue<this._min){this.value=this._min}else{this.value=newValue}}}this.moveHandle();return{x:this._handle.offset().left}}return lastpos},moveHandle:function(){var val=null;if(this.value>this._max||this.value===this._max){val="100%"}else{if(this.value<this._min||this.value===this._min){val=0}else{val=parseInt((this.value-this._min)/(this._max-this._min)*100,10)+"%"}}this._handle.css({left:val})},remove:function(){this._handle.unbind(this.dragInitEvent).unbind(this.dragEvent).unbind(this.dragEndEvent);this._slider.remove()}})}());var public_classes=["shapeLibrary","Viewer","Editor","Utils","IntegrationHandler","Components","Plugins","setErrorHandler","setI18nHandler","Logger","Class","AffineTransform","BrowserDetect","Popover","Dialog","Slider","Renderer","Spinner","FileHandlerRegister","DefaultFileHandler","CopyCommand","CutCommand","PasteCommand","BoundingBox","Node","FileHandlerUtils","FEATURES"],i=0;window.GLIFFY=window.GLIFFY||{};for(i=0;i<public_classes.length;i++){window.GLIFFY[public_classes[i]]=_gliffy[public_classes[i]]}_gliffy.NoDebug={SKIP_CATCH_ERRORS:false,SKIP_RENDER_LOOP:false,DISPLAY_GUIDES:false,NO_CONTEXT_MENU:false,NO_TIPS:false,NO_ERROR_DIALOG:false,FINITE_NUMBER_CHECKS:false,NO_NAVIGATE_WARNING:false,STARTUP_FILE:null,LOG_TO_CONSOLE:false,LOG_ANALYTICS:false,USE_ANALYTICS_DEBUG_JS:false,SHOW_MOUSE_COORDS:false,I18N_UNDERSCORES:false,SHOW_RTREE:false,LOCAL_SVG_EXPORT:false};_gliffy.FullDebug={SKIP_CATCH_ERRORS:true,SKIP_RENDER_LOOP:false,DISPLAY_GUIDES:false,NO_CONTEXT_MENU:true,NO_TIPS:true,NO_ERROR_DIALOG:true,FINITE_NUMBER_CHECKS:true,NO_NAVIGATE_WARNING:true,STARTUP_FILE:null,LOG_TO_CONSOLE:true,LOG_ANALYTICS:false,USE_ANALYTICS_DEBUG_JS:false,SHOW_MOUSE_COORDS:true,I18N_UNDERSCORES:true,SHOW_RTREE:false,LOCAL_SVG_EXPORT:false};_gliffy.Debug=_gliffy.NoDebug;if($.url().param("debug")==="true"){_gliffy.Debug=_gliffy.FullDebug}}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


